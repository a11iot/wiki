<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>
		</title>
		<style type="text/css">
			.csAD577193{text-align:left;text-indent:0pt;margin:24pt 0pt 0pt 0pt;page-break-after:avoid;page-break-inside:avoid}
			.csECDA2D3{color:#4F81BD;background-color:transparent;font-family:Microsoft YaHei UI;font-size:16pt;font-weight:bold;font-style:normal;}
			.csDE05BCC{color:#4F81BD;background-color:transparent;font-family:Calibri;font-size:16pt;font-weight:bold;font-style:normal;}
			.cs868C439D{text-align:left;text-indent:0pt;margin:10pt 0pt 0pt 0pt;page-break-after:avoid;page-break-inside:avoid}
			.cs83F14626{color:#4F81BD;background-color:transparent;font-family:Microsoft YaHei UI;font-size:14pt;font-weight:bold;font-style:normal;}
			.cs40DD2BC9{text-align:left;text-indent:0pt;margin:9pt 0pt 9pt 0pt}
			.cs9C1B1871{color:#000000;background-color:transparent;font-family:Microsoft YaHei UI;font-size:12pt;font-weight:normal;font-style:normal;}
			.cs8926E06{color:#000000;background-color:transparent;font-family:Calibri;font-size:12pt;font-weight:normal;font-style:normal;}
			.csD6CA00D2{color:#4F81BD;background-color:transparent;font-family:Microsoft YaHei UI;font-size:12pt;font-weight:bold;font-style:normal;}
			.csE3F655E4{color:#000000;background-color:transparent;font-family:Microsoft YaHei UI;font-size:12pt;font-weight:bold;font-style:normal;}
			.cs3A447A38{text-align:left;text-indent:0pt;margin:0pt 0pt 10pt 0pt}
			.cs9FB05234{color:#000000;background-color:transparent;font-family:Consolas;font-size:11pt;font-weight:normal;font-style:normal;}
		</style>
	</head>
	<body>
		<h1 class="csAD577193">
			<a name="cve-2019-11231getsimple-cms-远程命令执行"><span class="csECDA2D3">（</span><span class="csDE05BCC">CVE-2019-11231</span><span class="csECDA2D3">）</span><span class="csDE05BCC">GetSimple CMS </span><span class="csECDA2D3">远程命令执行</span></a></h1>
		<h2 class="cs868C439D">
			<a name="一漏洞简介"><span class="cs83F14626">一、漏洞简介</span></a></h2>
		<p class="cs40DD2BC9"><span class="cs9C1B1871">在</span><span class="cs8926E06">GetSimple 3.3.15</span><span class="cs9C1B1871">版本中，攻击者可以通过伪造管理员</span><span class="cs8926E06">cookie</span><span class="cs9C1B1871">，绕过身份验证登陆后台，进而通过后台编辑模板功能模块写入</span><span class="cs8926E06">php</span><span class="cs9C1B1871">代码，造成远程代码执行漏洞。</span></p><h2 class="cs868C439D">
			<a name="二漏洞影响"><span class="cs83F14626">二、漏洞影响</span></a></h2>
		<p class="cs40DD2BC9"><span class="cs8926E06">GetSimple&lt;=3.3.15</span></p><h2 class="cs868C439D">
			<a name="三复现过程"><span class="cs83F14626">三、复现过程</span></a></h2>
		<h3 class="cs868C439D">
			<a name="漏洞分析"><span class="csD6CA00D2">漏洞分析</span></a></h3>
		<p class="cs40DD2BC9"><span class="cs9C1B1871">在分析该漏洞前，不得不提</span><span class="cs8926E06">.htaccess</span><span class="cs9C1B1871">文件，本次漏洞的产生，是因为默认情况下</span><span class="cs8926E06">apache</span><span class="cs9C1B1871">对</span><span class="cs8926E06">.htaccess</span><span class="cs9C1B1871">配置文件的开启情况不同而产生的。</span></p><p class="cs40DD2BC9"><span class="cs8926E06">htaccess</span><span class="cs9C1B1871">文件是</span><span class="cs8926E06">Apache</span><span class="cs9C1B1871">服务器中的配置文件，它负责相关目录下的网页配置。通过配置</span><span class="cs8926E06">htaccess</span><span class="cs9C1B1871">文件，可以实现众多功能，例如：允许</span><span class="cs8926E06">/</span><span class="cs9C1B1871">阻止特定的用户或者目录的访问、禁止目录列表、配置默认文档等。</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">启用</span><span class="cs8926E06">.htaccess</span><span class="cs9C1B1871">，需要在</span><span class="cs8926E06">apache</span><span class="cs9C1B1871">配置文件中，启用</span><span class="cs8926E06">AllowOverride</span><span class="cs9C1B1871">。</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">在笔者测试了两款环境，分别为配置了</span><span class="cs8926E06">wamp</span><span class="cs9C1B1871">的</span><span class="cs8926E06">windows</span><span class="cs9C1B1871">与</span><span class="cs8926E06">ubuntu</span><span class="cs9C1B1871">服务器，在这两个环境中，默认情况对</span><span class="cs8926E06">htaccess</span><span class="cs9C1B1871">文件的启用情况是不同的。</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">先来看安装有</span><span class="cs8926E06">wamp</span><span class="cs9C1B1871">的</span><span class="cs8926E06">windows</span><span class="cs9C1B1871">环境，打开</span><span class="cs8926E06">apahce</span><span class="cs9C1B1871">配置文件</span><span class="cs8926E06">httpd.conf</span></p><p class="cs40DD2BC9"><span><img src="Web安全/GetSimple_CMS/%ef%bc%88CVE-2019-11231%ef%bc%89GetSimple%20CMS%e8%bf%9c%e7%a8%8b%e5%91%bd%e4%bb%a4%e6%89%a7%e8%a1%8c_files/image0.png" width="560" height="256" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">可以看到，这里将位于</span><span class="cs8926E06">conf/extra/httpd-vhosts.conf</span><span class="cs9C1B1871">文件导入</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">跟进</span><span class="cs8926E06"> httpd-vhosts.conf</span><span class="cs9C1B1871">文件</span></p><p class="cs40DD2BC9"><span><img src="Web安全/GetSimple_CMS/%ef%bc%88CVE-2019-11231%ef%bc%89GetSimple%20CMS%e8%bf%9c%e7%a8%8b%e5%91%bd%e4%bb%a4%e6%89%a7%e8%a1%8c_files/image1.png" width="560" height="360" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">可以看到，在这里，默认情况下</span><span class="cs8926E06"> AllowOverride </span><span class="cs9C1B1871">默认值是</span><span class="cs8926E06">All</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">当</span><span class="cs8926E06">AllowOverride</span><span class="cs9C1B1871">指令设置为</span><span class="cs8926E06"> All</span><span class="cs9C1B1871">时，所有具有</span><span class="cs8926E06">&rdquo;.htaccess&rdquo;</span><span class="cs9C1B1871">作用域的指令都允许出现在</span><span class="cs8926E06">.htaccess</span><span class="cs9C1B1871">文件中。</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">此时，目录中的</span><span class="cs8926E06">.htaccess</span><span class="cs9C1B1871">配置文件为启用状态</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">例如位于</span><span class="cs8926E06">getsimplecms/data</span><span class="cs9C1B1871">目录中的</span><span class="cs8926E06">.htaccess</span><span class="cs9C1B1871">配置文件</span></p><p class="cs40DD2BC9"><span><img src="Web安全/GetSimple_CMS/%ef%bc%88CVE-2019-11231%ef%bc%89GetSimple%20CMS%e8%bf%9c%e7%a8%8b%e5%91%bd%e4%bb%a4%e6%89%a7%e8%a1%8c_files/image2.png" width="560" height="225" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span><img src="Web安全/GetSimple_CMS/%ef%bc%88CVE-2019-11231%ef%bc%89GetSimple%20CMS%e8%bf%9c%e7%a8%8b%e5%91%bd%e4%bb%a4%e6%89%a7%e8%a1%8c_files/image3.png" width="560" height="379" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">当此</span><span class="cs8926E06">.htaccess</span><span class="cs9C1B1871">配置文件被加载时，是禁止该目录被</span><span class="cs8926E06">web</span><span class="cs9C1B1871">端访问的</span></p><p class="cs40DD2BC9"><span><img src="Web安全/GetSimple_CMS/%ef%bc%88CVE-2019-11231%ef%bc%89GetSimple%20CMS%e8%bf%9c%e7%a8%8b%e5%91%bd%e4%bb%a4%e6%89%a7%e8%a1%8c_files/image4.png" width="560" height="199" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">也就是说，通过该方法，通过</span><span class="cs8926E06">web</span><span class="cs9C1B1871">端访问</span><span class="cs8926E06">data</span><span class="cs9C1B1871">目录时，不会显示其中文件列表</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">与其中文件内容，是可以很好的保护存在于该目录下的文件，不被泄露</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">但是在笔者的</span><span class="cs8926E06">ubuntu</span><span class="cs9C1B1871">服务器，</span><span class="cs8926E06">ubuntu apache2.conf</span><span class="cs9C1B1871">中</span></p><p class="cs40DD2BC9"><span><img src="Web安全/GetSimple_CMS/%ef%bc%88CVE-2019-11231%ef%bc%89GetSimple%20CMS%e8%bf%9c%e7%a8%8b%e5%91%bd%e4%bb%a4%e6%89%a7%e8%a1%8c_files/image5.png" width="419" height="349" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs8926E06">AllowOverride </span><span class="cs9C1B1871">默认值是</span><span class="cs8926E06">None</span><span class="cs9C1B1871">，默认的情况下，不加载目录中的</span><span class="cs8926E06">.htaccess</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">我们将上述的</span><span class="cs8926E06">.htaccess</span><span class="cs9C1B1871">文件放入</span><span class="cs8926E06">ubuntu</span><span class="cs9C1B1871">服务器的</span><span class="cs8926E06">web</span><span class="cs9C1B1871">目录中</span></p><p class="cs40DD2BC9"><span><img src="Web安全/GetSimple_CMS/%ef%bc%88CVE-2019-11231%ef%bc%89GetSimple%20CMS%e8%bf%9c%e7%a8%8b%e5%91%bd%e4%bb%a4%e6%89%a7%e8%a1%8c_files/image6.png" width="527" height="145" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">再通过浏览器访问这个路径</span></p><p class="cs40DD2BC9"><span><img src="Web安全/GetSimple_CMS/%ef%bc%88CVE-2019-11231%ef%bc%89GetSimple%20CMS%e8%bf%9c%e7%a8%8b%e5%91%bd%e4%bb%a4%e6%89%a7%e8%a1%8c_files/image7.png" width="560" height="342" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">如上图可见，</span><span class="cs8926E06">.htaccess</span><span class="cs9C1B1871">并没有生效，而路径中的文件，是可以被泄露的</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">回归到本次漏洞：</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">访问</span><span class="cs8926E06">http://127.0.0.1/getsimplecms/data/users/admin.xml</span></p><p class="cs40DD2BC9"><span><img src="Web安全/GetSimple_CMS/%ef%bc%88CVE-2019-11231%ef%bc%89GetSimple%20CMS%e8%bf%9c%e7%a8%8b%e5%91%bd%e4%bb%a4%e6%89%a7%e8%a1%8c_files/image8.png" width="560" height="162" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">在</span><span class="cs8926E06">.htaccess</span><span class="cs9C1B1871">没有生效的情况下，我们获取</span><span class="cs8926E06">admin.xml</span><span class="cs9C1B1871">中记录的用户相关信息，该</span><span class="cs8926E06">cms</span><span class="cs9C1B1871">并没有将用户信息写入数据库，而是全部存于该文件中</span></p><p class="cs40DD2BC9"><span><img src="Web安全/GetSimple_CMS/%ef%bc%88CVE-2019-11231%ef%bc%89GetSimple%20CMS%e8%bf%9c%e7%a8%8b%e5%91%bd%e4%bb%a4%e6%89%a7%e8%a1%8c_files/image9.png" width="560" height="132" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">访问</span><span class="cs8926E06">http://127.0.0.1/getsimplecms/data/other/authorization.xml</span><span class="cs9C1B1871">获取</span><span class="cs8926E06">authorization.xml</span><span class="cs9C1B1871">中记录的</span><span class="cs8926E06">apikey</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">现在我们得到如下的信息：（用户名</span><span class="cs8926E06">/</span><span class="cs9C1B1871">加密后的密码</span><span class="cs8926E06">/apikey</span><span class="cs9C1B1871">）</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">该</span><span class="cs8926E06">cms</span><span class="cs9C1B1871">并没有将用户信息写入数据库，而是全部存于</span><span class="cs8926E06">xml</span><span class="cs9C1B1871">文件中</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">通过获取的信息，接下来进一步分析如何利用这些泄露的信息：</span></p><p class="cs40DD2BC9"><span class="cs8926E06">Cookie</span><span class="csE3F655E4">算法分析：</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">分析下</span><span class="cs8926E06">GetSimple</span><span class="cs9C1B1871">中的</span><span class="cs8926E06">cookie</span><span class="cs9C1B1871">是如何生成的</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">位于</span><span class="cs8926E06">\GetSimpleCMS\admin\inc\cookie_functions.php</span></p><p class="cs40DD2BC9"><span class="cs8926E06">create_cookie</span><span class="cs9C1B1871">方法</span></p><p class="cs40DD2BC9"><span><img src="Web安全/GetSimple_CMS/%ef%bc%88CVE-2019-11231%ef%bc%89GetSimple%20CMS%e8%bf%9c%e7%a8%8b%e5%91%bd%e4%bb%a4%e6%89%a7%e8%a1%8c_files/image10.png" width="560" height="237" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">计算</span><span class="cs8926E06">cookie</span><span class="cs9C1B1871">所需的</span><span class="cs8926E06">$USR $SALT </span><span class="cs9C1B1871">对应如下：</span></p><p class="cs40DD2BC9"><span class="cs8926E06">GetSimpleCMS\data\users\admin.xml</span><span class="cs9C1B1871">文件</span></p><p class="cs40DD2BC9"><span><img src="Web安全/GetSimple_CMS/%ef%bc%88CVE-2019-11231%ef%bc%89GetSimple%20CMS%e8%bf%9c%e7%a8%8b%e5%91%bd%e4%bb%a4%e6%89%a7%e8%a1%8c_files/image11.png" width="560" height="98" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span><img src="Web安全/GetSimple_CMS/%ef%bc%88CVE-2019-11231%ef%bc%89GetSimple%20CMS%e8%bf%9c%e7%a8%8b%e5%91%bd%e4%bb%a4%e6%89%a7%e8%a1%8c_files/image12.png" width="560" height="150" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs8926E06">getsimplecms\data\other\authorization.xml</span></p><p class="cs40DD2BC9"><span><img src="Web安全/GetSimple_CMS/%ef%bc%88CVE-2019-11231%ef%bc%89GetSimple%20CMS%e8%bf%9c%e7%a8%8b%e5%91%bd%e4%bb%a4%e6%89%a7%e8%a1%8c_files/image13.png" width="560" height="107" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span><img src="Web安全/GetSimple_CMS/%ef%bc%88CVE-2019-11231%ef%bc%89GetSimple%20CMS%e8%bf%9c%e7%a8%8b%e5%91%bd%e4%bb%a4%e6%89%a7%e8%a1%8c_files/image14.png" width="560" height="133" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">这些信息是可以直接读取出来的</span></p><p class="cs40DD2BC9"><span class="cs8926E06">getsimplecms </span><span class="cs9C1B1871">中</span><span class="cs8926E06">Cookie</span><span class="cs9C1B1871">的算法的实现如下</span><span class="cs8926E06">:</span></p><p class="cs40DD2BC9"><span><img src="Web安全/GetSimple_CMS/%ef%bc%88CVE-2019-11231%ef%bc%89GetSimple%20CMS%e8%bf%9c%e7%a8%8b%e5%91%bd%e4%bb%a4%e6%89%a7%e8%a1%8c_files/image15.png" width="560" height="204" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">算法相对简单，通过</span><span class="cs8926E06">$SALT</span><span class="cs9C1B1871">值与</span><span class="cs8926E06">$USR</span><span class="cs9C1B1871">进行拼接；</span><span class="cs8926E06">$SALT</span><span class="cs9C1B1871">值与</span><span class="cs8926E06">$cookie_name</span><span class="cs9C1B1871">拼接，最终通过</span><span class="cs8926E06">sha1</span><span class="cs9C1B1871">进行加密，算出对应的</span><span class="cs8926E06">cookie</span><span class="cs9C1B1871">键值对</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">通过泄露的文件与</span><span class="cs8926E06">cookie</span><span class="cs9C1B1871">算法，可以顺利计算出对应用户的</span><span class="cs8926E06">cookie</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">现在，可以伪造任意成员的</span><span class="cs8926E06">cookie</span><span class="cs9C1B1871">了</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">以</span><span class="cs8926E06">USR :admin</span><span class="cs9C1B1871">举例说明：</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">最终拼接的</span><span class="cs8926E06">cookie</span><span class="cs9C1B1871">为：</span></p><p class="cs40DD2BC9"><span class="cs8926E06">GS_ADMIN_USERNAME=admin;48fd5258d478eec2a8f417f358c767c992f01b51=8ce411833fcfaedf4fcf5390132a153c00e0482c</span></p><p class="cs40DD2BC9"><span class="cs8926E06">Password</span><span class="csE3F655E4">算法分析：</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">分析下</span><span class="cs8926E06">Password</span><span class="cs9C1B1871">的计算方式</span></p><p class="cs40DD2BC9"><span><img src="Web安全/GetSimple_CMS/%ef%bc%88CVE-2019-11231%ef%bc%89GetSimple%20CMS%e8%bf%9c%e7%a8%8b%e5%91%bd%e4%bb%a4%e6%89%a7%e8%a1%8c_files/image16.png" width="415" height="131" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs8926E06">Password</span><span class="cs9C1B1871">的加密，是通过</span><span class="cs8926E06">passhash()</span><span class="cs9C1B1871">方法来实现的</span></p><p class="cs40DD2BC9"><span><img src="Web安全/GetSimple_CMS/%ef%bc%88CVE-2019-11231%ef%bc%89GetSimple%20CMS%e8%bf%9c%e7%a8%8b%e5%91%bd%e4%bb%a4%e6%89%a7%e8%a1%8c_files/image17.png" width="560" height="199" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs8926E06">GSLOGINSALT</span><span class="cs9C1B1871">是用来保护的密码的额外的</span><span class="cs8926E06">salt</span><span class="cs9C1B1871">值，默认情况为空。</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">所以这里的密码计算就比较直接了，通过</span><span class="cs8926E06">sha1</span><span class="cs9C1B1871">方法对明文密码进行加密</span></p><p class="cs3A447A38"><span class="cs9FB05234">sha1($p)</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">通过</span><span class="cs8926E06">sha1 hash</span><span class="cs9C1B1871">将明文密码加密为密文。</span></p><p class="cs40DD2BC9"><span><img src="Web安全/GetSimple_CMS/%ef%bc%88CVE-2019-11231%ef%bc%89GetSimple%20CMS%e8%bf%9c%e7%a8%8b%e5%91%bd%e4%bb%a4%e6%89%a7%e8%a1%8c_files/image18.png" width="560" height="87" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">也就是说，只要获取了加密后的</span><span class="cs8926E06">password</span><span class="cs9C1B1871">，有一定几率，可以破解为明文：</span></p><p class="cs40DD2BC9"><span><img src="Web安全/GetSimple_CMS/%ef%bc%88CVE-2019-11231%ef%bc%89GetSimple%20CMS%e8%bf%9c%e7%a8%8b%e5%91%bd%e4%bb%a4%e6%89%a7%e8%a1%8c_files/image19.png" width="560" height="219" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">获取到管理员</span><span class="cs8926E06">cookie/password</span><span class="cs9C1B1871">后，使用管理员账号登陆后台</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">通过伪造</span><span class="cs8926E06">cookie</span><span class="cs9C1B1871">访问后台：</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">未登录时，访问后台地址</span></p><p class="cs40DD2BC9"><span><img src="Web安全/GetSimple_CMS/%ef%bc%88CVE-2019-11231%ef%bc%89GetSimple%20CMS%e8%bf%9c%e7%a8%8b%e5%91%bd%e4%bb%a4%e6%89%a7%e8%a1%8c_files/image20.png" width="560" height="380" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span><img src="Web安全/GetSimple_CMS/%ef%bc%88CVE-2019-11231%ef%bc%89GetSimple%20CMS%e8%bf%9c%e7%a8%8b%e5%91%bd%e4%bb%a4%e6%89%a7%e8%a1%8c_files/image21.png" width="560" height="254" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">此时需要填写正确的用户名密码才可以登陆后台</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">这里，通过改包的方式，将</span><span class="cs8926E06">cookie</span><span class="cs9C1B1871">修改为之前计算出的值</span></p><p class="cs40DD2BC9"><span><img src="Web安全/GetSimple_CMS/%ef%bc%88CVE-2019-11231%ef%bc%89GetSimple%20CMS%e8%bf%9c%e7%a8%8b%e5%91%bd%e4%bb%a4%e6%89%a7%e8%a1%8c_files/image22.png" width="560" height="218" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">此时，无需登陆，直接进入后台</span></p><p class="cs40DD2BC9"><span><img src="Web安全/GetSimple_CMS/%ef%bc%88CVE-2019-11231%ef%bc%89GetSimple%20CMS%e8%bf%9c%e7%a8%8b%e5%91%bd%e4%bb%a4%e6%89%a7%e8%a1%8c_files/image23.png" width="560" height="211" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">访问如下</span><span class="cs8926E06">url</span></p><p class="cs40DD2BC9"><span class="cs8926E06">http://127.0.0.1/getsimplecms/admin/theme-edit.php</span></p><p class="cs40DD2BC9"><span><img src="Web安全/GetSimple_CMS/%ef%bc%88CVE-2019-11231%ef%bc%89GetSimple%20CMS%e8%bf%9c%e7%a8%8b%e5%91%bd%e4%bb%a4%e6%89%a7%e8%a1%8c_files/image24.png" width="560" height="374" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">在这里可以对模板文件进行编辑，在这里可以写入任意</span><span class="cs8926E06">php</span><span class="cs9C1B1871">代码，造成远程代码执行漏洞</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">例如：</span></p><p class="cs40DD2BC9"><span><img src="Web安全/GetSimple_CMS/%ef%bc%88CVE-2019-11231%ef%bc%89GetSimple%20CMS%e8%bf%9c%e7%a8%8b%e5%91%bd%e4%bb%a4%e6%89%a7%e8%a1%8c_files/image25.png" width="560" height="178" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">访问如下地址：</span></p><p class="cs40DD2BC9"><span class="cs8926E06">http://127.0.0.1/getsimplecms/theme/Innovation/template.php</span></p><p class="cs40DD2BC9"><span><img src="Web安全/GetSimple_CMS/%ef%bc%88CVE-2019-11231%ef%bc%89GetSimple%20CMS%e8%bf%9c%e7%a8%8b%e5%91%bd%e4%bb%a4%e6%89%a7%e8%a1%8c_files/image26.png" width="560" height="338" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">插入的</span><span class="cs8926E06">php</span><span class="cs9C1B1871">代码被成功执行</span></p></body>
</html>
