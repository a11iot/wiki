<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>
		</title>
		<style type="text/css">
			.csAD577193{text-align:left;text-indent:0pt;margin:24pt 0pt 0pt 0pt;page-break-after:avoid;page-break-inside:avoid}
			.csDE05BCC{color:#4F81BD;background-color:transparent;font-family:Calibri;font-size:16pt;font-weight:bold;font-style:normal;}
			.csECDA2D3{color:#4F81BD;background-color:transparent;font-family:Microsoft YaHei UI;font-size:16pt;font-weight:bold;font-style:normal;}
			.cs868C439D{text-align:left;text-indent:0pt;margin:10pt 0pt 0pt 0pt;page-break-after:avoid;page-break-inside:avoid}
			.cs83F14626{color:#4F81BD;background-color:transparent;font-family:Microsoft YaHei UI;font-size:14pt;font-weight:bold;font-style:normal;}
			.cs40DD2BC9{text-align:left;text-indent:0pt;margin:9pt 0pt 9pt 0pt}
			.cs8926E06{color:#000000;background-color:transparent;font-family:Calibri;font-size:12pt;font-weight:normal;font-style:normal;}
			.csD6CA00D2{color:#4F81BD;background-color:transparent;font-family:Microsoft YaHei UI;font-size:12pt;font-weight:bold;font-style:normal;}
			.cs9C1B1871{color:#000000;background-color:transparent;font-family:Microsoft YaHei UI;font-size:12pt;font-weight:normal;font-style:normal;}
			.cs3A447A38{text-align:left;text-indent:0pt;margin:0pt 0pt 10pt 0pt}
			.cs9FB05234{color:#000000;background-color:transparent;font-family:Consolas;font-size:11pt;font-weight:normal;font-style:normal;}
			.cs2F00A314{color:#000000;background-color:transparent;font-family:Calibri;font-size:12pt;font-weight:normal;font-style:italic;}
			.csE9AB290{color:#000000;background-color:transparent;font-family:Calibri;font-size:12pt;font-weight:normal;font-style:italic;text-decoration: none;}
			.csBF12A472{color:#4F81BD;background-color:transparent;font-family:Calibri;font-size:12pt;font-weight:normal;font-style:italic;}
			.cs508254C{color:#000000;background-color:transparent;font-family:Calibri;font-size:12pt;font-weight:normal;font-style:normal;text-decoration: none;}
			.cs4B51D5E4{color:#4F81BD;background-color:transparent;font-family:Calibri;font-size:12pt;font-weight:normal;font-style:normal;}
			.cs6FD73CFB{text-align:left;text-indent:0pt;margin:5pt 24pt 5pt 24pt}
		</style>
	</head>
	<body>
		<h1 class="csAD577193">
			<a name="yzmcms-v53-后台ssrf"><span class="csDE05BCC">YzmCMS V5.3 </span><span class="csECDA2D3">后台</span><span class="csDE05BCC">ssrf</span></a></h1>
		<h2 class="cs868C439D">
			<a name="一、漏洞简介"><span class="cs83F14626">一、漏洞简介</span></a></h2>
		<h2 class="cs868C439D">
			<a name="二、漏洞影响"><span class="cs83F14626">二、漏洞影响</span></a></h2>
		<p class="cs40DD2BC9"><span class="cs8926E06">YzmCMS V5.3</span></p><h2 class="cs868C439D">
			<a name="三、复现过程"><span class="cs83F14626">三、复现过程</span></a></h2>
		<h3 class="cs868C439D">
			<a name="漏洞分析"><span class="csD6CA00D2">漏洞分析</span></a></h3>
		<p class="cs40DD2BC9"><span class="cs9C1B1871">漏洞位于</span><span class="cs8926E06"> application\collection\controller\collection_content.class.php </span><span class="cs9C1B1871">中的</span><span class="cs8926E06"> collection_test </span><span class="cs9C1B1871">函数，此函数为获取一个网页中的</span><span class="cs8926E06">URL</span><span class="cs9C1B1871">，并获取此</span><span class="cs8926E06">URL</span><span class="cs9C1B1871">的值输出。类似于爬虫，爬取网页中</span><span class="cs8926E06">URL</span><span class="cs9C1B1871">对应的文章。以下为主要功能函数：　</span></p><p class="cs40DD2BC9"><span><img src="Web安全/YzmCMS/YzmCMS%20V5.3%20%e5%90%8e%e5%8f%b0ssrf%20_files/image0.png" width="560" height="118" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">首先查看</span><span class="cs8926E06"> get_content()</span><span class="cs9C1B1871">函数：</span></p><p class="cs40DD2BC9"><span><img src="Web安全/YzmCMS/YzmCMS%20V5.3%20%e5%90%8e%e5%8f%b0ssrf%20_files/image1.png" width="560" height="387" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">可以看到传进来的</span><span class="cs8926E06">URL</span><span class="cs9C1B1871">不进过任何检测规则就带入</span><span class="cs8926E06"> file_get_content()</span><span class="cs9C1B1871">函数，那么倘若此</span><span class="cs8926E06"> $url </span><span class="cs9C1B1871">为</span><span class="cs8926E06"> file:// </span><span class="cs9C1B1871">伪协议的话，如此则产生任意文件读取漏洞。那么此时回头看</span><span class="cs8926E06"> $url</span><span class="cs9C1B1871">的值是否可控。</span></p><p class="cs40DD2BC9"><span><img src="Web安全/YzmCMS/YzmCMS%20V5.3%20%e5%90%8e%e5%8f%b0ssrf%20_files/image2.png" width="560" height="170" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">可以看到，</span><span class="cs8926E06">$url </span><span class="cs9C1B1871">的值来自于</span><span class="cs8926E06"> collection_node </span><span class="cs9C1B1871">表中的</span><span class="cs8926E06"> urlpage </span><span class="cs9C1B1871">字段的值。如果要</span><span class="cs8926E06"> $url </span><span class="cs9C1B1871">可控，那么就要找到一个数据库写入操作，并且</span><span class="cs8926E06">urlpage </span><span class="cs9C1B1871">字段的值可控。再看</span></p><p class="cs40DD2BC9"><span><img src="Web安全/YzmCMS/YzmCMS%20V5.3%20%e5%90%8e%e5%8f%b0ssrf%20_files/image3.png" width="560" height="256" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">此函数则是将</span><span class="cs8926E06">$_POST</span><span class="cs9C1B1871">的数据写入到表中。看</span><span class="cs8926E06"> insert </span><span class="cs9C1B1871">函数如何写。</span></p><p class="cs40DD2BC9"><span><img src="Web安全/YzmCMS/YzmCMS%20V5.3%20%e5%90%8e%e5%8f%b0ssrf%20_files/image4.png" width="560" height="158" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">可以看到在写入过程中经过过滤函数</span><span class="cs8926E06"> safe_data() </span><span class="cs9C1B1871">：</span></p><p class="cs40DD2BC9"><span><img src="Web安全/YzmCMS/YzmCMS%20V5.3%20%e5%90%8e%e5%8f%b0ssrf%20_files/image5.png" width="560" height="124" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">假设</span><span class="cs8926E06">payload</span><span class="cs9C1B1871">为：</span><span class="cs8926E06">file://C:/Windows/System32/drivers/etc/hosts </span><span class="cs9C1B1871">可以看到此过滤函数对此</span><span class="cs8926E06">payload</span><span class="cs9C1B1871">并无任何影响，所以导致插入数据库中的</span><span class="cs8926E06">urlpage</span><span class="cs9C1B1871">字段的值可控，由此导致</span><span class="cs8926E06">$url</span><span class="cs9C1B1871">的值可控。再往下查看</span><span class="cs8926E06"> get_sub_content()</span><span class="cs9C1B1871">函数：</span></p><p class="cs40DD2BC9"><span><img src="Web安全/YzmCMS/YzmCMS%20V5.3%20%e5%90%8e%e5%8f%b0ssrf%20_files/image6.png" width="560" height="251" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">可以看到此函数是将</span><span class="cs8926E06"> $html </span><span class="cs9C1B1871">中的</span><span class="cs8926E06"> $start </span><span class="cs9C1B1871">和</span><span class="cs8926E06"> $end </span><span class="cs9C1B1871">之间的值取出来，而</span><span class="cs8926E06"> $start </span><span class="cs9C1B1871">表示区间开始的</span><span class="cs8926E06">html</span><span class="cs9C1B1871">表示，</span><span class="cs8926E06">$end </span><span class="cs9C1B1871">表示区间结束的</span><span class="cs8926E06">html</span><span class="cs9C1B1871">标识。并且这两个标识不能为空。于是可以构造</span><span class="cs8926E06">payload</span><span class="cs9C1B1871">为：</span><span class="cs8926E06">file://C:/Windows/System32/drivers/etc/hosts</span><span class="cs9C1B1871">，如此进过上述函数则会取出</span><span class="cs8926E06">payload</span><span class="cs9C1B1871">并返回。再往下：</span></p><p class="cs40DD2BC9"><span><img src="Web安全/YzmCMS/YzmCMS%20V5.3%20%e5%90%8e%e5%8f%b0ssrf%20_files/image7.png" width="560" height="215" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">进入</span><span class="cs8926E06">get_all_url()</span><span class="cs9C1B1871">函数：</span></p><p class="cs3A447A38"><span class="cs9FB05234">public static function get_all_url($html, $url_contain=&#39;&#39;, $url_except=&#39;&#39;) {</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$html = str_replace(array(&quot;\r&quot;, &quot;\n&quot;), &#39;&#39;, $html);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$html = str_replace(array(&quot;&lt;/a&gt;&quot;, &quot;&lt;/A&gt;&quot;), &quot;&lt;/a&gt;\n&quot;, $html);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;preg_match_all(&#39;/&lt;a ([^&gt;]*)&gt;([^\/a&gt;].*)&lt;\/a&gt;/i&#39;, $html, $out);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$data = array();</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach ($out[1] as $k=&gt;$v) {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (preg_match(&#39;/href=[\&#39;&quot;]?([^\&#39;&quot; ]*)[\&#39;&quot;]?/i&#39;, $v, $match_out)) {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($url_contain) {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (strpos($match_out[1], $url_contain) === false) {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} </span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($url_except) {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (strpos($match_out[1], $url_except) !== false) {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} </span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$url2 = $match_out[1];</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$url2 = self::url_check($url2, self::$url);</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$title = strip_tags($out[2][$k]);</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(empty($url2) || empty($title)) continue;</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$data[&#39;url&#39;][$k] = $url2;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$data[&#39;title&#39;][$k] = $title;</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">发现其中有一个正则过滤：</span><span class="cs8926E06"> preg_match_all(&#39;/]</span><span class="cs2F00A314">)&gt;(<a class="csE9AB290" href="#fn_%5C/a%3E"><span class="csBF12A472"><sup>\/a&gt;</sup></span></a></span><span class="cs2F00A314">.</span><span class="cs8926E06">)&lt;\/a&gt;/i&#39;, $html, $out); </span><span class="cs9C1B1871">，此正则获取</span><span class="cs8926E06">(value)</span><span class="cs9C1B1871">括号中的值，并将其合并为一个数组。再往下看，又出现一个正则过滤：</span></p><p class="cs40DD2BC9"><span class="cs8926E06">preg_match(&#39;/href=[\&#39;&quot;]?(<a class="cs508254C" href="#fn_%5C%27"><span class="cs4B51D5E4"><sup>\&#39;&quot;</sup></span></a></span><span class="cs8926E06"> *)[\&#39;&quot;]?/i&#39;, $v, $match_out) </span><span class="cs9C1B1871">，此规则为</span><span class="cs8926E06">href=&quot;(value)&quot;</span><span class="cs9C1B1871">，并获取括号中</span><span class="cs8926E06">value</span><span class="cs9C1B1871">的值给</span><span class="cs8926E06">$match_out</span><span class="cs9C1B1871">，那么此时我们的</span><span class="cs8926E06">payload</span><span class="cs9C1B1871">需更改为：</span></p><p class="cs3A447A38"><span class="cs9FB05234">&lt;test123&gt;&lt;a href=&quot;file://C:/Windows/System32/drivers/etc/hosts&quot;&gt;test&lt;/a&gt;&lt;/test123&gt;</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">此时在往下看，有一个</span><span class="cs8926E06">url_check</span><span class="cs9C1B1871">函数：</span></p><p class="cs40DD2BC9"><span><img src="Web安全/YzmCMS/YzmCMS%20V5.3%20%e5%90%8e%e5%8f%b0ssrf%20_files/image8.png" width="560" height="225" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">可以看到会检测最后取出</span><span class="cs8926E06">payload</span><span class="cs9C1B1871">的值中是否有</span><span class="cs8926E06"> :// </span><span class="cs9C1B1871">，巧的是我们的</span><span class="cs8926E06">payload</span><span class="cs9C1B1871">正好符合，所以该检测函数并未对</span><span class="cs8926E06">payload</span><span class="cs9C1B1871">造成影响。再往下回到最初的函数中：</span></p><p class="cs40DD2BC9"><span><img src="Web安全/YzmCMS/YzmCMS%20V5.3%20%e5%90%8e%e5%8f%b0ssrf%20_files/image9.png" width="560" height="56" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">至此，</span><span class="cs8926E06">$articleurl </span><span class="cs9C1B1871">的值为我们最后的</span><span class="cs8926E06">payload</span><span class="cs9C1B1871">：</span><span class="cs8926E06"> file://C:/Windows/System32/drivers/etc/hosts </span><span class="cs9C1B1871">，直至此时，</span><span class="cs8926E06">$article </span><span class="cs9C1B1871">的值为读取到的本地任意文件的内容，再往下看</span><span class="cs8926E06"> get_filter_html()</span><span class="cs9C1B1871">函数：</span></p><p class="cs3A447A38"><span class="cs9FB05234">$data``[``&#39;content&#39;``] = self::replace_item(self::get_sub_content(``$html``, ``$config``[``&#39;content_rule&#39;``][0], ``$config``[``&#39;content_rule&#39;``][1]), ``$config``[``&#39;content_html_rule&#39;``]); ``return` `$data``;</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">由于篇幅限制，只拿出影响读取内容的代码，其实这段代码对结果并无影响，有兴趣自己下来阅读。在往下看到：</span></p><p class="cs40DD2BC9"><span><img src="Web安全/YzmCMS/YzmCMS%20V5.3%20%e5%90%8e%e5%8f%b0ssrf%20_files/image10.png" width="509" height="51" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs8926E06">admin_tpl()</span><span class="cs9C1B1871">函数为加载模板的函数，此模板位于：</span><span class="cs8926E06">application\collection\view\collection_test.html</span></p><p class="cs40DD2BC9"><span><img src="Web安全/YzmCMS/YzmCMS%20V5.3%20%e5%90%8e%e5%8f%b0ssrf%20_files/image11.png" width="560" height="29" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">此处只截出影响此漏洞的代码。此处可以看到，将读取出的任意文件内容显示出来，到此则漏洞分析完毕。</span></p><h3 class="cs868C439D">
			<a name="漏洞复现"><span class="csD6CA00D2">漏洞复现</span></a></h3>
		<p class="cs40DD2BC9"><span class="cs9C1B1871">操作系统：</span><span class="cs8926E06">windows 7</span></p><p class="cs40DD2BC9"><span class="cs8926E06">php</span><span class="cs9C1B1871">版本：</span><span class="cs8926E06">5.5.38 + Apache</span></p><p class="cs40DD2BC9"><span class="cs8926E06">mysql</span><span class="cs9C1B1871">版本：</span><span class="cs8926E06">5.5.53</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">首先登陆后台，进入</span><span class="cs8926E06"> </span><span class="cs9C1B1871">模块管理</span><span class="cs8926E06">---&gt;</span><span class="cs9C1B1871">采集管理</span></p><p class="cs40DD2BC9"><span><img src="Web安全/YzmCMS/YzmCMS%20V5.3%20%e5%90%8e%e5%8f%b0ssrf%20_files/image12.png" width="247" height="165" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">添加节点</span></p><p class="cs40DD2BC9"><span><img src="Web安全/YzmCMS/YzmCMS%20V5.3%20%e5%90%8e%e5%8f%b0ssrf%20_files/image13.png" width="560" height="495" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">此处网站配置框中，可以在自己的</span><span class="cs8926E06">vps</span><span class="cs9C1B1871">服务器中搭建一个</span><span class="cs8926E06">html</span><span class="cs9C1B1871">网页，其内容为</span><span class="cs8926E06">payload</span><span class="cs9C1B1871">：</span></p><p class="cs3A447A38"><span class="cs9FB05234">&lt;test123&gt;&lt;a href=&quot;file://C:/Windows/System32/drivers/etc/hosts&quot;&gt;123&lt;/a&gt;&lt;/test123&gt;</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">获取网站中的区域开始</span><span class="cs8926E06">html</span><span class="cs9C1B1871">为，区域结束的</span><span class="cs8926E06">HTML</span><span class="cs9C1B1871">为。点击保存。</span></p><p class="cs40DD2BC9"><span><img src="Web安全/YzmCMS/YzmCMS%20V5.3%20%e5%90%8e%e5%8f%b0ssrf%20_files/image14.png" width="560" height="43" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">再次点击测试采集，则读取</span><span class="cs8926E06">payload</span><span class="cs9C1B1871">中的</span><span class="cs8926E06">hosts</span><span class="cs9C1B1871">文件。</span></p><p class="cs40DD2BC9"><span><img src="Web安全/YzmCMS/YzmCMS%20V5.3%20%e5%90%8e%e5%8f%b0ssrf%20_files/image15.png" width="560" height="577" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">复现成功。</span></p><h2 class="cs868C439D">
			<a name="参考链接"><span class="cs83F14626">参考链接</span></a></h2>
		<p class="cs6FD73CFB"><span class="cs8926E06"><a class="cs508254C" href="https://www.cnblogs.com/Spec/p/11188198.html"><span class="cs4B51D5E4">https://www.cnblogs.com/Spec/p/11188198.html</span></a></span></p></body>
</html>
