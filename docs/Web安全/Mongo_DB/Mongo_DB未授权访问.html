<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>
		</title>
		<style type="text/css">
			.csAD577193{text-align:left;text-indent:0pt;margin:24pt 0pt 0pt 0pt;page-break-after:avoid;page-break-inside:avoid}
			.csDE05BCC{color:#4F81BD;background-color:transparent;font-family:Calibri;font-size:16pt;font-weight:bold;font-style:normal;}
			.csECDA2D3{color:#4F81BD;background-color:transparent;font-family:Microsoft YaHei UI;font-size:16pt;font-weight:bold;font-style:normal;}
			.cs868C439D{text-align:left;text-indent:0pt;margin:10pt 0pt 0pt 0pt;page-break-after:avoid;page-break-inside:avoid}
			.cs83F14626{color:#4F81BD;background-color:transparent;font-family:Microsoft YaHei UI;font-size:14pt;font-weight:bold;font-style:normal;}
			.cs40DD2BC9{text-align:left;text-indent:0pt;margin:9pt 0pt 9pt 0pt}
			.cs8926E06{color:#000000;background-color:transparent;font-family:Calibri;font-size:12pt;font-weight:normal;font-style:normal;}
			.cs9C1B1871{color:#000000;background-color:transparent;font-family:Microsoft YaHei UI;font-size:12pt;font-weight:normal;font-style:normal;}
			.cs24C36B3{text-align:left;margin:0pt 0pt 10pt 0pt;list-style-type:disc;color:#000000;background-color:transparent;font-family:Calibri;font-size:12pt;font-weight:normal;font-style:normal}
			.csBF12A472{color:#4F81BD;background-color:transparent;font-family:Calibri;font-size:12pt;font-weight:normal;font-style:italic;}
			.cs6EDCDAE2{color:#4F81BD;background-color:transparent;font-family:Microsoft YaHei UI;font-size:12pt;font-weight:normal;font-style:italic;}
			.cs508254C{color:#000000;background-color:transparent;font-family:Calibri;font-size:12pt;font-weight:normal;font-style:normal;text-decoration: none;}
			.cs4B51D5E4{color:#4F81BD;background-color:transparent;font-family:Calibri;font-size:12pt;font-weight:normal;font-style:normal;}
			.cs3A447A38{text-align:left;text-indent:0pt;margin:0pt 0pt 10pt 0pt}
			.cs9FB05234{color:#000000;background-color:transparent;font-family:Consolas;font-size:11pt;font-weight:normal;font-style:normal;}
			.cs7FFD2630{color:#000000;background-color:transparent;font-family:Microsoft JhengHei UI;font-size:11pt;font-weight:normal;font-style:normal;}
			.cs1C2E50E7{color:#4F81BD;background-color:transparent;font-family:Microsoft YaHei UI;font-size:12pt;font-weight:normal;font-style:normal;}
			.cs5BEC2C28{color:#000000;background-color:transparent;font-family:Calibri;font-size:12pt;font-weight:bold;font-style:normal;}
			.csE3F655E4{color:#000000;background-color:transparent;font-family:Microsoft YaHei UI;font-size:12pt;font-weight:bold;font-style:normal;}
		</style>
	</head>
	<body>
		<h1 class="csAD577193">
			<a name="mongodb未授权访问"><span class="csDE05BCC">MongoDB</span><span class="csECDA2D3">未授权访问</span></a></h1>
		<h2 class="cs868C439D">
			<a name="一、漏洞简介"><span class="cs83F14626">一、漏洞简介</span></a></h2>
		<p class="cs40DD2BC9"><span class="cs8926E06">MongoDB </span><span class="cs9C1B1871">默认直接连接，无须身份验证，如果当前机器可以公网访问，且不注意</span><span class="cs8926E06">Mongodb </span><span class="cs9C1B1871">端口（默认</span><span class="cs8926E06"> 27017</span><span class="cs9C1B1871">）的开放状态，那么</span><span class="cs8926E06">Mongodb</span><span class="cs9C1B1871">就会产生安全风险，被利用此配置漏洞，入侵数据库。</span></p><ul style="margin-top:0;margin-bottom:0;">
			<li class="cs24C36B3"><span class="cs9C1B1871">使用默认</span><span class="cs8926E06"> mongod </span><span class="cs9C1B1871">命令启动</span><span class="cs8926E06"> Mongodb</span></li><li class="cs24C36B3"><span class="cs9C1B1871">机器可以被公网访问</span></li><li class="cs24C36B3"><span class="cs9C1B1871">在公网上开放了</span><span class="cs8926E06"> Mongodb </span><span class="cs9C1B1871">端口</span></li><li class="cs24C36B3"><span class="cs9C1B1871">数据库隐私泄露</span></li><li class="cs24C36B3"><span class="cs9C1B1871">数据库被清空</span></li><li class="cs24C36B3"><span class="cs9C1B1871">数据库运行缓慢</span></li></ul>
		<h2 class="cs868C439D">
			<a name="二、影响范围"><span class="cs83F14626">二、影响范围</span></a></h2>
		<h2 class="cs868C439D">
			<a name="三、复现过程"><span class="cs83F14626">三、复现过程</span></a></h2>
		<h4 class="cs868C439D">
			<a name="X30d5b4d95da47801f709192b2554df07e6a3430"><span class="csBF12A472">1. </span><span class="cs6EDCDAE2">扫描探测</span></a></h4>
		<h4 class="cs868C439D">
			<a name="Xb1d7e2f8cfd0a518c8fa4f4e39f6778b11d8d37"><span class="csBF12A472">2. </span><span class="cs6EDCDAE2">下载：</span></a></h4>
		<p class="cs40DD2BC9"><span class="cs8926E06"><a class="cs508254C" href="http://nmap.org/svn/scripts/mongodb-info.nse"><span class="cs4B51D5E4">http://nmap.org/svn/scripts/mongodb-info.nse</span></a></span></p><p class="cs3A447A38"><span class="cs9FB05234">nmap -p 27017 --script mongodb-info &lt;ip&gt;</span></p><p class="cs40DD2BC9"><span><img src="Web安全/Mongo_DB/Mongo%20DB%e6%9c%aa%e6%8e%88%e6%9d%83%e8%ae%bf%e9%97%ae_files/image0.png" width="560" height="261" alt="" style="border-width:0px;" /></span></p><p class="cs3A447A38"><span class="cs9FB05234">vim /etc/mongodb.conf</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">dbpath = /data/</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">logpath = /var/logs/mongodb.log</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">##port = 27017</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">##fork = true</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">bind_ip = 0.0.0.0</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">./mongod &ndash;config mongodb.conf //</span><span class="cs7FFD2630">启动</span><span class="cs9FB05234">mongodb</span><span class="cs7FFD2630">加载配置</span><span class="cs9FB05234">mongodb.conf</span></p><h5 class="cs868C439D">
			<a name="X82aa782fc628b8d242a5533ea2f90e9e21cc903"><span class="cs4B51D5E4">1.1 </span><span class="cs1C2E50E7">基础</span></a></h5>
		<ul style="margin-top:0;margin-bottom:0;">
			<li class="cs24C36B3"><span class="cs8926E06"><a class="cs508254C" href="https://www.jianshu.com/p/8bf26effa737"><span class="cs4B51D5E4">https://www.jianshu.com/p/8bf26effa737</span></a></span></li><li class="cs24C36B3"><span class="cs8926E06"><a class="cs508254C" href="http://www.runoob.com/mongodb/mongodb-tutorial.html"><span class="cs4B51D5E4">http://www.runoob.com/mongodb/mongodb-tutorial.html</span></a></span></li><li class="cs24C36B3"><span class="cs8926E06"><a class="cs508254C" href="https://itbilu.com/database/mongo/E1tWQz4_e.html"><span class="cs4B51D5E4">https://itbilu.com/database/mongo/E1tWQz4_e.html</span></a></span></li></ul>
		<h5 class="cs868C439D">
			<a name="Xb588f65958418902ccaa75fb43fc725a9d79326"><span class="cs4B51D5E4">1.2 </span><span class="cs1C2E50E7">批量扫描未授权</span></a></h5>
		<p class="cs3A447A38"><span class="cs9FB05234">import socket</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">import sys</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">import pymongo</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">ipcons = []</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">def Scanner(ip):</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;global ipcons</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;sk = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;sk.settimeout(0.3)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;try:</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sk.connect((ip,27017))</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ipcons.append(ip)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sk.close()</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;except Exception:</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pass</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">def ip2num(ip):</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;ip=[int(x) for x in ip.split(&#39;.&#39;)]</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;return ip[0] &lt;&lt;24 | ip[1]&lt;&lt;16 | ip[2]&lt;&lt;8 |ip[3]</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">def num2ip(num):</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;return &#39;%s.%s.%s.%s&#39; %( (num &amp; 0xff000000) &gt;&gt;24,</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(num &amp; 0x00ff0000) &gt;&gt;16,</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(num &amp; 0x0000ff00) &gt;&gt;8,</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;num &amp; 0x000000ff )</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">def get_ip(ip):</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;start,end = [ip2num(x) for x in ip.split(&#39; &#39;) ]</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;return [ num2ip(num) for num in range(start,end+1) if num &amp; 0xff ]</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">startIp = sys.argv[1]</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">endIp = sys.argv[2]</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">iplist = get_ip(sys.argv[1]+&quot; &quot;+sys.argv[2])</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">for i in iplist:</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;Scanner(i)</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">def connMon(ip_addr):</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;print &#39; Connect mongodb: &#39; + ip_addr + &#39;:27017&#39;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;try:</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;conn = pymongo.MongoClient(ip_addr,27017,socketTimeoutMS=3000)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dbname = conn.database_names()</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot;success&quot;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;except Exception as e:</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot;error&quot;</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">print ipcons &nbsp;&nbsp;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">for ipaddr in ipcons:</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;connMon(ipaddr)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;print &quot;=================&quot;</span></p><h5 class="cs868C439D">
			<a name="X99b76d5f4b1d14aa9a9bf95e8b394e029005da8"><span class="cs4B51D5E4">1.3 shodan</span><span class="cs1C2E50E7">扫描脚本</span></a></h5>
		<p class="cs3A447A38"><span class="cs9FB05234">##!/usr/bin/python</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">## -*- coding: UTF-8 -*-</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">&#39;&#39;&#39;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">@Author</span><span class="cs7FFD2630">：</span><span class="cs9FB05234">joy_nick</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">@</span><span class="cs7FFD2630">博客：</span><span class="cs9FB05234">http://byd.dropsec.xyz/</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">&#39;&#39;&#39;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">import shodan</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">import os</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">iplist = []</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">ip_list = []</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">shodan_ip_list = []</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">def shodanSearch(keywords):</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;SHODAN_API_KEY = &quot;your key&quot;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;api = shodan.Shodan(SHODAN_API_KEY)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;total = 0</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;try:</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;results = api.search(keywords)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;total = int(results[&#39;total&#39;])</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for result in results[&#39;matches&#39;]:</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##iplist.append({&quot;ip&quot;:result[&#39;ip_str&#39;],&quot;country&quot;:result[&#39;location&#39;][&#39;country_name&#39;]})</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iplist.append(result[&#39;ip_str&#39;])</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for i in range(len(iplist)):</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ip_list = iplist[i].encode(&#39;utf-8&#39;)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shodan_ip_list.append(ip_list)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s = &#39;\n&#39;.join(shodan_ip_list)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with open(&#39;shodan_ip_list.txt&#39;,&#39;w&#39;) as output:</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output.write(s)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;except shodan.APIError, e:</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &#39;Error: %s&#39; % e</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">if __name__ == &#39;__main__&#39;:</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;shodanSearch(&#39;redis&#39;)</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">查询操作</span><span class="cs8926E06"> <img src="Web安全/Mongo_DB/Mongo%20DB%e6%9c%aa%e6%8e%88%e6%9d%83%e8%ae%bf%e9%97%ae_files/image1.png" width="560" height="344" alt="" style="border-width:0px;" /></span></p><h4 class="cs868C439D">
			<a name="X21680cc8c2ba676b6a68be13a92b40c52a96971"><span class="csBF12A472">2. </span><span class="cs6EDCDAE2">爆破脚本</span></a></h4>
		<p class="cs40DD2BC9"><span class="cs8926E06"><a class="cs508254C" href="https://github.com/netxfly/x-crack"><span class="cs4B51D5E4">https://github.com/netxfly/x-crack</span></a></span><span class="cs8926E06"> <img src="Web安全/Mongo_DB/Mongo%20DB%e6%9c%aa%e6%8e%88%e6%9d%83%e8%ae%bf%e9%97%ae_files/image2.png" width="560" height="275" alt="" style="border-width:0px;" /></span></p><h4 class="cs868C439D">
			<a name="X1d9e998c2f230a45f171569f180e492a8c820f4"><span class="csBF12A472">4. </span><span class="cs6EDCDAE2">防范措施</span></a></h4>
		<p class="cs40DD2BC9"><span class="cs5BEC2C28">(1).</span><span class="csE3F655E4">新建管理账户开启</span><span class="cs5BEC2C28">MongoDB</span><span class="csE3F655E4">授权</span><span class="cs8926E06"><br/></span><span class="cs9C1B1871">新建终端</span><span class="cs8926E06">[</span><span class="cs9C1B1871">参数默认可以不加，若有自定义参数，才要加上，下同</span><span class="cs8926E06">] mongod --port 27017 --dbpath /data/db1</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">另起一个终端，运行下列命令</span></p><p class="cs3A447A38"><span class="cs9FB05234">mongo --port 27017</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234"> &nbsp;use admin</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234"> &nbsp;db.createUser(</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;{</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;user: &quot;adminUser&quot;,</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pwd: &quot;adminPass&quot;,</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;roles: [ { role: &quot;userAdminAnyDatabase&quot;, db: &quot;admin&quot; } ]</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;)</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">管理员创建成功，现在拥有了用户管理员</span><span class="cs8926E06"> </span><span class="cs9C1B1871">用户名</span><span class="cs8926E06">:adminUser </span><span class="cs9C1B1871">密码</span><span class="cs8926E06">:adminPass</span></p><p class="cs40DD2BC9"><span><img src="Web安全/Mongo_DB/Mongo%20DB%e6%9c%aa%e6%8e%88%e6%9d%83%e8%ae%bf%e9%97%ae_files/image3.png" width="560" height="294" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs5BEC2C28">(2).</span><span class="csE3F655E4">本地访问</span><span class="cs8926E06"><br/>bind 127.0.0.1 </span><span class="cs5BEC2C28">(3).</span><span class="csE3F655E4">修改默认端口</span><span class="cs8926E06"><br/></span><span class="cs9C1B1871">修改默认的</span><span class="cs8926E06">mongoDB</span><span class="cs9C1B1871">端口</span><span class="cs8926E06">(</span><span class="cs9C1B1871">默认为</span><span class="cs8926E06">: TCP 27017)</span><span class="cs9C1B1871">为其他端口</span></p><p class="cs40DD2BC9"><span class="cs5BEC2C28">(4).</span><span class="csE3F655E4">禁用</span><span class="cs5BEC2C28">HTTP</span><span class="csE3F655E4">和</span><span class="cs5BEC2C28">REST</span><span class="csE3F655E4">端口</span><span class="cs8926E06"><br/>MongoDB</span><span class="cs9C1B1871">自身带有一个</span><span class="cs8926E06">HTTP</span><span class="cs9C1B1871">服务和并支持</span><span class="cs8926E06">REST</span><span class="cs9C1B1871">接口。在</span><span class="cs8926E06">2.6</span><span class="cs9C1B1871">以后这些接口默认是关闭的。</span><span class="cs8926E06">mongoDB</span><span class="cs9C1B1871">默认会使用默认端口监听</span><span class="cs8926E06">web</span><span class="cs9C1B1871">服务，一般不需要通过</span><span class="cs8926E06">web</span><span class="cs9C1B1871">方式进行远程管理，建议禁用。修改配置文件或在启动的时候选择</span><span class="cs8926E06">&ndash;nohttpinterface </span><span class="cs9C1B1871">参数</span><span class="cs8926E06">nohttpinterface = false<br/></span><span class="cs5BEC2C28">(5).</span><span class="csE3F655E4">开启日志审计功能</span><span class="cs8926E06"><br/></span><span class="cs9C1B1871">审计功能可以用来记录用户对数据库的所有相关操作。这些记录可以让系统管理员在需要的时候分析数据库在什么时段发生了什么事情</span><span class="cs8926E06"><br/></span><span class="cs5BEC2C28">(6).</span><span class="csE3F655E4">开启</span><span class="cs5BEC2C28">auth</span><span class="csE3F655E4">认证</span></p><p class="cs3A447A38"><span class="cs9FB05234">/etc/mongodb.conf</span><span class="cs7FFD2630">　　</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">auth = true</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">其他</span><span class="cs8926E06">:http://www.mottoin.com/10560</span></p></body>
</html>
