<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>
		</title>
		<style type="text/css">
			.csAD577193{text-align:left;text-indent:0pt;margin:24pt 0pt 0pt 0pt;page-break-after:avoid;page-break-inside:avoid}
			.csECDA2D3{color:#4F81BD;background-color:transparent;font-family:Microsoft YaHei UI;font-size:16pt;font-weight:bold;font-style:normal;}
			.csDE05BCC{color:#4F81BD;background-color:transparent;font-family:Calibri;font-size:16pt;font-weight:bold;font-style:normal;}
			.cs868C439D{text-align:left;text-indent:0pt;margin:10pt 0pt 0pt 0pt;page-break-after:avoid;page-break-inside:avoid}
			.cs83F14626{color:#4F81BD;background-color:transparent;font-family:Microsoft YaHei UI;font-size:14pt;font-weight:bold;font-style:normal;}
			.cs40DD2BC9{text-align:left;text-indent:0pt;margin:9pt 0pt 9pt 0pt}
			.cs8926E06{color:#000000;background-color:transparent;font-family:Calibri;font-size:12pt;font-weight:normal;font-style:normal;}
			.cs9C1B1871{color:#000000;background-color:transparent;font-family:Microsoft YaHei UI;font-size:12pt;font-weight:normal;font-style:normal;}
			.cs3A447A38{text-align:left;text-indent:0pt;margin:0pt 0pt 10pt 0pt}
			.cs9FB05234{color:#000000;background-color:transparent;font-family:Consolas;font-size:11pt;font-weight:normal;font-style:normal;}
			.cs6FD73CFB{text-align:left;text-indent:0pt;margin:5pt 24pt 5pt 24pt}
			.cs508254C{color:#000000;background-color:transparent;font-family:Calibri;font-size:12pt;font-weight:normal;font-style:normal;text-decoration: none;}
			.cs4B51D5E4{color:#4F81BD;background-color:transparent;font-family:Calibri;font-size:12pt;font-weight:normal;font-style:normal;}
		</style>
	</head>
	<body>
		<h1 class="csAD577193">
			<a name="X9642e1e640f30468a7b65aa7c3711fea78975d3"><span class="csECDA2D3">（</span><span class="csDE05BCC">CVE-2020-6949</span><span class="csECDA2D3">）</span><span class="csDE05BCC">HashBrown CMS postUser </span><span class="csECDA2D3">函数存在提权漏洞</span></a></h1>
		<h2 class="cs868C439D">
			<a name="一、漏洞简介"><span class="cs83F14626">一、漏洞简介</span></a></h2>
		<p class="cs40DD2BC9"><span class="cs8926E06">HashBrown CMS</span><span class="cs9C1B1871">是一套开源的无头内容管理系统（</span><span class="cs8926E06">CMS</span><span class="cs9C1B1871">）。</span><span class="cs8926E06"> HashBrown CMS 1.3.3</span><span class="cs9C1B1871">及之前版本中的</span><span class="cs8926E06">&lsquo;postUser&rsquo;</span><span class="cs9C1B1871">函数存在提权漏洞。攻击者可利用该漏洞修改管理员账户的哈希密码或重置该账户。</span></p><h2 class="cs868C439D">
			<a name="二、漏洞影响"><span class="cs83F14626">二、漏洞影响</span></a></h2>
		<p class="cs40DD2BC9"><span class="cs8926E06">HashBrown CMS 1.3.3</span><span class="cs9C1B1871">及之前版本</span></p><h2 class="cs868C439D">
			<a name="三、复现过程"><span class="cs83F14626">三、复现过程</span></a></h2>
		<p class="cs40DD2BC9"><span class="cs9C1B1871">在读和部分此</span><span class="cs8926E06">cms</span><span class="cs9C1B1871">的源码后，希望对用户管理方面做个审计。这款</span><span class="cs8926E06">CMS </span><span class="cs9C1B1871">的用户分为两种，一种是</span><span class="cs8926E06">admin </span><span class="cs9C1B1871">权限用户，</span><span class="cs8926E06"> </span><span class="cs9C1B1871">可以创建和设置别的用户的属性，比如参管理那些项目，用户名密码设置等等。另外一种是</span><span class="cs8926E06">editor </span><span class="cs9C1B1871">账户，其能管理哪些项目是由</span><span class="cs8926E06">admin </span><span class="cs9C1B1871">设置的，</span><span class="cs8926E06">editor </span><span class="cs9C1B1871">账户只能修改自己的用户名和密码。如下图这里的三个账户，</span><span class="cs8926E06">admin </span><span class="cs9C1B1871">和</span><span class="cs8926E06"> aaaa </span><span class="cs9C1B1871">是</span><span class="cs8926E06">admin </span><span class="cs9C1B1871">用户，</span><span class="cs8926E06">bbbb </span><span class="cs9C1B1871">是</span><span class="cs8926E06">editor </span><span class="cs9C1B1871">账户</span></p><p class="cs40DD2BC9"><span><img src="Web安全/Hashbrown_CMS/%ef%bc%88CVE-2020-6949%ef%bc%89HashBrown%20CMS%20postUser%20%e5%87%bd%e6%95%b0%e5%ad%98%e5%9c%a8%e6%8f%90%e6%9d%83%e6%bc%8f%e6%b4%9e_files/image0.png" width="560" height="117" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">由于该</span><span class="cs8926E06">CMS </span><span class="cs9C1B1871">不提供用户注册和找回密码的功能，</span><span class="cs8926E06"> </span><span class="cs9C1B1871">所以没有太多的地方可以去尝试突破，我就尝试聚焦有没有办法把</span><span class="cs8926E06">editor </span><span class="cs9C1B1871">账户提权成</span><span class="cs8926E06">admin </span><span class="cs9C1B1871">账户，那</span><span class="cs8926E06">editor </span><span class="cs9C1B1871">账户只有一个地方可以修改自己的密码和其他属性。</span></p><p class="cs40DD2BC9"><span><img src="Web安全/Hashbrown_CMS/%ef%bc%88CVE-2020-6949%ef%bc%89HashBrown%20CMS%20postUser%20%e5%87%bd%e6%95%b0%e5%ad%98%e5%9c%a8%e6%8f%90%e6%9d%83%e6%bc%8f%e6%b4%9e_files/image1.png" width="560" height="250" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">随意做个修改后在</span><span class="cs8926E06">burpsuit </span><span class="cs9C1B1871">截取请求如下。</span></p><p class="cs3A447A38"><span class="cs9FB05234">POST http://10.200.159.166:8080/api/users/44019b092718ccde HTTP/1.1</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Host: 10.200.159.166:8080</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:72.0) Gecko/20100101 Firefox/72.0</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Accept: */*</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Accept-Language: en-US,en;q=0.5</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Accept-Encoding: gzip, deflate</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Content-Type: application/json; charset=utf-8</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Content-Length: 159</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">Cookie: token=2e10b7f6b3cc8fbf81452d980029d6e843ac5760</span><span class="cs8926E06"><br/><br/><br/></span><span class="cs9FB05234">{&quot;id&quot;:&quot;44019b092718ccde&quot;,&quot;viewedBy&quot;:&quot;&quot;,&quot;viewedOn&quot;:null,&quot;isAdmin&quot;:false,&quot;isCurrent&quot;:false,&quot;username&quot;:&quot;bbbb&quot;,&quot;fullName&quot;:&quot;bbbb&quot;,&quot;email&quot;:&quot;&quot;,&quot;theme&quot;:&quot;&quot;,&quot;scopes&quot;:{}}</span></p><p class="cs40DD2BC9"><span class="cs8926E06">Grep </span><span class="cs9C1B1871">定位到文件</span><span class="cs8926E06">Server/Controller/UserController.js</span></p><p class="cs3A447A38"><span class="cs9FB05234">root@SIN-Ubuntu-A:~/hashbrown-cms/hashbrown-cms-1.3.1/src# grep /api/users/ * -r</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">Server/Controller/UserController.js: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;app.get(&#39;/api/users/:id&#39;, this.middleware({needsAdmin: true, setProject: false}), this.getUser);</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">Server/Controller/UserController.js: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;app.post(&#39;/api/users/first&#39;, this.createFirstAdmin);</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">Server/Controller/UserController.js: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;app.post(&#39;/api/users/new&#39;, this.middleware({setProject: false, needsAdmin: true}), this.createUser);</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">Server/Controller/UserController.js: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;app.post(&#39;/api/users/:id&#39;, this.middleware({setProject: false}), this.postUser);</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">Server/Controller/UserController.js: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;app.delete(&#39;/api/users/:id&#39;, this.middleware({setProject: false, needsAdmin: true}), this.deleteUser);</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">其中的</span><span class="cs8926E06">postUser function, </span><span class="cs9C1B1871">其中可看到该函数在</span><span class="cs8926E06">151</span><span class="cs9C1B1871">行会对</span><span class="cs8926E06">cookie </span><span class="cs9C1B1871">里面的</span><span class="cs8926E06">token </span><span class="cs9C1B1871">进行验证，在</span><span class="cs8926E06">153 </span><span class="cs9C1B1871">行获取</span><span class="cs8926E06">user </span><span class="cs9C1B1871">的</span><span class="cs8926E06">scope</span><span class="cs9C1B1871">。</span><span class="cs8926E06">Scope </span><span class="cs9C1B1871">这里指的就是是不是</span><span class="cs8926E06">admin </span><span class="cs9C1B1871">用户，可以管理那些项目。但是这里有个要注意的地方</span><span class="cs8926E06">148</span><span class="cs9C1B1871">行的</span><span class="cs8926E06">req.params.id </span><span class="cs9C1B1871">是</span><span class="cs8926E06">post </span><span class="cs9C1B1871">内容里面</span><span class="cs8926E06">json id</span><span class="cs9C1B1871">字段的值，但是</span><span class="cs8926E06">155</span><span class="cs9C1B1871">行的</span><span class="cs8926E06">user.id </span><span class="cs9C1B1871">是</span><span class="cs8926E06">url </span><span class="cs9C1B1871">末段的</span><span class="cs8926E06">id</span><span class="cs9C1B1871">值。对于</span><span class="cs8926E06">editor </span><span class="cs9C1B1871">用户来说应该永远一直，因为</span><span class="cs8926E06">editor</span><span class="cs9C1B1871">只能修改自己账户。</span><span class="cs8926E06">Admin </span><span class="cs9C1B1871">用户有可能不一样，因为</span><span class="cs8926E06">admin </span><span class="cs9C1B1871">用户是可修改其他账户的。我们可以看到</span><span class="cs8926E06">156</span><span class="cs9C1B1871">到</span><span class="cs8926E06">159</span><span class="cs9C1B1871">行是做了安全性检察的，如果当前</span><span class="cs8926E06">user id </span><span class="cs9C1B1871">获取的属性没有</span><span class="cs8926E06">users </span><span class="cs9C1B1871">的</span><span class="cs8926E06">scope</span><span class="cs9C1B1871">（不是</span><span class="cs8926E06">admin </span><span class="cs9C1B1871">权限账户），那就用数据库里面的属性覆盖当前</span><span class="cs8926E06">post</span><span class="cs9C1B1871">提交内容的</span><span class="cs8926E06">isAdmin </span><span class="cs9C1B1871">和</span><span class="cs8926E06">scopes </span><span class="cs9C1B1871">两个内容，保证不会让</span><span class="cs8926E06">editor </span><span class="cs9C1B1871">自己提权到</span><span class="cs8926E06">admin </span><span class="cs9C1B1871">账户。到此没有看到对其他</span><span class="cs8926E06">post </span><span class="cs9C1B1871">提交内容做检察。之后</span><span class="cs8926E06">168</span><span class="cs9C1B1871">行用查询</span><span class="cs8926E06">id</span><span class="cs9C1B1871">的方式对响应的条目做修改。</span></p><p class="cs40DD2BC9"><span><img src="Web安全/Hashbrown_CMS/%ef%bc%88CVE-2020-6949%ef%bc%89HashBrown%20CMS%20postUser%20%e5%87%bd%e6%95%b0%e5%ad%98%e5%9c%a8%e6%8f%90%e6%9d%83%e6%bc%8f%e6%b4%9e_files/image2.png" width="560" height="341" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">此时如果我们在数据库中查看的话可以有个更清晰的认识，如果第一个条目是</span><span class="cs8926E06">aaaa</span><span class="cs9C1B1871">账户，</span><span class="cs8926E06">isadmin</span><span class="cs9C1B1871">设置为</span><span class="cs8926E06">true</span><span class="cs9C1B1871">，第二个是</span><span class="cs8926E06">admin</span><span class="cs9C1B1871">账户，第三个是</span><span class="cs8926E06">bbbb</span><span class="cs9C1B1871">账户，每个账户</span><span class="cs8926E06">password </span><span class="cs9C1B1871">字段包含</span><span class="cs8926E06">hash</span><span class="cs9C1B1871">，</span><span class="cs8926E06">salt </span><span class="cs9C1B1871">和</span><span class="cs8926E06">token</span><span class="cs9C1B1871">字段。</span></p><p class="cs40DD2BC9"><span><img src="Web安全/Hashbrown_CMS/%ef%bc%88CVE-2020-6949%ef%bc%89HashBrown%20CMS%20postUser%20%e5%87%bd%e6%95%b0%e5%ad%98%e5%9c%a8%e6%8f%90%e6%9d%83%e6%bc%8f%e6%b4%9e_files/image3.png" width="560" height="102" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">这里我产生了一个想法，如果我是</span><span class="cs8926E06">bbbb</span><span class="cs9C1B1871">账户，提交修改自己账户请求的时候写入的是</span><span class="cs8926E06">aaaa</span><span class="cs9C1B1871">账户的</span><span class="cs8926E06">id</span><span class="cs9C1B1871">会发生什么样的事情呢？但是做这件事之前我们要先确定</span><span class="cs8926E06">bbbb</span><span class="cs9C1B1871">账户有没有办法得到</span><span class="cs8926E06">aaaa</span><span class="cs9C1B1871">账户的</span><span class="cs8926E06">id</span><span class="cs9C1B1871">。在阅读</span><span class="cs8926E06">/Server/Controller/UserController.js</span><span class="cs9C1B1871">源码后确实是可以的。如下</span><span class="cs8926E06">31</span><span class="cs9C1B1871">行，发送</span><span class="cs8926E06">get </span><span class="cs9C1B1871">请求到</span><span class="cs8926E06">API</span><span class="cs9C1B1871">可以获取到当前项目的所有用户，包括所有的</span><span class="cs8926E06">admin </span><span class="cs9C1B1871">账户。而项目</span><span class="cs8926E06">id </span><span class="cs9C1B1871">等是当管理员赋予</span><span class="cs8926E06">editor</span><span class="cs9C1B1871">权限后，登录后从请求中就可以拿到的。</span></p><p class="cs40DD2BC9"><span><img src="Web安全/Hashbrown_CMS/%ef%bc%88CVE-2020-6949%ef%bc%89HashBrown%20CMS%20postUser%20%e5%87%bd%e6%95%b0%e5%ad%98%e5%9c%a8%e6%8f%90%e6%9d%83%e6%bc%8f%e6%b4%9e_files/image4.png" width="560" height="259" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">发送请求得到账户的信息。</span></p><p class="cs40DD2BC9"><span><img src="Web安全/Hashbrown_CMS/%ef%bc%88CVE-2020-6949%ef%bc%89HashBrown%20CMS%20postUser%20%e5%87%bd%e6%95%b0%e5%ad%98%e5%9c%a8%e6%8f%90%e6%9d%83%e6%bc%8f%e6%b4%9e_files/image5.png" width="560" height="161" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">那接下来我们就可以篡改</span><span class="cs8926E06">bbbb</span><span class="cs9C1B1871">发送修改自己账户的请求，但是</span><span class="cs8926E06">post</span><span class="cs9C1B1871">提交的</span><span class="cs8926E06">id</span><span class="cs9C1B1871">是</span><span class="cs8926E06">aaaa</span><span class="cs9C1B1871">账户。如下图保持了</span><span class="cs8926E06">url</span><span class="cs9C1B1871">最后一段是</span><span class="cs8926E06">bbbb</span><span class="cs9C1B1871">自己的</span><span class="cs8926E06">id</span><span class="cs9C1B1871">，</span><span class="cs8926E06">post </span><span class="cs9C1B1871">提交的</span><span class="cs8926E06">id</span><span class="cs9C1B1871">是</span><span class="cs8926E06">aaaa </span><span class="cs9C1B1871">账户，显示</span><span class="cs8926E06">200 ok</span><span class="cs9C1B1871">。</span></p><p class="cs40DD2BC9"><span><img src="Web安全/Hashbrown_CMS/%ef%bc%88CVE-2020-6949%ef%bc%89HashBrown%20CMS%20postUser%20%e5%87%bd%e6%95%b0%e5%ad%98%e5%9c%a8%e6%8f%90%e6%9d%83%e6%bc%8f%e6%b4%9e_files/image6.png" width="560" height="202" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">此时如果查看数据库会看到确实</span><span class="cs8926E06">aaaa</span><span class="cs9C1B1871">和</span><span class="cs8926E06">bbbb </span><span class="cs9C1B1871">条目的</span><span class="cs8926E06">id</span><span class="cs9C1B1871">一样，但是</span><span class="cs8926E06">bbbb </span><span class="cs9C1B1871">的内容并没有实际的改变，只是换了一个</span><span class="cs8926E06">id</span><span class="cs9C1B1871">。对别的账户也没有任何的修改。</span></p><p class="cs40DD2BC9"><span><img src="Web安全/Hashbrown_CMS/%ef%bc%88CVE-2020-6949%ef%bc%89HashBrown%20CMS%20postUser%20%e5%87%bd%e6%95%b0%e5%ad%98%e5%9c%a8%e6%8f%90%e6%9d%83%e6%bc%8f%e6%b4%9e_files/image7.png" width="560" height="103" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">但其实如果我们再深一步就会发现这有利用的点。在之前的源码中</span><span class="cs8926E06">168</span><span class="cs9C1B1871">行</span><span class="cs8926E06">HashBrown.Service.UserService.updateUserById(id, properties); </span><span class="cs9C1B1871">使用了查询匹配</span><span class="cs8926E06">id</span><span class="cs9C1B1871">做修改的方式。我们追踪这个函数。在文件</span><span class="cs8926E06">Server/Service/UserService.js</span><span class="cs9C1B1871">中看到</span><span class="cs8926E06">mergeOne</span><span class="cs9C1B1871">的数据库操作方式。这意味这如果</span><span class="cs8926E06">aaaa</span><span class="cs9C1B1871">和</span><span class="cs8926E06">bbbb</span><span class="cs9C1B1871">有相同的</span><span class="cs8926E06">id</span><span class="cs9C1B1871">，但是</span><span class="cs8926E06">aaaa </span><span class="cs9C1B1871">在数据库的前面位置，如果</span><span class="cs8926E06">bbbb</span><span class="cs9C1B1871">提出对这个</span><span class="cs8926E06">id </span><span class="cs9C1B1871">的修改，修改会被接受但是写入</span><span class="cs8926E06">aaaa</span><span class="cs9C1B1871">的条目。</span></p><p class="cs40DD2BC9"><span><img src="Web安全/Hashbrown_CMS/%ef%bc%88CVE-2020-6949%ef%bc%89HashBrown%20CMS%20postUser%20%e5%87%bd%e6%95%b0%e5%ad%98%e5%9c%a8%e6%8f%90%e6%9d%83%e6%bc%8f%e6%b4%9e_files/image8.png" width="560" height="111" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">接下来我们来做测试</span><span class="cs8926E06">,</span><span class="cs9C1B1871">提交的</span><span class="cs8926E06">ID</span><span class="cs9C1B1871">全部改成</span><span class="cs8926E06">aaaa</span><span class="cs9C1B1871">账户的</span><span class="cs8926E06">id</span><span class="cs9C1B1871">，因为现在原始的</span><span class="cs8926E06">bbbb</span><span class="cs9C1B1871">的</span><span class="cs8926E06">id</span><span class="cs9C1B1871">已经不存在了。还提交了</span><span class="cs8926E06">aaaa </span><span class="cs9C1B1871">的</span><span class="cs8926E06">fullname </span><span class="cs9C1B1871">和</span><span class="cs8926E06">password </span><span class="cs9C1B1871">字段修改其密码是和</span><span class="cs8926E06">bbbb</span><span class="cs9C1B1871">同样的内容。</span></p><p class="cs40DD2BC9"><span><img src="Web安全/Hashbrown_CMS/%ef%bc%88CVE-2020-6949%ef%bc%89HashBrown%20CMS%20postUser%20%e5%87%bd%e6%95%b0%e5%ad%98%e5%9c%a8%e6%8f%90%e6%9d%83%e6%bc%8f%e6%b4%9e_files/image9.png" width="560" height="230" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">结果如下，可以看到</span><span class="cs8926E06">aaaa</span><span class="cs9C1B1871">的条目修改后接受了</span><span class="cs8926E06">fullname</span><span class="cs9C1B1871">，和</span><span class="cs8926E06">password</span><span class="cs9C1B1871">，</span><span class="cs8926E06">isadmin</span><span class="cs9C1B1871">和</span><span class="cs8926E06">scopes </span><span class="cs9C1B1871">继承了</span><span class="cs8926E06">bbbb</span><span class="cs9C1B1871">的内容，这是因为前面源码中的</span><span class="cs8926E06">156</span><span class="cs9C1B1871">到</span><span class="cs8926E06">159</span><span class="cs9C1B1871">行的作用。</span></p><p class="cs40DD2BC9"><span><img src="Web安全/Hashbrown_CMS/%ef%bc%88CVE-2020-6949%ef%bc%89HashBrown%20CMS%20postUser%20%e5%87%bd%e6%95%b0%e5%ad%98%e5%9c%a8%e6%8f%90%e6%9d%83%e6%bc%8f%e6%b4%9e_files/image10.png" width="560" height="105" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">到此为止，我们虽然不能将</span><span class="cs8926E06">bbbb</span><span class="cs9C1B1871">账户自己提升成</span><span class="cs8926E06">admin</span><span class="cs9C1B1871">，但是可以去修改别的账户的关键参数包括密码，这无疑是一个用户权限的漏洞。经过相似的分析修改</span><span class="cs8926E06">username </span><span class="cs9C1B1871">可以达到类似的效果。随后我提交此漏洞，开发人员征求了我的意见以后保证无法修改成同样的</span><span class="cs8926E06">id</span><span class="cs9C1B1871">或者</span><span class="cs8926E06">username </span><span class="cs9C1B1871">来规避了这个问题。</span></p><h2 class="cs868C439D">
			<a name="参考链接"><span class="cs83F14626">参考链接</span></a></h2>
		<p class="cs6FD73CFB"><span class="cs8926E06"><a class="cs508254C" href="https://mp.weixin.qq.com/s?__biz=MjM5MDYxODkyMA==&amp;mid=2651345793&amp;idx=1&amp;sn=02381bb3dbd4679b12be4628d665e815&amp;chksm=bdbef7c68ac97ed063e8df46a42e2a111dfd52f108f6b267f8dfc183b6b0ed3f87b6af757487&amp;mpshare=1&amp;scene=1&amp;srcid=&amp;sharer_sharetime=1582514363054&amp;sharer_shareid=346bf064ccfaeb680ec3e1af3a4fc9a8&amp;key=019d47c25aa835ac2d58a398c473737e01644761ca991f7009ada9eb1ef69e4dd41b2008c27db720006e0858455f920d0801d9feae53aa4314f05d6e310a7290ae2b93e17343c13f6a9f2ce360254195&amp;ascene=1&amp;uin=MTU0OTU5NDkzMA%3D%3D&amp;devicetype=Windows+10&amp;version=62080079&amp;lang=zh_CN&amp;exportkey=AZc%2BxZJwp8CueCtaKThWQrI%3D&amp;pass_ticket=l4uNHDrGwGqrS%2BmJVv56i4FzemghweUeBbN1BEETCGd3TqEDSTcwvRMSxogubM8j"><span class="cs4B51D5E4">https://mp.weixin.qq.com/s?__biz=MjM5MDYxODkyMA==&amp;mid=2651345793&amp;idx=1&amp;sn=02381bb3dbd4679b12be4628d665e815&amp;chksm=bdbef7c68ac97ed063e8df46a42e2a111dfd52f108f6b267f8dfc183b6b0ed3f87b6af757487&amp;mpshare=1&amp;scene=1&amp;srcid=&amp;sharer_sharetime=1582514363054&amp;sharer_shareid=346bf064ccfaeb680ec3e1af3a4fc9a8&amp;key=019d47c25aa835ac2d58a398c473737e01644761ca991f7009ada9eb1ef69e4dd41b2008c27db720006e0858455f920d0801d9feae53aa4314f05d6e310a7290ae2b93e17343c13f6a9f2ce360254195&amp;ascene=1&amp;uin=MTU0OTU5NDkzMA%3D%3D&amp;devicetype=Windows+10&amp;version=62080079&amp;lang=zh_CN&amp;exportkey=AZc%2BxZJwp8CueCtaKThWQrI%3D&amp;pass_ticket=l4uNHDrGwGqrS%2BmJVv56i4FzemghweUeBbN1BEETCGd3TqEDSTcwvRMSxogubM8j</span></a></span></p></body>
</html>
